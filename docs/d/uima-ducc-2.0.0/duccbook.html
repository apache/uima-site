<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>Distributed UIMA Cluster Computing</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="duccbook.tex"> 
<meta name="date" content="2015-08-03 18:07:00"> 
<link rel="stylesheet" type="text/css" href="duccbook.css"> 
</head><body 
>
                                                                                                
                                                                                                
<div class="maketitle">
                                                                                                
                                                                                                
                                                                                                
                                                                                                

<h2 class="titleHead">Distributed UIMA Cluster Computing</h2>
<div class="author" ><span 
class="cmr-12">Written and maintained by the Apache</span>
<br />  <span 
class="cmr-12">UIMA</span><sup class="textsuperscript"><span 
class="cmr-9">TM</span></sup><span 
class="cmr-12">Development Community</span><br /><br /><br />
<br />             <span 
class="cmr-12">Version 2.0.0</span></div>
<br />
<div class="date" ></div>
                                                                                                
                                                                                                
</div>
<!--l. 18--><p class="noindent" >Copyright <span 
class="cmsy-10">©</span>&#x00A0; 2012 The Apache Software Foundation
<!--l. 20--><p class="noindent" >Copyright <span 
class="cmsy-10">©</span>&#x00A0; 2012 International Business Machines Corporation
     <!--l. 23--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1000"></a><span 
class="cmbx-10">License and Disclaimer</span></span>
     The ASF licenses this documentation to you under the Apache License, Version 2.0 (the &#8221;License&#8221;); you may not
     use this documentation except in compliance with the License. You may obtain a copy of the License
     at
     <!--l. 28--><p class="noindent" ><a 
href="http://www.apache.org/licenses/LICENSE-2.0" class="url" ><span 
class="cmtt-10">http://www.apache.org/licenses/LICENSE-2.0</span></a>
     <!--l. 30--><p class="noindent" >Unless required by applicable law or agreed to in writing, this documentation and its contents are distributed under
     the License on an &#8221;AS IS&#8221; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
     or implied. See the License for the specific language governing permissions and limitations under the
     License.
     <!--l. 35--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-2000"></a><span 
class="cmbx-10">Trademarks</span></span>
     All terms mentioned in the text that are known to be trademarks or service marks have been appropriately capitalized.
     Use of such terms in this book should not be regarded as affecting the validity of the the trademark or service
     mark.
<!--l. 47--><p class="noindent" >Publication date: August&#x00A0;2015
                                                                                                
                                                                                                
<h2 class="likechapterHead"><a 
 id="x1-3000"></a>Table of Contents</h2> <div class="tableofcontents">
<span class="partToc" >I&#x00A0;&#x00A0;<a 
href="#x1-5000I" id="QQ2-1-5">DUCC Concepts</a></span>
<br /><span class="chapterToc" >1 <a 
href="#x1-60001" id="QQ2-1-6">DUCC Overview</a></span>
<br />&#x00A0;<span class="sectionToc" >1.1 <a 
href="#x1-70001.1" id="QQ2-1-7">What is DUCC?</a></span>
<br />&#x00A0;<span class="sectionToc" >1.2 <a 
href="#x1-80001.2" id="QQ2-1-8">DUCC Job Model</a></span>
<br />&#x00A0;<span class="sectionToc" >1.3 <a 
href="#x1-90001.3" id="QQ2-1-9">DUCC From UIMA to Full Scale-out</a></span>
<br />&#x00A0;<span class="sectionToc" >1.4 <a 
href="#x1-140001.4" id="QQ2-1-18">Error Management </a></span>
<br />&#x00A0;<span class="sectionToc" >1.5 <a 
href="#x1-150001.5" id="QQ2-1-19">Cluster and Job Management</a></span>
<br />&#x00A0;<span class="sectionToc" >1.6 <a 
href="#x1-160001.6" id="QQ2-1-20">Security Measures</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >1.6.1 <a 
href="#x1-170001.6.1" id="QQ2-1-21">ducc_ling</a></span>
<br />&#x00A0;<span class="sectionToc" >1.7 <a 
href="#x1-180001.7" id="QQ2-1-22">Security Issues</a></span>
<br /><span class="chapterToc" >2 <a 
href="#x1-190002" id="QQ2-1-23">Glossary</a></span>
<br /><span class="partToc" >II&#x00A0;&#x00A0;<a 
href="#x1-20000II" id="QQ2-1-24">Ducc Users Guide</a></span>
<br /><span class="chapterToc" >3 <a 
href="#x1-210003" id="QQ2-1-25">Command Line Interface</a></span>
<br />&#x00A0;<span class="sectionToc" >3.1 <a 
href="#x1-230003.1" id="QQ2-1-27">The DUCC Job Descriptor</a></span>
<br />&#x00A0;<span class="sectionToc" >3.2 <a 
href="#x1-240003.2" id="QQ2-1-28">Operating System Limit Support</a></span>
<br />&#x00A0;<span class="sectionToc" >3.3 <a 
href="#x1-250003.3" id="QQ2-1-29">Command Line Forms</a></span>
<br />&#x00A0;<span class="sectionToc" >3.4 <a 
href="#x1-260003.4" id="QQ2-1-30">DUCC Commands</a></span>
<br />&#x00A0;<span class="sectionToc" >3.5 <a 
href="#x1-270003.5" id="QQ2-1-31">ducc_submit</a></span>
<br />&#x00A0;<span class="sectionToc" >3.6 <a 
href="#x1-320003.6" id="QQ2-1-36">ducc_cancel</a></span>
<br />&#x00A0;<span class="sectionToc" >3.7 <a 
href="#x1-370003.7" id="QQ2-1-41">ducc_reserve</a></span>
<br />&#x00A0;<span class="sectionToc" >3.8 <a 
href="#x1-420003.8" id="QQ2-1-46">ducc_unreserve</a></span>
<br />&#x00A0;<span class="sectionToc" >3.9 <a 
href="#x1-470003.9" id="QQ2-1-51">ducc_process_submit</a></span>
<br />&#x00A0;<span class="sectionToc" >3.10 <a 
href="#x1-520003.10" id="QQ2-1-56">ducc_process_cancel</a></span>
<br />&#x00A0;<span class="sectionToc" >3.11 <a 
href="#x1-570003.11" id="QQ2-1-61">ducc_services</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.1 <a 
href="#x1-610003.11.1" id="QQ2-1-65">Common Options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.2 <a 
href="#x1-620003.11.2" id="QQ2-1-66">ducc_services &#8211;register [specification file] [options]</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.3 <a 
href="#x1-630003.11.3" id="QQ2-1-67">ducc_services &#8211;start options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.4 <a 
href="#x1-640003.11.4" id="QQ2-1-68">ducc_services &#8211;stop options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.5 <a 
href="#x1-650003.11.5" id="QQ2-1-69">ducc_services &#8211;enable options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.6 <a 
href="#x1-660003.11.6" id="QQ2-1-70">ducc_services &#8211;disable options</a></span>
                                                                                                
                                                                                                
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.7 <a 
href="#x1-670003.11.7" id="QQ2-1-71">ducc_services &#8211;observe_references options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.8 <a 
href="#x1-680003.11.8" id="QQ2-1-72">ducc_services &#8211;ignore_references options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.9 <a 
href="#x1-690003.11.9" id="QQ2-1-73">ducc_services &#8211;modify options</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >3.11.10 <a 
href="#x1-700003.11.10" id="QQ2-1-74">ducc_services &#8211;query options</a></span>
<br />&#x00A0;<span class="sectionToc" >3.12 <a 
href="#x1-720003.12" id="QQ2-1-76">viaducc and java_viaducc</a></span>
<br /><span class="chapterToc" >4 <a 
href="#x1-760004" id="QQ2-1-80">The DUCC Public API</a></span>
<br />&#x00A0;<span class="sectionToc" >4.1 <a 
href="#x1-770004.1" id="QQ2-1-81">Overview Of The DUCC API</a></span>
<br />&#x00A0;<span class="sectionToc" >4.2 <a 
href="#x1-780004.2" id="QQ2-1-82">Compiling and Running With the DUCC API</a></span>
<br />&#x00A0;<span class="sectionToc" >4.3 <a 
href="#x1-790004.3" id="QQ2-1-83">Java API</a></span>
<br /><span class="chapterToc" >5 <a 
href="#x1-800005" id="QQ2-1-84">Service Management</a></span>
<br />&#x00A0;<span class="sectionToc" >5.1 <a 
href="#x1-810005.1" id="QQ2-1-85">Overview.</a></span>
<br />&#x00A0;<span class="sectionToc" >5.2 <a 
href="#x1-820005.2" id="QQ2-1-86">Service Types.</a></span>
<br />&#x00A0;<span class="sectionToc" >5.3 <a 
href="#x1-830005.3" id="QQ2-1-87">Service Instance IDs</a></span>
<br />&#x00A0;<span class="sectionToc" >5.4 <a 
href="#x1-840005.4" id="QQ2-1-88">Service References and Endpoints</a></span>
<br />&#x00A0;<span class="sectionToc" >5.5 <a 
href="#x1-850005.5" id="QQ2-1-89">Service Management Policies</a></span>
<br />&#x00A0;<span class="sectionToc" >5.6 <a 
href="#x1-870005.6" id="QQ2-1-91">Service Pingers</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.6.1 <a 
href="#x1-880005.6.1" id="QQ2-1-92">The Pinger API</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.6.2 <a 
href="#x1-910005.6.2" id="QQ2-1-95">Declaring a Pinger in A Service</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.6.3 <a 
href="#x1-920005.6.3" id="QQ2-1-96">Implementing a Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.6.4 <a 
href="#x1-930005.6.4" id="QQ2-1-98">Building And Testing Your Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.6.5 <a 
href="#x1-980005.6.5" id="QQ2-1-103">Globally Registered Pingers</a></span>
<br />&#x00A0;<span class="sectionToc" >5.7 <a 
href="#x1-990005.7" id="QQ2-1-104">Sample Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.7.1 <a 
href="#x1-1000005.7.1" id="QQ2-1-105">Using the Sample Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.7.2 <a 
href="#x1-1010005.7.2" id="QQ2-1-106">Understanding Sample Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.7.3 <a 
href="#x1-1140005.7.3" id="QQ2-1-119">Calculating New Deployments in the Pinger</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >5.7.4 <a 
href="#x1-1250005.7.4" id="QQ2-1-130">Summary of Sample Pinger</a></span>
<br /><span class="chapterToc" >6 <a 
href="#x1-1260006" id="QQ2-1-131">Job Logs</a></span>
<br /><span class="chapterToc" >7 <a 
href="#x1-1320007" id="QQ2-1-137">DUCC Web Server</a></span>
<br />&#x00A0;<span class="sectionToc" >7.1 <a 
href="#x1-1370007.1" id="QQ2-1-144">Common Links</a></span>
<br />&#x00A0;<span class="sectionToc" >7.2 <a 
href="#x1-1380007.2" id="QQ2-1-145">Jobs Page</a></span>
<br />&#x00A0;<span class="sectionToc" >7.3 <a 
href="#x1-1390007.3" id="QQ2-1-147">Job Details Page</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.3.1 <a 
href="#x1-1400007.3.1" id="QQ2-1-148">Processes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.3.2 <a 
href="#x1-1410007.3.2" id="QQ2-1-150">Work Items</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.3.3 <a 
href="#x1-1420007.3.3" id="QQ2-1-152">Performance</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.3.4 <a 
href="#x1-1430007.3.4" id="QQ2-1-154">Specification</a></span>
<br />&#x00A0;<span class="sectionToc" >7.4 <a 
href="#x1-1440007.4" id="QQ2-1-156">Reservation Page</a></span>
<br />&#x00A0;<span class="sectionToc" >7.5 <a 
href="#x1-1450007.5" id="QQ2-1-158">Managed Reservation Details Page</a></span>
                                                                                                
                                                                                                
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.5.1 <a 
href="#x1-1460007.5.1" id="QQ2-1-159">Processes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.5.2 <a 
href="#x1-1470007.5.2" id="QQ2-1-160">Specification</a></span>
<br />&#x00A0;<span class="sectionToc" >7.6 <a 
href="#x1-1480007.6" id="QQ2-1-161">Services Page</a></span>
<br />&#x00A0;<span class="sectionToc" >7.7 <a 
href="#x1-1490007.7" id="QQ2-1-162">Service Details Page</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.7.1 <a 
href="#x1-1500007.7.1" id="QQ2-1-163">Processes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.7.2 <a 
href="#x1-1510007.7.2" id="QQ2-1-164">Specification</a></span>
<br />&#x00A0;<span class="sectionToc" >7.8 <a 
href="#x1-1520007.8" id="QQ2-1-165">System Details Page</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.8.1 <a 
href="#x1-1530007.8.1" id="QQ2-1-166">Administration</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.8.2 <a 
href="#x1-1540007.8.2" id="QQ2-1-167">Classes</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.8.3 <a 
href="#x1-1550007.8.3" id="QQ2-1-168">Daemons</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >7.8.4 <a 
href="#x1-1560007.8.4" id="QQ2-1-169">Machines</a></span>
<br />&#x00A0;<span class="sectionToc" >7.9 <a 
href="#x1-1570007.9" id="QQ2-1-170">Visualization</a></span>
<br /><span class="partToc" >III&#x00A0;&#x00A0;<a 
href="#x1-158000III" id="QQ2-1-172">Programming Model And Applications</a></span>
<br /><span class="chapterToc" >8 <a 
href="#x1-1590008" id="QQ2-1-173">Building and Testing Jobs</a></span>
<br />&#x00A0;<span class="sectionToc" >8.1 <a 
href="#x1-1600008.1" id="QQ2-1-174">Overview</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.1.1 <a 
href="#x1-1610008.1.1" id="QQ2-1-175">Basic Job Process Threading Model</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.1.2 <a 
href="#x1-1620008.1.2" id="QQ2-1-176">Alternate Pipeline Threading Model</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.1.3 <a 
href="#x1-1630008.1.3" id="QQ2-1-177">Overriding UIMA Configuration Parameters</a></span>
<br />&#x00A0;<span class="sectionToc" >8.2 <a 
href="#x1-1640008.2" id="QQ2-1-178">Collection Segmentation and Artifact Extraction</a></span>
<br />&#x00A0;<span class="sectionToc" >8.3 <a 
href="#x1-1650008.3" id="QQ2-1-179">CAS Consumer Changes for DUCC</a></span>
<br />&#x00A0;<span class="sectionToc" >8.4 <a 
href="#x1-1660008.4" id="QQ2-1-180">Job Development for an Existing Pipeline Design</a></span>
<br />&#x00A0;<span class="sectionToc" >8.5 <a 
href="#x1-1670008.5" id="QQ2-1-181">Job Development for a New Pipeline Design</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.5.1 <a 
href="#x1-1680008.5.1" id="QQ2-1-182">Collection Reader (CR) Characteristics</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.5.2 <a 
href="#x1-1690008.5.2" id="QQ2-1-183">DUCC built-in Flow Controller</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.5.3 <a 
href="#x1-1700008.5.3" id="QQ2-1-184">Workitem Feature Structure</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.5.4 <a 
href="#x1-1710008.5.4" id="QQ2-1-185">Deployment Descriptor (DD) Jobs</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >8.5.5 <a 
href="#x1-1720008.5.5" id="QQ2-1-186">Debugging</a></span>
<br /><span class="chapterToc" >9 <a 
href="#x1-1730009" id="QQ2-1-187">Sample Application: Raw Text Processing</a></span>
<br />&#x00A0;<span class="sectionToc" >9.1 <a 
href="#x1-1740009.1" id="QQ2-1-188">Application Function and Design</a></span>
<br />&#x00A0;<span class="sectionToc" >9.2 <a 
href="#x1-1750009.2" id="QQ2-1-189">Configuration Parameters</a></span>
<br />&#x00A0;<span class="sectionToc" >9.3 <a 
href="#x1-1760009.3" id="QQ2-1-190">Set up a working directory</a></span>
<br />&#x00A0;<span class="sectionToc" >9.4 <a 
href="#x1-1770009.4" id="QQ2-1-191">Download and Install OpenNLP</a></span>
<br />&#x00A0;<span class="sectionToc" >9.5 <a 
href="#x1-1780009.5" id="QQ2-1-192">Get some Input Text</a></span>
<br />&#x00A0;<span class="sectionToc" >9.6 <a 
href="#x1-1790009.6" id="QQ2-1-193">Run the Job</a></span>
<br />&#x00A0;<span class="sectionToc" >9.7 <a 
href="#x1-1800009.7" id="QQ2-1-194">Job Output</a></span>
<br />&#x00A0;<span class="sectionToc" >9.8 <a 
href="#x1-1810009.8" id="QQ2-1-195">Job Performance Details</a></span>
<br /><span class="chapterToc" >10 <a 
href="#x1-18200010" id="QQ2-1-198">Sample Application: CAS Input Processing</a></span>
                                                                                                
                                                                                                
<br />&#x00A0;<span class="sectionToc" >10.1 <a 
href="#x1-18300010.1" id="QQ2-1-199">Application Function and Design</a></span>
<br />&#x00A0;<span class="sectionToc" >10.2 <a 
href="#x1-18400010.2" id="QQ2-1-200">Configuration Parameters</a></span>
<br />&#x00A0;<span class="sectionToc" >10.3 <a 
href="#x1-18500010.3" id="QQ2-1-201">Run the Job</a></span>
<br />&#x00A0;<span class="sectionToc" >10.4 <a 
href="#x1-18600010.4" id="QQ2-1-202">Job Performance Details</a></span>
<br />&#x00A0;<span class="sectionToc" >10.5 <a 
href="#x1-18700010.5" id="QQ2-1-204">Limiting Job Resources</a></span>
<br /><span class="partToc" >IV&#x00A0;&#x00A0;<a 
href="#x1-188000IV" id="QQ2-1-205">Ducc Administrators Guide</a></span>
<br /><span class="chapterToc" >11 <a 
href="#x1-18900011" id="QQ2-1-206">Installation, Configuration, and Verification</a></span>
<br />&#x00A0;<span class="sectionToc" >11.1 <a 
href="#x1-19000011.1" id="QQ2-1-207">Overview</a></span>
<br />&#x00A0;<span class="sectionToc" >11.2 <a 
href="#x1-19100011.2" id="QQ2-1-208">Software Prerequisites</a></span>
<br />&#x00A0;<span class="sectionToc" >11.3 <a 
href="#x1-19200011.3" id="QQ2-1-209">Building from Source</a></span>
<br />&#x00A0;<span class="sectionToc" >11.4 <a 
href="#x1-19300011.4" id="QQ2-1-210">Documentation</a></span>
<br />&#x00A0;<span class="sectionToc" >11.5 <a 
href="#x1-19400011.5" id="QQ2-1-211">Single System Installation and Verification</a></span>
<br />&#x00A0;<span class="sectionToc" >11.6 <a 
href="#x1-19500011.6" id="QQ2-1-212">Minimal Hardware Requirements for Single System Installation</a></span>
<br />&#x00A0;<span class="sectionToc" >11.7 <a 
href="#x1-19600011.7" id="QQ2-1-213">Single System Installation</a></span>
<br />&#x00A0;<span class="sectionToc" >11.8 <a 
href="#x1-19700011.8" id="QQ2-1-214">Initial System Verification</a></span>
<br />&#x00A0;<span class="sectionToc" >11.9 <a 
href="#x1-19800011.9" id="QQ2-1-215">Add additional nodes to the DUCC cluster</a></span>
<br />&#x00A0;<span class="sectionToc" >11.10 <a 
href="#x1-19900011.10" id="QQ2-1-216">Ducc_ling Configuration - Running with credentials of submitting user</a></span>
<br />&#x00A0;<span class="sectionToc" >11.11 <a 
href="#x1-20000011.11" id="QQ2-1-217">CGroups Installation and Configuration</a></span>
<br />&#x00A0;<span class="sectionToc" >11.12 <a 
href="#x1-20100011.12" id="QQ2-1-218">Full DUCC Verification</a></span>
<br />&#x00A0;<span class="sectionToc" >11.13 <a 
href="#x1-20200011.13" id="QQ2-1-219">Enable DUCC webserver login</a></span>
<br /><span class="chapterToc" >12 <a 
href="#x1-20300012" id="QQ2-1-220">Administration</a></span>
<br />&#x00A0;<span class="sectionToc" >12.1 <a 
href="#x1-20400012.1" id="QQ2-1-221">WebServer Authentication</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.1 <a 
href="#x1-20500012.1.1" id="QQ2-1-222">Example Implementation</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.2 <a 
href="#x1-20600012.1.2" id="QQ2-1-223">IAuthenticationManager</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.3 <a 
href="#x1-20700012.1.3" id="QQ2-1-224">IAuthenticationResult</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.4 <a 
href="#x1-20800012.1.4" id="QQ2-1-225">Example ANT script to build jar</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.5 <a 
href="#x1-20900012.1.5" id="QQ2-1-226">Example ducc.properties entries</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.1.6 <a 
href="#x1-21000012.1.6" id="QQ2-1-227">Example ducc.administrators</a></span>
<br />&#x00A0;<span class="sectionToc" >12.2 <a 
href="#x1-21100012.2" id="QQ2-1-228">Properties</a></span>
<br />&#x00A0;<span class="sectionToc" >12.3 <a 
href="#x1-21200012.3" id="QQ2-1-229">Properties merging</a></span>
<br />&#x00A0;<span class="sectionToc" >12.4 <a 
href="#x1-21300012.4" id="QQ2-1-230">ducc.properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.1 <a 
href="#x1-21400012.4.1" id="QQ2-1-231">General DUCC Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.2 <a 
href="#x1-21500012.4.2" id="QQ2-1-232">Web Server Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.3 <a 
href="#x1-21600012.4.3" id="QQ2-1-233">Job Driver Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.4 <a 
href="#x1-21700012.4.4" id="QQ2-1-234">Service Manager Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.5 <a 
href="#x1-21800012.4.5" id="QQ2-1-235">Orchestrator Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.6 <a 
href="#x1-21900012.4.6" id="QQ2-1-236">Resource Manager Properties</a></span>
                                                                                                
                                                                                                
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.7 <a 
href="#x1-22000012.4.7" id="QQ2-1-237">Agent Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.8 <a 
href="#x1-22100012.4.8" id="QQ2-1-238">Process Manager Properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.4.9 <a 
href="#x1-22200012.4.9" id="QQ2-1-239">Job Process Properties</a></span>
<br />&#x00A0;<span class="sectionToc" >12.5 <a 
href="#x1-22300012.5" id="QQ2-1-240">ducc.private.properties</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.5.1 <a 
href="#x1-22400012.5.1" id="QQ2-1-241">Web Server Properties</a></span>
<br />&#x00A0;<span class="sectionToc" >12.6 <a 
href="#x1-22500012.6" id="QQ2-1-242">Resource Manager Configuration: Classes and Nodepools</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.6.1 <a 
href="#x1-22600012.6.1" id="QQ2-1-243">Nodepools</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.6.2 <a 
href="#x1-23000012.6.2" id="QQ2-1-251">Class Definitions</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.6.3 <a 
href="#x1-23100012.6.3" id="QQ2-1-253">Validation</a></span>
<br />&#x00A0;<span class="sectionToc" >12.7 <a 
href="#x1-23400012.7" id="QQ2-1-256">Ducc Node Definitions</a></span>
<br />&#x00A0;<span class="sectionToc" >12.8 <a 
href="#x1-23500012.8" id="QQ2-1-258">Ducc User Definitions</a></span>
<br />&#x00A0;<span class="sectionToc" >12.9 <a 
href="#x1-23600012.9" id="QQ2-1-260">Administrative Commands</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.1 <a 
href="#x1-23700012.9.1" id="QQ2-1-261">start_ducc</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.2 <a 
href="#x1-24400012.9.2" id="QQ2-1-268">stop_ducc</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.3 <a 
href="#x1-24900012.9.3" id="QQ2-1-273">check_ducc</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.4 <a 
href="#x1-25300012.9.4" id="QQ2-1-277">rm_reconfigure</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.5 <a 
href="#x1-25600012.9.5" id="QQ2-1-280">rm_qload</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.6 <a 
href="#x1-26100012.9.6" id="QQ2-1-285">rm_qoccupancy</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.7 <a 
href="#x1-26400012.9.7" id="QQ2-1-288">vary_off</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.8 <a 
href="#x1-26700012.9.8" id="QQ2-1-291">vary_on</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >12.9.9 <a 
href="#x1-27000012.9.9" id="QQ2-1-294">ducc_properties_manager</a></span>
<br /><span class="chapterToc" >13 <a 
href="#x1-27500013" id="QQ2-1-299">Resource Management</a></span>
<br />&#x00A0;<span class="sectionToc" >13.1 <a 
href="#x1-27600013.1" id="QQ2-1-300">Overview</a></span>
<br />&#x00A0;<span class="sectionToc" >13.2 <a 
href="#x1-27700013.2" id="QQ2-1-301">Preemption vs Eviction</a></span>
<br />&#x00A0;<span class="sectionToc" >13.3 <a 
href="#x1-27800013.3" id="QQ2-1-302">Scheduling Policies</a></span>
<br />&#x00A0;<span class="sectionToc" >13.4 <a 
href="#x1-27900013.4" id="QQ2-1-303">Allotment</a></span>
<br />&#x00A0;<span class="sectionToc" >13.5 <a 
href="#x1-28000013.5" id="QQ2-1-304">Priority vs Weight</a></span>
<br />&#x00A0;<span class="sectionToc" >13.6 <a 
href="#x1-28300013.6" id="QQ2-1-307">Node Pools</a></span>
<br />&#x00A0;<span class="sectionToc" >13.7 <a 
href="#x1-28400013.7" id="QQ2-1-308">Scheduling Classes</a></span>
<br /><span class="chapterToc" >14 <a 
href="#x1-28500014" id="QQ2-1-309">Service Management</a></span>
<br /><span class="chapterToc" >15 <a 
href="#x1-28600015" id="QQ2-1-310">Simulation and System Testing</a></span>
<br />&#x00A0;<span class="sectionToc" >15.1 <a 
href="#x1-28700015.1" id="QQ2-1-311">Cluster Simulation</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.1.1 <a 
href="#x1-28800015.1.1" id="QQ2-1-312">Overview</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.1.2 <a 
href="#x1-28900015.1.2" id="QQ2-1-313">Node Configuration</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.1.3 <a 
href="#x1-29000015.1.3" id="QQ2-1-314">Setting up Test Mode</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.1.4 <a 
href="#x1-29100015.1.4" id="QQ2-1-315">Starting a Simulated Cluster</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.1.5 <a 
href="#x1-29500015.1.5" id="QQ2-1-319">Stopping a Simulated Cluster</a></span>
                                                                                                
                                                                                                
<br />&#x00A0;<span class="sectionToc" >15.2 <a 
href="#x1-29900015.2" id="QQ2-1-323">Job Simulation</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.1 <a 
href="#x1-30000015.2.1" id="QQ2-1-324">Overview</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.2 <a 
href="#x1-30100015.2.2" id="QQ2-1-325">Job meta-descriptors</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.3 <a 
href="#x1-30200015.2.3" id="QQ2-1-326"><span 
class="cmti-10">Prepare </span>Descriptors</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.4 <a 
href="#x1-30300015.2.4" id="QQ2-1-327">Services</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.5 <a 
href="#x1-30500015.2.5" id="QQ2-1-329">Generating a Job Set</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >15.2.6 <a 
href="#x1-30600015.2.6" id="QQ2-1-330">Running the Test Driver</a></span>
<br />&#x00A0;<span class="sectionToc" >15.3 <a 
href="#x1-30700015.3" id="QQ2-1-331">Pre-Packaged Tests</a></span>
<br /><span class="chapterToc" >16 <a 
href="#x1-30800016" id="QQ2-1-332">DUCC Web Server Customization</a></span>
<br />&#x00A0;<span class="sectionToc" >16.1 <a 
href="#x1-30900016.1" id="QQ2-1-333">Server Side</a></span>
<br />&#x00A0;<span class="sectionToc" >16.2 <a 
href="#x1-31000016.2" id="QQ2-1-334">Client Side</a></span>
<br />&#x00A0;<span class="sectionToc" >16.3 <a 
href="#x1-31100016.3" id="QQ2-1-335">Build and Install</a></span>
<br /><span class="chapterToc" >17 <a 
href="#x1-31200017" id="QQ2-1-336">Understanding the DUCC logs</a></span>
<br />&#x00A0;<span class="sectionToc" >17.1 <a 
href="#x1-31300017.1" id="QQ2-1-337">Overview</a></span>
<br />&#x00A0;<span class="sectionToc" >17.2 <a 
href="#x1-31400017.2" id="QQ2-1-338">Resource Manager Log (rm.log)</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.1 <a 
href="#x1-31500017.2.1" id="QQ2-1-339">Bootstrap Configuration</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.2 <a 
href="#x1-32000017.2.2" id="QQ2-1-344">Node Arrival and Missed Heartbeats</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.3 <a 
href="#x1-32300017.2.3" id="QQ2-1-347">Node Occupancy</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.4 <a 
href="#x1-32400017.2.4" id="QQ2-1-348">Job Arrival and Status Updates</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.5 <a 
href="#x1-32700017.2.5" id="QQ2-1-351">Calculation Of Job Caps</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.6 <a 
href="#x1-32800017.2.6" id="QQ2-1-352">The &#8220;how much&#8221; calculations</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.7 <a 
href="#x1-32900017.2.7" id="QQ2-1-353">The &#8220;what of&#8221; calculations</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.8 <a 
href="#x1-33000017.2.8" id="QQ2-1-354">Defragmentation</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.2.9 <a 
href="#x1-33100017.2.9" id="QQ2-1-355">Published Schedule</a></span>
<br />&#x00A0;<span class="sectionToc" >17.3 <a 
href="#x1-33400017.3" id="QQ2-1-358">Service Manager Log (sm.log)</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.1 <a 
href="#x1-33500017.3.1" id="QQ2-1-359">Bootstrap configuration</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.2 <a 
href="#x1-34000017.3.2" id="QQ2-1-364">Receipt and analysis of Orchestrator State</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.3 <a 
href="#x1-34100017.3.3" id="QQ2-1-365">CLI Requests</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.4 <a 
href="#x1-34200017.3.4" id="QQ2-1-366">Dispatching / Startup of Service Instances</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.5 <a 
href="#x1-34300017.3.5" id="QQ2-1-367">Progression of Service State</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.6 <a 
href="#x1-34400017.3.6" id="QQ2-1-368">Starting and Logging Pingers</a></span>
<br />&#x00A0;&#x00A0;<span class="subsectionToc" >17.3.7 <a 
href="#x1-34500017.3.7" id="QQ2-1-369">Publishing State</a></span>
<br />&#x00A0;<span class="sectionToc" >17.4 <a 
href="#x1-34600017.4" id="QQ2-1-370"> (Orchestrator Log or.log)</a></span>
<br />&#x00A0;<span class="sectionToc" >17.5 <a 
href="#x1-34700017.5" id="QQ2-1-371">Process Manager Log (pm.log)</a></span>
<br />&#x00A0;<span class="sectionToc" >17.6 <a 
href="#x1-34800017.6" id="QQ2-1-372">Agent log Log (hostname.agent.log)</a></span>
</div>
                                                                                                
                                                                                                
<h2 class="likechapterHead"><a 
 id="x1-4000"></a>List of Figures</h2><div class="tableofcontents"><span class="lofToc" >1.1&#x00A0;<a 
href="#x1-10001r1">Standard UIMA Pipeline</a></span><br /><span class="lofToc" >1.2&#x00A0;<a 
href="#x1-11001r2">UIMA Pipeline As Scaled by
UIMA-AS</a></span><br /><span class="lofToc" >1.3&#x00A0;<a 
href="#x1-12001r3">UIMA Pipeline As Automatically Scaled Out By DUCC</a></span><br /><span class="lofToc" >1.4&#x00A0;<a 
href="#x1-13001r4">UIMA Pipeline
With User-Supplied DD as Automatically Scaled Out By DUCC</a></span><br /><span class="lofToc" >5.1&#x00A0;<a 
href="#x1-92001r1">Sample UIMA-AS
Service Pinger</a></span><br /><span class="lofToc" >7.1&#x00A0;<a 
href="#x1-132001r1">Sample Webserver Page</a></span><br /><span class="lofToc" >7.2&#x00A0;<a 
href="#x1-136001r2">Preferences Page</a></span><br /><span class="lofToc" >7.3&#x00A0;<a 
href="#x1-138001r3">Jobs Page</a></span><br /><span class="lofToc" >7.4&#x00A0;<a 
href="#x1-140004r4">Processes
Tab</a></span><br /><span class="lofToc" >7.5&#x00A0;<a 
href="#x1-141001r5">Work Items Tab</a></span><br /><span class="lofToc" >7.6&#x00A0;<a 
href="#x1-142001r6">Performance Tab</a></span><br /><span class="lofToc" >7.7&#x00A0;<a 
href="#x1-143001r7">Specification Tab</a></span><br /><span class="lofToc" >7.8&#x00A0;<a 
href="#x1-144001r8">Reservations
Page</a></span><br /><span class="lofToc" >7.9&#x00A0;<a 
href="#x1-157001r9">Visualization</a></span><br /><span class="lofToc" >9.1&#x00A0;<a 
href="#x1-181001r1">OpenNLP Process Measurements</a></span><br /><span class="lofToc" >9.2&#x00A0;<a 
href="#x1-181002r2">OpenNLP
Process Breakdown</a></span><br /><span class="lofToc" >10.1&#x00A0;<a 
href="#x1-186001r1">CAS Input Processing Performacne</a></span><br /><span class="lofToc" >12.1&#x00A0;<a 
href="#x1-227004r1">Nodepool
Example</a></span><br /><span class="lofToc" >12.2&#x00A0;<a 
href="#x1-227007r2">Nodepools: Overlapping Pools are Incorrect</a></span><br /><span class="lofToc" >12.3&#x00A0;<a 
href="#x1-227008r3">Nodepools: Multiple
top-level Nodepools</a></span><br /><span class="lofToc" >12.4&#x00A0;<a 
href="#x1-229007r4">Sample Nodepool Configuration</a></span><br /><span class="lofToc" >12.5&#x00A0;<a 
href="#x1-230001r5">Sample Class
Configuration</a></span><br /><span class="lofToc" >12.6&#x00A0;<a 
href="#x1-234001r6">Sample Node Configuration</a></span><br /><span class="lofToc" >12.7&#x00A0;<a 
href="#x1-235001r7">Sample User Registration</a></span><br />
</div>
                                                                                                
                                                                                                
                                                                                                
                                                                                                
<!--l. 79--><p class="noindent" >
                                                                                                
                                                                                                
<h1 class="partHead"><span class="titlemark">Part&#x00A0;I<br /></span><a 
 id="x1-5000I"></a>DUCC Concepts</h1>
<!--l. 22--><p class="noindent" ><a name='DUCC_OVERVIEW'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-60001"></a>DUCC Overview</h2>
<h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-70001.1"></a>What is DUCC?</h3>
<!--l. 28--><p class="noindent" >DUCC stands for Distributed UIMA Cluster Computing. DUCC is a cluster management system providing
tooling, management, and scheduling facilities to automate the scale-out of applications written to the UIMA
framework.
<!--l. 32--><p class="noindent" >Core UIMA provides a generalized framework for applications that process unstructured information such as human
language, but does not provide a scale-out mechanism. UIMA-AS provides a scale-out mechanism to distribute UIMA
pipelines over a cluster of computing resources, but does not provide job or cluster management of the resources.
DUCC defines a formal job model that closely maps to a standard UIMA pipeline. Around this job model
DUCC provides cluster management services to automate the scale-out of UIMA pipelines over computing
clusters.
<!--l. 39--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-80001.2"></a>DUCC Job Model</h3>
<!--l. 41--><p class="noindent" >The Job Model defines the steps necessary to scale-up a UIMA pipeline using DUCC. The goal of DUCC is to
scale-up any UIMA pipeline, including pipelines that must be deployed across multiple machines using shared
services.
<!--l. 45--><p class="noindent" >The DUCC Job model consists of standard UIMA components: a Collection Reader (CR), a CAS Multiplier (CM),
application logic as implemented one or more Analysis Engines (AE), and a CAS Consumer (CC).
<!--l. 49--><p class="noindent" >The Collection Reader builds input CASs and forwards them to the UIMA pipelines. In the DUCC model, the CR is run in a
process separate from the rest of the pipeline. In fact, in all but the smallest clusters it is run on a different physical machine
than the rest of the pipeline. To achieve scalability, the CR must create very small CASs that do not contain application
data, but which contain references to data; for instance, file names. Ideally, the CR should be runnable in a process
not much larger than the smallest Java virtual machine. Later sections demonstrate methods for achieving
this.
<!--l. 57--><p class="noindent" >Each pipeline must contain at least one CAS Multiplier which receives the CASs from the CR. The CMs encapsulate the
knowledge of how to receive the data references in the small CASs received from the CRs and deliver the referenced data to
the application pipeline. DUCC packages the CM, AE(s), and CC into a single process, multiple instances of which are then
deployed over the cluster.
<!--l. 63--><p class="noindent" >A DUCC job therefore consists of a small specification containing the following items:
     <ul class="itemize1">
     <li class="itemize">The name of a resource containing the CR descriptor.
     </li>
     <li class="itemize">The name of a resource containing the CM descriptor.
     </li>
     <li class="itemize">The name of a resource containing the AE descriptor.
     </li>
     <li class="itemize">The name of a resource containing the CC descriptor.
     </li>
     <li class="itemize">Other information required to parameterize the above and identify the job such as log directory, working
     directory, desired scale-out, classpath, etc. These are described in detail in subsequent sections.</li></ul>
                                                                                                
                                                                                                
<!--l. 75--><p class="noindent" >On job submission, DUCC creates a single process executing the CR and one or more processes containing the analysis
pipeline.
<!--l. 78--><p class="noindent" >DUCC provides other facilities in support of scale-out:
     <ul class="itemize1">
     <li class="itemize">The ability to reserve all or part of a node in the cluster.
     </li>
     <li class="itemize">Automated management of services required in support of jobs.
     </li>
     <li class="itemize">The ability to schedule and execute arbitrary processes on nodes in the cluster.
     </li>
     <li class="itemize">Debugging tools and support.
     </li>
     <li class="itemize">A web server to display and manage work and cluster status.
     </li>
     <li class="itemize">A CLI and a Java API to support the above.</li></ul>
<!--l. 89--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.3   </span> <a 
 id="x1-90001.3"></a>DUCC From UIMA to Full Scale-out</h3>
<!--l. 91--><p class="noindent" >In this section we demonstrate the progression of a simple UIMA pipeline to a fully scaled-out job running under
DUCC.
<!--l. 94--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-100001.3"></a><span 
class="cmbx-10">UIMA Pipelines</span></span>
A normal UIMA pipeline contains a Collection Reader (CR), one or more Analysis Engines (AE) connected in a pipeline, and
a CAS Consumer (CC) as shown in <a 
href="#x1-10001r1">Figure &#x00A0;1.1</a>.
<!--l. 99--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-10001r1"></a>
                                                                                                
                                                                                                

<!--l. 101--><p class="noindent" ><img 
src="images/uima-pipeline.jpg" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1.1: </span><span  
class="content">Standard UIMA Pipeline</span></div><!--tex4ht:label?: x1-10001r1 -->
                                                                                                
                                                                                                
<!--l. 104--><p class="noindent" ></div><hr class="endfigure">
<!--l. 106--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-110001.3"></a><span 
class="cmbx-10">UIMA-AS Scaled Pipeline</span></span>
With UIMA-AS the CR is separated into a discrete process and a CAS Multiplier (CM) is introduced into the pipeline as an
interface between the CR and the pipeline, as shown in <a 
href="#x1-11001r2">Figure &#x00A0;1.2</a> below. Multiple pipelines are serviced by the CR and are
scaled-out over a computing cluster. The difficulty with this model is that each user is individually responsible for finding and
scheduling computing nodes, installing communication software such as ActiveMQ, and generally managing the distributed
job and associated hardware.
<!--l. 116--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-11001r2"></a>
                                                                                                
                                                                                                

<!--l. 118--><p class="noindent" ><img 
src="images/uima-as-pipeline.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1.2: </span><span  
class="content">UIMA Pipeline As Scaled by UIMA-AS</span></div><!--tex4ht:label?: x1-11001r2 -->
                                                                                                
                                                                                                
<!--l. 121--><p class="noindent" ></div><hr class="endfigure">
<!--l. 123--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-120001.3"></a><span 
class="cmbx-10">UIMA Pipeline Scaled By DUCC</span></span>
DUCC is a UIMA and UIMA-AS-aware cluster manager. To scale out work under DUCC the developer tells DUCC what
the parts of the application are, and DUCC does the work to build the scale-out via UIMA/AS, to find and
schedule resources, to deploy the parts of the application over the cluster, and to manage the jobs while it
executes.
<!--l. 129--><p class="noindent" >On job submission, the CR is wrapped with a DUCC main class and launched as a Job Driver (or JD). The DUCC main
class establishes communication with other DUCC components and instantiates the CR. If the CR initializes
successfully, and indicates that there are greater than 0 work items to process, the specified CM, AE and CC
components are assembled into an aggregate, wrapped with a DUCC main class, and launched as a Job Process (or
JP).
<!--l. 135--><p class="noindent" >The JP will replicate the aggregate as many times as specified, each aggregate instance running in a single thread. When the
aggregate initializes, and whenever an aggregate thread needs work, the JP wrapper will fetch the next work item from the
JD, as shown in <a 
href="#x1-12001r3">Figure &#x00A0;1.3</a> below.
<!--l. 140--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-12001r3"></a>
                                                                                                
                                                                                                

<!--l. 142--><p class="noindent" ><img 
src="images/ducc-sequential.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1.3: </span><span  
class="content">UIMA Pipeline As Automatically Scaled Out By DUCC</span></div><!--tex4ht:label?: x1-12001r3 -->
                                                                                                
                                                                                                
<!--l. 145--><p class="noindent" ></div><hr class="endfigure">
<!--l. 147--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-130001.3"></a><span 
class="cmbx-10">UIMA Pipeline with User-Supplied DD Scaled By DUCC</span></span>
Application programmers may supply their own Deployment Descriptors to control intra-process threading and scale-out. If a
DD is specified in the job parameters, DUCC will launch each JP with the specified UIMA-AS service instantiated in-process,
as depicted in <a 
href="#x1-13001r4">Figure &#x00A0;1.4</a> below. In this case the user can still specify how many work items to deliver to the service
concurrently.
<!--l. 155--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-13001r4"></a>
                                                                                                
                                                                                                

<!--l. 157--><p class="noindent" ><img 
src="images/ducc-parallel.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;1.4: </span><span  
class="content">UIMA Pipeline With User-Supplied DD as Automatically Scaled Out By DUCC</span></div><!--tex4ht:label?: x1-13001r4 -->
                                                                                                
                                                                                                
<!--l. 160--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">1.4   </span> <a 
 id="x1-140001.4"></a>Error Management </h3>
<!--l. 164--><p class="noindent" >DUCC provides a number of facilities to assist error management:
     <ul class="itemize1">
     <li class="itemize">DUCC captures exceptions in the JPs and delivers them to the Job Drivers. The JD wrappers implement logic
     to enforce error thresholds, to identify and log errors, and to reflect job problems in the DUCC Web Server.
     Error thresholds are configurable both globally and on a per-job basis.
     </li>
     <li class="itemize">Error and timeout thresholds are implemented for both the initialization phase of a pipeline and the execution
     phase.
     </li>
     <li class="itemize">Retry-after-error is supported: if a process has a failure on some CAS after initialization is successful, the
     process is terminated and all affected CASs are retried, up to some configurable threshold.
     </li>
     <li class="itemize">To avoid disrupting existing workloads by a job that will fail to run, DUCC ensures that JD and JP processes
     can successfully initialize before fully scaling out a job.
     </li>
     <li class="itemize">Various error conditions encountered while a job is running will prevent a problematic job from continuing
     scale out, and can result in termination of the job.</li></ul>
<!--l. 186--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.5   </span> <a 
 id="x1-150001.5"></a>Cluster and Job Management</h3>
<!--l. 187--><p class="noindent" >DUCC supports management of multiple jobs and multiple users in a distributed cluster:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Multiple User Support</span> </dt><dd 
class="description">When properly configured, DUCC runs all work under the identity of the submitting
     user. Logs are written with the user&#8217;s credentials into the user&#8217;s file space designated at job submission.
     </dd><dt class="description">
<span 
class="cmbx-10">Fair-Share Scheduling</span> </dt><dd 
class="description">DUCC provides a Fair-Share scheduler to equitably share resources among multiple users.
     The scheduler also supports semi-permanent reservation of full or partial machines.
     </dd><dt class="description">
<span 
class="cmbx-10">Service Management</span> </dt><dd 
class="description">DUCC  provides  a  Service  Manager  capable  of  automatically  starting,  stopping,  and
     otherwise managing and querying both UIMA-AS and non-UIMA-AS services in support of jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">Job Lifetime Management and Orchestration</span> </dt><dd 
class="description">DUCC includes an Orchestrator to manage the lifetimes of all
     entities in the system.
     </dd><dt class="description">
<span 
class="cmbx-10">Node Sharing</span> </dt><dd 
class="description">DUCC allocates processes from one or more users on a node, each with a specified amount of
     memory. DUCC&#8217;s preferred mechanism for constraining memory use is Linux Control Groups, or CGroups. For
     nodes that do not suport CGroups, DUCC agents monitor RAM use and kill processes that exceed their share
     size by a settable fudge factor.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">DUCC Agents</span> </dt><dd 
class="description">DUCC Agents manage each node&#8217;s local resources and all processes started by DUCC. Each node in a
     cluster has exactly one Agent. The Agent
         <ul class="itemize1">
         <li class="itemize">Monitors and reports node capabilities (memory, etc) and performance data (CPU busy, swap, etc).
         </li>
         <li class="itemize">Starts, stops, and monitors all processes on behalf of users.
         </li>
         <li class="itemize">Patrols the node for &#8220;foreign&#8221; (non-DUCC) processes, reporting them to the Web Server, and optionally
         reaping them.
         </li>
         <li class="itemize">Ensures job processes do not exceed their declared memory requirements through the use of Linux Cgroups.</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">DUCC Web server</span> </dt><dd 
class="description">DUCC provides a web server displaying all aspects of the system:
         <ul class="itemize1">
         <li class="itemize">All jobs in the system, their current state, resource usage, etc.
         </li>
         <li class="itemize">All reserved resources and associated information (owner, etc.), including the ability to request and cancel
         reservations.
         </li>
         <li class="itemize">All services, including the ability to start, stop, and modify service definitions.
         </li>
         <li class="itemize">All nodes in the system and their status, usage, etc.
         </li>
         <li class="itemize">The status of all DUCC management processes.
         </li>
         <li class="itemize">Access to documentation.</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">Cluster Management Support</span> </dt><dd 
class="description">DUCC provides system management support to:
         <ul class="itemize1">
         <li class="itemize">Start, stop, and query full DUCC systems.
         </li>
         <li class="itemize">Start, stop, and quiesce individual DUCC components.
         </li>
         <li class="itemize">Add and delete nodes from the DUCC system.
         </li>
         <li class="itemize">Discover DUCC processes (e.g. after partial failures).
         </li>
         <li class="itemize">Find and kill errant job processes belonging to individual users.
         </li>
         <li class="itemize">Monitor and display inter-DUCC messages.</li></ul>
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 257--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.6   </span> <a 
 id="x1-160001.6"></a>Security Measures</h3>
<!--l. 258--><p class="noindent" >The following DUCC security measures are provided:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">user credentials</span> </dt><dd 
class="description">DUCC instantiates user processes using a setuid root executable named ducc_ling. See more at
     <a 
href="#x1-170001.6.1"><span 
class="cmti-10">ducc</span><span 
class="cmti-10">_ling</span></a>.
     </dd><dt class="description">
<span 
class="cmbx-10">command line interface</span> </dt><dd 
class="description">The CLI employs HTTP to send requests to the DUCC controller. The CLI creates and
     employs public and private security keys in the user&#8217;s home directory for authentication of HTTP requests.
     The controller validates requests via these same security keys.
     </dd><dt class="description">
<span 
class="cmbx-10">webserver</span> </dt><dd 
class="description">The webserver facilitates operational control and therefore authentication is desirable.
         <ul class="itemize1">
         <li class="itemize">Each user has the ability to control certain aspects of only his/her active submissions.
         </li>
         <li class="itemize">Each administrator has the ability to control certain aspects of any user&#8217;s active submissions, as well as
         modification of some DUCC operational characteristics.</li></ul>
     <!--l. 276--><p class="noindent" >A simple interface is provided so that an installation can plug-in a site specific authentication mechanism comprising
     userid and password.
     </dd><dt class="description">
<span 
class="cmbx-10">ActiveMQ</span> </dt><dd 
class="description">DUCC uses ActiveMQ for administrative communication. AMQ authentication is used to prevent arbitrary
     processes from participating.</dd></dl>
<!--l. 283--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">1.6.1   </span> <a 
 id="x1-170001.6.1"></a>ducc_ling</h4>
<!--l. 285--><p class="noindent" >ducc_ling contains the following functions, which the security-conscious may verify by examining the source in
$DUCC_HOME/duccling. All sensitive operations are performed only AFTER switching userids, to prevent unauthorized
root access to the system.
     <ul class="itemize1">
     <li class="itemize">Changes it&#8217;s real and effective userid to that of the user invoking the job.
     </li>
     <li class="itemize">Optionally redirects its stdout and stderr to the DUCC log for the current job.
     </li>
     <li class="itemize">Optionally redirects its stdio to a port set by the CLI, when a job is submitted.
     </li>
     <li class="itemize">&#8220;Nice&#8221;s itself to a &#8220;worse&#8221; priority than the default, to reduce the chances that a runaway DUCC job could
     monopolize a system.
     </li>
     <li class="itemize">Optionally sets user limits.
     </li>
     <li class="itemize">Prints the effective limits for a job to both the user&#8217;s log, and the DUCC agent&#8217;s log.
     </li>
     <li class="itemize">Changes to the user&#8217;s working directory, as specified by the job.
                                                                                                
                                                                                                
     </li>
     <li class="itemize">Optionally establishes LD_LIBRARY_PATH for the job from the environment variable <span 
class="cmtt-10">DUCC</span><span 
class="cmtt-10">_LD</span><span 
class="cmtt-10">_LIBRARY</span><span 
class="cmtt-10">_PATH</span>
     if set in the DUCC job specification. (Secure Linux systems will prevent LD_LIBRARY_PATH from being set
     by a program with root authority, so this is done AFTER changing userids).
     </li>
     <li class="itemize">ONLY user <span 
class="cmti-10">ducc </span>may use the ducc_ling program in a privileged way. Ducc_ling contains checks to prevent even
     user <span 
class="cmti-10">root </span>from using it for privileged operations.
     </li></ul>
<!--l. 310--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">1.7   </span> <a 
 id="x1-180001.7"></a>Security Issues</h3>
<!--l. 311--><p class="noindent" >The following DUCC security issues should be considered:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">submit transmission &#8217;sniffed&#8217;</span> </dt><dd 
class="description">In  the  event  that  the  DUCC  submit  command  is  &#8217;sniffed&#8217;  then  the  user
     authentication mechanism is compromised and user masquerading is possible. That is, the userid encryption
     mechanism can be exploited such that user A can submit a job pretending to be user B.
     </dd><dt class="description">
<span 
class="cmbx-10">user </span><span 
class="cmbxti-10">ducc </span><span 
class="cmbx-10">password compromised</span> </dt><dd 
class="description">In  the  event  that  the  <span 
class="cmti-10">ducc  </span>user  password  is  compromised  then  the  root
     privileged command <span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_ling </span>can be used to become any other user except root.
     </dd><dt class="description">
<span 
class="cmbx-10">user </span><span 
class="cmbxti-10">root </span><span 
class="cmbx-10">password compromised</span> </dt><dd 
class="description">In the event that the <span 
class="cmti-10">root </span>user password is compromised DUCC provides no
     protection. That is, compromising the root user is equivalent to compromising the DUCC user password.</dd></dl>
<!--l. 22--><p class="noindent" ><a name='DUCC_TERMINOLOGY'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-190002"></a>Glossary</h2>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Autostarted Service</span> </dt><dd 
class="description">An autostarted service is a registered service that is started automatically by DUCC when
     the DUCC system is booted.
     </dd><dt class="description">
<span 
class="cmbx-10">Dependent service or job</span> </dt><dd 
class="description">A  dependent  service  or  job  is  a  service  or  job  that  specifies  one  or  more  service
     dependencies in their job specification. The service or job is dependent upon the referenced service being
     operational before being started by DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">DUCC</span> </dt><dd 
class="description">Distributed UIMA Cluster Computing.
     </dd><dt class="description">
<span 
class="cmbx-10">Registered service</span> </dt><dd 
class="description">A  registered  service  is  a  service  that  is  registered  with  DUCC.  DUCC  saves  the  service
     specification and fully manages the service, insuring it is running when needed, and shutdown when not.
     </dd><dt class="description">
<span 
class="cmbx-10">Service Instance</span> </dt><dd 
class="description">A service instance is one physical process which runs a CUSTOM or UIMA-AS service. UIMA-AS
     services are usually scaled-out with multiple instances implementing the same underlying service logic.
     </dd><dt class="description">
<span 
class="cmbx-10">Orchestrator (OR)</span> </dt><dd 
class="description">The Orchestrator manages the life cycle of all entities within DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">Process Manager (PM)</span>  </dt><dd 
class="description">The Process Manager coordinates distribution of work among the Agents.
     </dd><dt class="description">
<span 
class="cmbx-10">Resource Manager (RM)</span>  </dt><dd 
class="description">The Resource Manager schedules physical resources for DUCC work.
     </dd><dt class="description">
<span 
class="cmbx-10">Service Endpoint</span> </dt><dd 
class="description">In DUCC, the service endpoint provides a unique identifier for a service. In the case of UIMA-AS
     services, the endpoint also serves as a well-known address for contacting the service.
     </dd><dt class="description">
<span 
class="cmbx-10">Service Manager (SM)</span> </dt><dd 
class="description">The Service Manager manages the life-cycles of UIMA-AS and CUSTOM services. It
     coordinates registration of services, starting and stopping of services, and ensures that services are available
     and remain available for the lifetime of the jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">Agent</span> </dt><dd 
class="description">DUCC Agent processes run on every node in the system. The Agent receives orders to start and stop processes
     on each node. Agents monitors nodes, sending heartbeat packets with node statistics to interested components
     (such as the RM and web-server). If CGroups are installed in the cluster, the Agent is responsible for managing
     the CGroups for each job process. All processes other than the DUCC management processes are are managed
     as children of the agents.
     </dd><dt class="description">
<span 
class="cmbx-10">DUCC-MON</span> </dt><dd 
class="description">DUCC-MON is the DUCC web-server.
     </dd><dt class="description">
<span 
class="cmbx-10">Job Driver (JD)</span> </dt><dd 
class="description">The Job Driver is a thin wrapper that encapsulates a Job&#8217;s Collection Reader. The JD executes
     as a process that is scheduled and deployed by DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">Job Process (JP)</span> </dt><dd 
class="description">The Job Process is a thin wrapper that encapsulates a job&#8217;s pipeline components. The JP
     executes in a process that is scheduled and deployed by DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">Job specification</span> </dt><dd 
class="description">The Job Specification is a collection of properties that describe work to be scheduled and deployed
     by DUCC. It identifies the UIMA components (CR, AE, etc) that comprise the job and the system-wide
     properties of the job (CLASSPATHs, RAM requirements, etc).
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Job</span> </dt><dd 
class="description">A DUCC job consists of the components required to deploy and execute a UIMA pipeline over a computing
     cluster. It consists of a JD to run the Collection Reader, a set of JPs to run the UIMA AEs, and a Job
     Specification to describe how the parts fit together.
     </dd><dt class="description">
<span 
class="cmbx-10">Share Quantum</span> </dt><dd 
class="description">The DUCC scheduler abstracts the nodes in the cluster as a single large conglomerate of resources:
     memory, processor cores, etc. The scheduler logically decomposes the collection of resources into some number
     of equal-sized atomic units. Each unit of work requiring resources is apportioned one or more of these atomic
     units. The smallest possible atomic unit is called the <span 
class="cmti-10">share quantum</span>, or simply, <span 
class="cmti-10">share</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">Process</span> </dt><dd 
class="description">A process is one physical process executing on a machine in the DUCC cluster. DUCC jobs are comprised
     of one or more processes (JDs and JPs). Each process is assigned one or more <span 
class="cmti-10">shares </span>by the DUCC scheduler.
     </dd><dt class="description">
<span 
class="cmbx-10">Weighted Fair Share</span> </dt><dd 
class="description">A weighted fair share calculation is used to apportion resources equitably to the outstanding
     work in the system. In a non-weighted fair-share system, all work requests are given equal consideration to all
     resources. To provide some (&#8220;more important&#8221;) work more than equal resources, weights are used to bias the
     allotment of shares in favor of some classes of work.
     </dd><dt class="description">
<span 
class="cmbx-10">Work Items</span> </dt><dd 
class="description">A DUCC work item is one unit of work to be completed in a single DUCC process. It is usually
     initiated by the submission of a single CAS from the JD to one of the JPs. It could be thought of as a single
     &#8220;question&#8221; to be answered by a UIMA analytic, or a single &#8220;task&#8221; to complete. Usually each DUCC JP executes
     many work items per job.
     </dd><dt class="description">
<span 
class="cmbx-10">$DUCC</span><span 
class="cmbx-10">_HOME</span> </dt><dd 
class="description">The root of the installed DUCC runtime, e.g. /home/ducc/ducc_runtime. It need not be set in
     the environment, although the examples in this document assume that it has been.
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 83--><p class="noindent" >
                                                                                                
                                                                                                
<h1 class="partHead"><span class="titlemark">Part&#x00A0;II<br /></span><a 
 id="x1-20000II"></a>Ducc Users Guide</h1>
<!--l. 23--><p class="noindent" ><a name='DUCC_CLI'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-210003"></a>Command Line Interface</h2>
<!--l. 28--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-220003"></a><span 
class="cmbx-10">Overview</span></span>
The DUCC CLI is the primary means of communication with DUCC. Work is submitted, work is canceled, work is
monitored, and work is queried with this interface.
<!--l. 32--><p class="noindent" >All parameters may be passed to all the CLI commands in the form of Unix-like &#8220;long-form&#8221; (key, value) pairs, in which the
key is proceeded by the characters &#8220;<span 
class="cmsy-10">--</span>&#8221;. As well, the parameters may be saved in a standard Java Properties file, without
the leading &#8220;<span 
class="cmsy-10">--</span>&#8221; characters. Both a properties file and command-line parameters may be passed to each CLI.
When both are present, the parameters on the command line take precedence. Take, for example the following
simple job properties file, call it <span 
class="cmtt-10">1.job</span>, where the environment variable &#8220;DH&#8221; has been set to the location of
$DUCC_HOME.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-1">
description&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Test&#x00A0;job&#x00A0;1
&#x00A0;<br />
&#x00A0;<br />classpath&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;${DH}/lib/uima-ducc/examples/*
&#x00A0;<br />environment&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;AE_INIT_TIME=5&#x00A0;AE_INIT_RANGE=5&#x00A0;LD_LIBRARY_PATH=/a/nother/path
&#x00A0;<br />scheduling_class&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;normal
&#x00A0;<br />
&#x00A0;<br />driver_descriptor_CR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;org.apache.uima.ducc.test.randomsleep.FixedSleepCR
&#x00A0;<br />driver_descriptor_CR_overrides&#x00A0;jobfile=${DH}/lib/examples/simple/1.inputs&#x00A0;compression=10
&#x00A0;<br />error_rate=0.0
&#x00A0;<br />
&#x00A0;<br />driver_jvm_args&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-Xmx500M
&#x00A0;<br />
&#x00A0;<br />process_descriptor_AE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;org.apache.uima.ducc.test.randomsleep.FixedSleepAE
&#x00A0;<br />process_memory_size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;4
&#x00A0;<br />process_jvm_args&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-Xmx100M
&#x00A0;<br />process_thread_count&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />process_per_item_time_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;5
&#x00A0;<br />process_deployments_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;999
&#x00A0;<br /></div>
<!--l. 59--><p class="nopar" >
<!--l. 61--><p class="noindent" >This can be submitted, overriding the scheduling class and memory, thus:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-2">
ducc_submit&#x00A0;--specification&#x00A0;1.job&#x00A0;--process_memory_size&#x00A0;16&#x00A0;--scheduling_class&#x00A0;high</div>
<!--l. 64--><p class="nopar" >
<!--l. 66--><p class="noindent" >The DUCC CLI parameters are now described in detail.
<!--l. 68--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-230003.1"></a>The DUCC Job Descriptor</h3>
<!--l. 69--><p class="noindent" >The DUCC Job Descriptor includes properties to enable automated management and scale-out over large computing clusters.
The job descriptor includes
     <ul class="itemize1">
     <li class="itemize">References to the various UIMA components required by the job (CR, CM, AE, CC, and maybe DD)
     </li>
     <li class="itemize">Scale-out requirements: number of processes, number of threads per process, etc
     </li>
     <li class="itemize">Environment requirements: log directory, working directory, environment variables, etc,
     </li>
     <li class="itemize">JVM parameters
     </li>
     <li class="itemize">Scheduling class
     </li>
     <li class="itemize">Error-handling preferences: acceptable failure counts, timeouts, etc
     </li>
     <li class="itemize">Debugging and monitoring requirements and preferences</li></ul>
<!--l. 81--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-240003.2"></a>Operating System Limit Support</h3>
<!--l. 82--><p class="noindent" >The CLI supports specification of operating system limits applied to the various job processes. To specify a limit, pass the
name of the limit and its value in the <span 
class="cmti-10">environment </span>specified in the job. Limits are named with the string
&#8220;DUCC_RLIMIT_name&#8221; where &#8220;name&#8221; is the name of a specific limit. Supported limits include:
     <ul class="itemize1">
     <li class="itemize">DUCC_RLIMIT_CORE
     </li>
     <li class="itemize">DUCC_RLIMIT_CPU
     </li>
     <li class="itemize">DUCC_RLIMIT_DATA
     </li>
     <li class="itemize">DUCC_RLIMIT_FSIZE
                                                                                                
                                                                                                
     </li>
     <li class="itemize">DUCC_RLIMIT_MEMLOCK
     </li>
     <li class="itemize">DUCC_RLIMIT_NOFILE
     </li>
     <li class="itemize">DUCC_RLIMIT_NPROC
     </li>
     <li class="itemize">DUCC_RLIMIT_RSS
     </li>
     <li class="itemize">DUCC_RLIMIT_STACK
     </li>
     <li class="itemize">DUCC_RLIMIT_AS
     </li>
     <li class="itemize">DUCC_RLIMIT_LOCKS
     </li>
     <li class="itemize">DUCC_RLIMIT_SIGPENDING
     </li>
     <li class="itemize">DUCC_RLIMIT_MSGQUEUE
     </li>
     <li class="itemize">DUCC_RLIMIT_NICE
     </li>
     <li class="itemize">DUCC_RLIMIT_STACK
     </li>
     <li class="itemize">DUCC_RLIMIT_RTPRIO</li></ul>
<!--l. 104--><p class="noindent" >See the Linux documentation for details on the meanings of these limits and their values.
<!--l. 106--><p class="noindent" >For example, to set the maximum number of open files allowed in any job process, specify an environment similar to this
when submitting the job:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-3">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc_submit&#x00A0;....&#x00A0;--environment="DUCC_RLIMT_NOFILE=1024"&#x00A0;...</div>
<!--l. 110--><p class="nopar" >
<!--l. 112--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-250003.3"></a>Command Line Forms</h3>
<!--l. 113--><p class="noindent" >The Command Line Interface is provided in several forms:
<!--l. 116--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">A wrapper script around the uima-ducc-cli.jar.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Direct invocation of each command&#8217;s <span 
class="cmtt-10">class </span>with the <span 
class="cmtt-10">java </span>command.</dd></dl>
<!--l. 120--><p class="noindent" >When using the scripts the full execution environment is established silently. When invoking a command&#8217;s <span 
class="cmtt-10">class </span>directly, the
java <span 
class="cmtt-10">CLASSPATH </span>must include the uima-ducc-cli.jar, as illustrated in the wrapper scripts.
<!--l. 124--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-260003.4"></a>DUCC Commands</h3>
<!--l. 125--><p class="noindent" >The following commands are provided:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_submit</span> </dt><dd 
class="description">Submit a job for execution.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_cancel</span> </dt><dd 
class="description">Cancel a job in progress.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_reserve</span> </dt><dd 
class="description">Request a reservation of a full machine.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_unreserve</span> </dt><dd 
class="description">Cancel a reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_monitor</span> </dt><dd 
class="description">Monitor the progress of a job that is already submitted.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_process</span><span 
class="cmbx-10">_submit</span> </dt><dd 
class="description">Submit an arbitrary process (managed reservation) for execution.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_process</span><span 
class="cmbx-10">_cancel</span> </dt><dd 
class="description">Cancel an arbitrary process.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_services</span> </dt><dd 
class="description">Register, unregister, start, stop, modify, disable, enable, ignore references, observe references, and
     query a service.
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_view</span><span 
class="cmbx-10">_perf</span> </dt><dd 
class="description">Fetch performance data from the log and history files for analysis by spreadsheets, etc.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">viaducc</span> </dt><dd 
class="description">This is a script wrapper to facilitate execution of Eclipse workspaces as DUCC jobs as well as general
     execution of arbitrary processes in DUCC-managed resources.</dd></dl>
<!--l. 142--><p class="noindent" >The next section describes these commands in detail.
<!--l. 22--><p class="noindent" ><a name='DUCC_CLI_SUBMIT'></a>
<!--l. 25--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">3.5   </span> <a 
 id="x1-270003.5"></a>ducc_submit</h3>
<!--l. 27--><p class="noindent" >The source for this section is ducc_duccbook/documents/part-user/cli/submit.xml.
<!--l. 28--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-280003.5"></a><span 
class="cmbx-10">Description:</span></span>
The submit CLI is used to submit work for execution by DUCC. DUCC assigns a unique id to the job and schedules it for
execution. The submitter may optionally request that the progress of the job is monitored, in which case the state of the job
as it progresses through its lifetime is printed on the console.
<!--l. 33--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-290003.5"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_submit <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar org.apache.uima.ducc.cli.DuccJobSubmit <span 
class="cmti-10">options</span></dd></dl>
<!--l. 39--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-300003.5"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">all</span><span 
class="cmbx-10">_in</span><span 
class="cmbx-10">_one </span><span 
class="cmmi-10">&#x003C;</span><span 
class="cmbx-10">local </span><span 
class="cmsy-10">| </span><span 
class="cmbx-10">remote </span><span 
class="cmmi-10">&#x003E;</span> </dt><dd 
class="description">Run driver and pipeline in single process. If <span 
class="cmti-10">local </span>is specified, the process is
     executed on the local machine, for example, in the current Eclipse session. If <span 
class="cmti-10">remote </span>is specified, the jobs is
     submitted to DUCC as a <span 
class="cmti-10">managed reservation </span>and run on some (presumably larger) machine allocated by
     DUCC.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">attach</span><span 
class="cmbx-10">_console</span> </dt><dd 
class="description">If specified, redirect remote stdout and stderr to the local submitting console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">cancel</span><span 
class="cmbx-10">_on</span><span 
class="cmbx-10">_interrupt</span> </dt><dd 
class="description">If  specified,  the  job  is  monitored  and  will  be  canceled  if  the  submit  command  is
     interrupted, e.g. with CTRL-C. This option always implies <span 
class="cmsy-10">--</span>wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">classpath [path-string]</span> </dt><dd 
class="description">The CLASSPATH used for the job. If specified, this is used for both the Job Driver
     and each Job Process. If not specified, the CLASSPATH of the process invoking this request is used.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span> </dt><dd 
class="description">Enable debugging messages. This is primarily for debugging DUCC itself.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">description [text]</span> </dt><dd 
class="description">The text is any string used to describe the job. It is displayed in the Web Server. When
     specified on a command-line the text usually must be surrounded by quotes to protect it from the shell. The
     default is &#8220;none&#8221;.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_debug [debug-port]</span> </dt><dd 
class="description">Append JVM debug flags to the JVM arguments to start the JobDriver in remote
     debug mode. The remote process debugger will attempt to contact the specified port.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CR [descriptor.xml]</span>  </dt><dd 
class="description">This  is  the  XML  descriptor  for  the  Collection  Reader.  This
     descriptor is a resource that is searched for in the filesystem or Java classpath as described in the &#x00A0;<a 
href="#x1-310003.5">notes below</a>.
     (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CR</span><span 
class="cmbx-10">_overrides [list]</span>  </dt><dd 
class="description">This is the Job Driver collection reader configuration overrides. They are
     specified as name/value pairs in a whitespace-delimited list. For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-4">
     --driver_descriptor_CR_overrides&#x00A0;name1=value1&#x00A0;name2=value2...
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 79--><p class="nopar" >
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_exception</span><span 
class="cmbx-10">_handler [classname]</span> This specifies a developer-supplied exception handler for the Job Driver. It
     must implement org.apache.uima.ducc.IErrorHandler or extend org.apache.uima.ducc.ErrorHandler. A default handler
     is provided.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_exception</span><span 
class="cmbx-10">_handler</span><span 
class="cmbx-10">_arguments [argument-string]</span> </dt><dd 
class="description">This is a string containing arguments for the exception
     handler. The contents of the string is entirely a function of the specified handler. If not specified, a <span 
class="cmti-10">null </span>is passed
     in.
     <!--l. 93--><p class="noindent" >Note: When used as a CLI option, the string must usually be quoted to protect it from the shell, if it contains
     blanks.
     <!--l. 96--><p class="noindent" >The built-in default exception handler supports an argument string of the following form (with NO embedded
     blanks):
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-5">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;max_job_errors=15</div>
     <!--l. 100--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">driver</span><span 
class="cmbx-10">_jvm</span><span 
class="cmbx-10">_args [list]</span>  </dt><dd 
class="description">
     <!--l. 104--><p class="noindent" >This specifies extra JVM arguments to be provided to the Job Driver process. It is a blank-delimited list of strings.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-6">
     --driver_jvm_args&#x00A0;-Xmx100M&#x00A0;-Xms50M
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 108--><p class="nopar" >
     <!--l. 110--><p class="noindent" >Note: When used as a CLI option, the list must usually be quoted to protect it from the shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">environment [env vars]</span> </dt><dd 
class="description">Blank-delimited list of environment variables and variable assignments. Entries will be copied
     from the user&#8217;s environment if just the variable name is specified, optionally with a final &#8217;*&#8217; for those with the same
     prefix. If specified, this is used for all DUCC processes in the job. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-7">
     --environment&#x00A0;TERM=xterm&#x00A0;DISPLAY=:1.0&#x00A0;LANG&#x00A0;UIMA_*</div>
     <!--l. 120--><p class="nopar" >
     <!--l. 122--><p class="noindent" >Additional entries may be copied from the user&#8217;s environment based on the setting of
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-8">
     ducc.submit.environment.propagated</div>
     <!--l. 125--><p class="nopar" > in the global DUCC configuration ducc.properties.
     <!--l. 128--><p class="noindent" >Note: When used as a CLI option, the environment string must usually be quoted to protect it from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span>  </dt><dd 
class="description">
     <!--l. 133--><p class="noindent" >Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">jvm [path-to-java]</span>  </dt><dd 
class="description">
     <!--l. 137--><p class="noindent" >States the JVM to use. If not specified, the same JVM used by the Agents is used. This is the full path to the JVM, not
     the JAVA_HOME. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-9">
     --jvm&#x00A0;/share/jdk1.6/bin/java</div>
     <!--l. 142--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">log</span><span 
class="cmbx-10">_directory [path-to-log-directory]</span>  </dt><dd 
class="description">
     <!--l. 146--><p class="noindent" >This specifies the path to the directory for the user logs. If not specified, the default is $HOME/ducc/logs.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-10">
     --log_directory&#x00A0;/home/bob
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 150--><p class="nopar" >
     <!--l. 152--><p class="noindent" >Within this directory DUCC creates a sub-directory for each job, using the unique numerical ID of the job. The format
     of the generated log file names as described <a 
href="#x1-1260006">here</a>.
     <!--l. 156--><p class="noindent" >Note: Note that <span 
class="cmsy-10">--</span>log_directory specifies only the path to a directory where logs are to be stored. In order to manage
     multiple processes running in multiple machines, sub-directory and file names are generated by DUCC and may not be
     directly specified.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_debug [debug-port]</span> </dt><dd 
class="description">Append JVM debug flags to the JVM arguments to start the Job Process in remote
     debug mode. The remote process will start its debugger and attempt to contact the debugger (usually Eclipse) on the
     specified port.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_deployments</span><span 
class="cmbx-10">_max [integer]</span>  </dt><dd 
class="description">
     <!--l. 168--><p class="noindent" >This specifies the maximum number of Job Processes to deploy at any given time. If not specified, DUCC will attempt
     to provide the largest number of processes within the constraints of fair_share scheduling and the amount of work
     remaining. in the job. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-11">
     --process_deployments_max&#x00A0;66
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 174--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_AE [descriptor]</span>  </dt><dd 
class="description">
     <!--l. 179--><p class="noindent" >This specifies the Analysis Engine descriptor to be deployed in the Job Processes. This descriptor is a resource that is
     searched for in the filesystem or Java classpath as described in the &#x00A0;<a 
href="#x1-310003.5">notes below</a>. It is mutually exclusive with
     <span 
class="cmsy-10">--</span>process_descriptor_DD For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-12">
     --process_descriptor_AE&#x00A0;/home/billy/resource/AE_foo.xml
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 185--><p class="nopar" >
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_AE</span><span 
class="cmbx-10">_overrides [list]</span>
     <!--l. 191--><p class="noindent" >This specifies AE overrides. It is a whitespace-delimited list of name/value pairs. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-13">
     --process_descriptor_AE_Overrides&#x00A0;name1=value1&#x00A0;name2=value2
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 194--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CC [descriptor]</span>  </dt><dd 
class="description">
     <!--l. 199--><p class="noindent" >This specifies the CAS Consumer descriptor to be deployed in the Job Processes. This descriptor is a resource that is
     searched for in the filesystem or Java classpath as described in the &#x00A0;<a 
href="#x1-310003.5">notes below</a>. It is mutually exclusive with
     <span 
class="cmsy-10">--</span>process_descriptor_DD For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-14">
     --process_descriptor_CC&#x00A0;/home/billy/resourceCCE_foo.xml
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 205--><p class="nopar" >
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CC</span><span 
class="cmbx-10">_overrides [list]</span>
     <!--l. 210--><p class="noindent" >This specifies CC overrides. It is a whitespace-delimited list of name/value pairs. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-15">
     --process_descriptor_CC_overrides&#x00A0;name1=value1&#x00A0;name2=value2
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 213--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CM [descriptor]</span>  </dt><dd 
class="description">
     <!--l. 218--><p class="noindent" >This specifies the CAS Multiplier descriptor to be deployed in the Job Processes. This descriptor is a resource that is
     searched for in the filesystem or Java classpath as described in the &#x00A0;<a 
href="#x1-310003.5">notes below</a>. It is mutually exclusive with
     <span 
class="cmsy-10">--</span>process_descriptor_DD For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-16">
     --process_descriptor_CM&#x00A0;/home/billy/resource/CM_foo.xml
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 224--><p class="nopar" >
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_CM</span><span 
class="cmbx-10">_overrides [list]</span>
     <!--l. 229--><p class="noindent" >This specifies CM overrides. It is a whitespace-delimited list of name/value pairs. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-17">
     --process_descriptor_CM_overrides&#x00A0;name1=value1&#x00A0;name2=value2</div>
     <!--l. 232--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_DD [descriptor]</span>  </dt><dd 
class="description">
     <!--l. 237--><p class="noindent" >This specifies a UIMA Deployment Descriptor for the job processes for DD-style jobs. This is mutually exclusive with
     <span 
class="cmsy-10">--</span>process_descriptor_AE, <span 
class="cmsy-10">--</span>process_descriptor_CM, and <span 
class="cmsy-10">--</span>process_descriptor_CC. This descriptor is a
     resource that is searched for in the filesystem or Java classpath as described in the &#x00A0;<a 
href="#x1-310003.5">notes below</a>. For
     example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-18">
     --process_descriptor_DD&#x00A0;/home/billy/resource/DD_foo.xml
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 245--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_failures</span><span 
class="cmbx-10">_limit [integer]</span>  </dt><dd 
class="description">This specifies the maximum number of individual Job Process (JP) failures allowed
     before killing the job. The default is twenty(20). If this limit is exceeded over the lifetime of a job DUCC terminates the
     entire job.
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-19">
     --process_failures_limit&#x00A0;23</div>
     <!--l. 253--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_initialization</span><span 
class="cmbx-10">_failures</span><span 
class="cmbx-10">_cap [integer]</span>  </dt><dd 
class="description">This specifies the maximum number of failures during a
     UIMA process&#8217;s initialization phase. If the number is exceeded the system will allow processes which are
     already running to continue, but will assign no new processes to the job. The default is ninety-nine(99).
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-20">
     --process_initialization_failures_cap&#x00A0;62
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 261--><p class="nopar" >
     <!--l. 263--><p class="noindent" >Note that the job is NOT killed if there are processes that have passed initialization and are running. If this limit is
     reached, the only action is to not start new processes for the job.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_initialization</span><span 
class="cmbx-10">_time</span><span 
class="cmbx-10">_max [integer]</span> </dt><dd 
class="description">This is the maximum time a process is allowed to remain in the
     &#8220;initializing&#8221; state, before DUCC terminates it. The error counts as an initialization error towards the initialization
     failure cap.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_jvm</span><span 
class="cmbx-10">_args [list]</span>  </dt><dd 
class="description">This specifies additional arguments to be passed to all of the job processes as a
     blank-delimited list of strings. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-21">
     --process_jvm_args&#x00A0;-Xmx400M&#x00A0;-Xms100M
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 274--><p class="nopar" >
     <!--l. 276--><p class="noindent" >Note: When used as a CLI option, the arguments must usually be quoted to protect them from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_memory</span><span 
class="cmbx-10">_size [size]</span>  </dt><dd 
class="description">This specifies the maximum amount of RAM in GB to be allocated to each Job Process.
     This value is used by the Resource Manager to allocate resources.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_per</span><span 
class="cmbx-10">_item</span><span 
class="cmbx-10">_time</span><span 
class="cmbx-10">_max [integer]</span>  </dt><dd 
class="description">This specifies the maximum time in minutes that the Job Driver will wait
     for a Job Processes to process a CAS. If a timeout occurs the process is terminated and the CAS marked in error (not
     retried). If not specified, the default is 1 minute. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-22">
     --process_per_item_time_max&#x00A0;60
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 289--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_thread</span><span 
class="cmbx-10">_count [integer]</span>  </dt><dd 
class="description">This specifies the number of threads per process to be deployed. It is used by the
     Resource Manager to determine how many processes are needed, by the Job Process wrapper to determine how many
     threads to spawn, and by the Job Driver to determine how many CASs to dispatch. If not specified, the default is 4.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-23">
     --process_thread_count&#x00A0;7
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 298--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">scheduling</span><span 
class="cmbx-10">_class [classname]</span>  </dt><dd 
class="description">This specifies the name of the scheduling class the RM will use to determine the
     resource allocation for each process. The names of the classes are installation dependent. If not specified, the
     FAIR_SHARE default is taken from the site class definitions file described <a 
href="#x1-23000012.6.2">here.</a> Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-24">
     --scheduling_class&#x00A0;normal
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 308--><p class="nopar" >
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_dependency[list]</span> This specifies a blank-delimited list of services the job processes are dependent upon. Service
     dependencies are discussed in detail <a 
href="#x1-840005.4">here</a>. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-25">
     --service_dependency&#x00A0;UIMA-AS:Service1:tcp:host1:61616&#x00A0;UIMA-AS:Service2:tcp:host2:123</div>
     <!--l. 316--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">specification, </span><span 
class="cmsy-10">-</span><span 
class="cmbx-10">f [file]</span>  </dt><dd 
class="description">
     <!--l. 321--><p class="noindent" >All the parameters used to submit a job may be placed in a standard Java properties file. This file may then be used to
     submit the job (rather than providing all the parameters directory to submit). The leading <span 
class="cmsy-10">-- </span>is omitted from the
     keywords.
     <!--l. 325--><p class="noindent" >For example,
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-26">
     ducc_submit&#x00A0;--specification&#x00A0;job.props
     &#x00A0;<br />ducc_submit&#x00A0;-f&#x00A0;job.props</div>
     <!--l. 329--><p class="nopar" >
     <!--l. 331--><p class="noindent" >where job.props contains:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-27">
     working_directory&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/home/bob/projects/ducc/ducc_test/test/bin
     &#x00A0;<br />process_failures_limit&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;20
     &#x00A0;<br />driver_descriptor_CR&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;org.apache.uima.ducc.test.randomsleep.FixedSleepCR
     &#x00A0;<br />environment&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;AE_INIT_TIME=10000&#x00A0;UIMA&#x00A0;LD_LIBRARY_PATH=/a/bogus/path
     &#x00A0;<br />log_directory&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/home/bob/ducc/logs/
     &#x00A0;<br />process_thread_count&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;1
     &#x00A0;<br />driver_descriptor_CR_overrides&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;jobfile:../simple/jobs/1.job&#x00A0;compression:10
     &#x00A0;<br />process_initialization_failures_cap&#x00A0;=&#x00A0;99
     &#x00A0;<br />process_per_item_time_max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;60
     &#x00A0;<br />driver_jvm_args&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;-Xmx500M
     &#x00A0;<br />process_descriptor_AE&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;org.apache.uima.ducc.test.randomsleep.FixedSleepAE
     &#x00A0;<br />classpath&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/home/bob/duccapps/ducky_process.jar
     &#x00A0;<br />description&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;../simple/jobs/1.job[AE]
     &#x00A0;<br />process_jvm_args&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;-Xmx100M&#x00A0;-DdefaultBrokerURL=tcp://localhost:61616
     &#x00A0;<br />scheduling_class&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;normal
     &#x00A0;<br />process_memory_size&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;15</div>
     <!--l. 349--><p class="nopar" >
     <!--l. 351--><p class="noindent" >Note that properties in a specifications file may be overridden by other command-line parameters, as discussed
     <a 
href="#x1-210003">here</a>.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">suppress</span><span 
class="cmbx-10">_console</span><span 
class="cmbx-10">_log</span> </dt><dd 
class="description">If specified, suppress creation of the log files that normally hold the redirected stdout and
     stderr.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">timestamp</span>  </dt><dd 
class="description">If specified, messages from the submit process are timestamped. This is intended primarily for use with a
     monitor with &#8211;wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">wait</span><span 
class="cmbx-10">_for</span><span 
class="cmbx-10">_completion</span>  </dt><dd 
class="description">If specified, the submit command monitors the job and prints periodic state and progress
     information to the console. When the job completes, the monitor is terminated and the submit command returns. If the
     command is interrupted, e.g. with CTRL-C, the job will not be canceled unless <span 
class="cmsy-10">--</span>cancel_on_interrupt is also
     specified.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">working</span><span 
class="cmbx-10">_directory</span>  </dt><dd 
class="description">This specifies the working directory to be set by the Job Driver and Job Process processes. If not
     specified, the current directory is used.</dd></dl>
<!--l. 372--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-310003.5"></a><span 
class="cmbx-10">Notes:</span></span>
<a 
 id="likesection.1"></a> When searching for UIMA XML resource files such as descriptors, DUCC searches either the filesystem or Java classpath
according to the following rules:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">If the resource ends in .xml it is assumed the resource is a file in the filesystem and the path is either an
     absolute path or a path relative to the specified working directory.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">If the resource does not end in .xml, it is assumed the resource is in the Java classpath. DUCC creates a
     resource name by replacing the &#8221;.&#8221; separators with &#8221;/&#8221; and appending &#8221;.xml&#8221;.</dd></dl>
<!--l. 22--><p class="noindent" ><a name='DUCC_CLI_CANCEL'></a>
                                                                                                
                                                                                                
<h3 class="sectionHead"><span class="titlemark">3.6   </span> <a 
 id="x1-320003.6"></a>ducc_cancel</h3>
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-330003.6"></a><span 
class="cmbx-10">Description:</span></span>
The cancel CLI is used to cancel a job that has previously been submitted but which has not yet completed.
<!--l. 31--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-340003.6"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_cancel <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar org.apache.uima.ducc.cli.DuccJobCancel <span 
class="cmti-10">options</span></dd></dl>
<!--l. 37--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-350003.6"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">id [jobid]</span> </dt><dd 
class="description">The ID is the id of the job to cancel. (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">reason [quoted string]</span> </dt><dd 
class="description">Optional. This specifies the reason the job is canceled for display in the web server. Note that
     the shell requires a quoted string. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-28">
     ducc_cancel&#x00A0;--id&#x00A0;12&#x00A0;--reason&#x00A0;"This&#x00A0;is&#x00A0;a&#x00A0;pretty&#x00A0;good&#x00A0;reason."</div>
     <!--l. 48--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">dpid [pid]</span> </dt><dd 
class="description">If specified only this DUCC process will be canceled. If not specified, then entire job will be canceled. The <span 
class="cmti-10">pid</span>
     is the DUCC-assigned process ID of the process to cancel. This is the ID in the first column of the Web Server&#8217;s job
     details page, under the column labeled &#8220;Id&#8221;.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span> </dt><dd 
class="description">Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">role</span><span 
class="cmbx-10">_administrator</span> </dt><dd 
class="description">The command is being issued in the role of a DUCC administrator. If the user is not also a
     registered administrator this flag is ignored. (This helps to protect administrators from accidentally canceling jobs they
     do not own.)</dd></dl>
<!--l. 61--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-360003.6"></a><span 
class="cmbx-10">Notes:</span></span>
None.
<!--l. 22--><p class="noindent" ><a name='DUCC_CLI_RESERVE'></a>
<h3 class="sectionHead"><span class="titlemark">3.7   </span> <a 
 id="x1-370003.7"></a>ducc_reserve</h3>
<!--l. 26--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-380003.7"></a><span 
class="cmbx-10">Description:</span></span>
The reserve CLI is used request a reservation of resources. Reservations can be for entire machines or partial machines, based
on memory requirements. All reservations are persistent: the resources remain dedicated to the requestor until explicitly
returned. All reservations are performeed on an &#8221;all-or-nothing&#8221; basis: either the entire set of requested resources is reserved,
or the reservation request fails.
<!--l. 33--><p class="noindent" >All forms of ducc_reserve block until the reservation is complete (or fails) at which point the DUCC ID of the reservation and
the names of the reserved nodes are printed to the console and the command returns.
<!--l. 37--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-390003.7"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_reserve <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java    -cp    $DUCC_HOME/lib/uima-ducc-cli.jar    org.apache.uima.ducc.cli.DuccReservationSubmit
     <span 
class="cmti-10">options</span></dd></dl>
                                                                                                
                                                                                                
<!--l. 43--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-400003.7"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">cancel</span><span 
class="cmbx-10">_on</span><span 
class="cmbx-10">_interrupt</span> </dt><dd 
class="description">If specified, the request is monitored and will be canceled if the reserve command is
     interrupted, e.g. with CTRL-C. This option always implies <span 
class="cmsy-10">--</span>wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">description [text]</span> </dt><dd 
class="description">The text is any string used to describe the reservation. It is displayed in the Web Server.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span>  </dt><dd 
class="description">Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">memory</span><span 
class="cmbx-10">_size [integer]</span> </dt><dd 
class="description">This  specifies  the  amount  of  memory  the  reserved  machine  must  support.  After
     rounding up it must match the total usable memory on the machine. (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">scheduling</span><span 
class="cmbx-10">_class [classname]</span> </dt><dd 
class="description">This specifies the name of the scheduling class the RM will use to determine
     the resource allocation for each process. It must be one implementing the RESERVE policy. If not specified,
     the RESERVE default is taken from the site class definitions file described <a 
href="#x1-23000012.6.2">here.</a>
     </dd><dt class="description">
<span 
class="cmsy-10">-</span><span 
class="cmbx-10">f, </span><span 
class="cmsy-10">--</span><span 
class="cmbx-10">specification [file]</span> </dt><dd 
class="description">All the parameters used to request a reservation may be placed in a standard Java
     properties file. This file may then be used to submit the request (rather than providing all the parameters
     directory to submit).
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">timestamp</span>  </dt><dd 
class="description">If specified, messages from the submit process are timestamped. This is intended primarily for use
     with a monitor with &#8211;wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">wait</span><span 
class="cmbx-10">_for</span><span 
class="cmbx-10">_completion</span>  </dt><dd 
class="description">By default, the reserve command monitors the request and prints periodic state and
     progress information to the console. When the reservation completes, the monitor is terminated and the reserve
     command returns. If the command is interrupted, e.g. with CTRL-C, the request will not be canceled unless
     <span 
class="cmsy-10">--</span>cancel_on_interrupt is also specified. If this option is disabled by specifying a value of &#8220;false&#8221;, the command
     returns as soon as the request has been submitted.
     </dd></dl>
<!--l. 90--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-410003.7"></a><span 
class="cmbx-10">Notes:</span></span>
Reservations must be for full machines, in a job class implementing the RESERVE scheduling policy. The default DUCC
distribution configures class <span 
class="cmti-10">reserve </span>for full machine reservations. If there is no available machine in that class matching the
requested size (after rounding up) the request is queued. The user may cancel the request with <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_unreserve </span>or with
CTRL-C if <span 
class="cmsy-10">--</span>cancel_on_interrupt was specified.  <a name='DUCC_CLI_UNRESERVE'></a>
<h3 class="sectionHead"><span class="titlemark">3.8   </span> <a 
 id="x1-420003.8"></a>ducc_unreserve</h3>
                                                                                                
                                                                                                
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-430003.8"></a><span 
class="cmbx-10">Description:</span></span>
The unreserve CLI is used to release reserved resources.
<!--l. 30--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-440003.8"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_unreserve <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar org.apache.uima.ducc.cli.DuccReservationCancel <span 
class="cmti-10">options</span></dd></dl>
<!--l. 36--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-450003.8"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">id [jobid]</span> </dt><dd 
class="description">The ID is the id of the reservation to cancel. (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span> </dt><dd 
class="description">Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">role</span><span 
class="cmbx-10">_administrator</span> </dt><dd 
class="description">The command is being issued in the role of a DUCC administrator. If the user is not also a
     registered administrator this flag is ignored. (This helps to protect administrators from inadvertently canceling
     jobs they do not own.)</dd></dl>
<!--l. 49--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-460003.8"></a><span 
class="cmbx-10">Notes:</span></span>
None.
<!--l. 19--><p class="noindent" >2y<a name='DUCC_CLI_PROCESS_SUBMIT'></a>
<h3 class="sectionHead"><span class="titlemark">3.9   </span> <a 
 id="x1-470003.9"></a>ducc_process_submit</h3>
<!--l. 26--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-480003.9"></a><span 
class="cmbx-10">Description:</span></span>
Use <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_process</span><span 
class="cmti-10">_submit </span>to submit a Managed Reservation, also known as an <span 
class="cmti-10">arbitrary process </span>to DUCC. The intention of
this function is an alternative to utilities such as <span 
class="cmti-10">ssh</span>, in order to allow the spawned processes to be fully managed by DUCC.
This allows the DUCC scheduler to allocate the necessary resources (and prevent over-allocation), and the DUCC run-time
environment to manage process lifetime.
<!--l. 34--><p class="noindent" >If <span 
class="cmti-10">attach</span><span 
class="cmti-10">_console </span>is specified, Stdin, Stderr, and Stdout of the remote process are redirected to the submitting
console. It is thus possible to run interactive sessions with remote processes where the resources are managed by
DUCC.
                                                                                                
                                                                                                
<!--l. 38--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-490003.9"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_process_submit <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar<br 
class="newline" />org.apache.uima.ducc.cli.DuccManagedReservationSubmit <span 
class="cmti-10">options</span></dd></dl>
<!--l. 44--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-500003.9"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">attach</span><span 
class="cmbx-10">_console</span> </dt><dd 
class="description">If specified, remote process stdout and stderr are redirected to, and stdin redirected from, the
     local submitting console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">cancel</span><span 
class="cmbx-10">_on</span><span 
class="cmbx-10">_interrupt</span> </dt><dd 
class="description">If specified, the remote process is monitored and will be canceled if the submit command
     is interrupted, e.g. with CTRL-C. This option always implies <span 
class="cmsy-10">--</span>wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">description [text]</span> </dt><dd 
class="description">The text is any string used to describe the process. It is displayed in the Web Server. When
     specified on a command-line the text usually must be surrounded by quotes to protect it from the shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">environment [env vars]</span> </dt><dd 
class="description">Blank-delimited list of environment variables and variable assignments. Entries will be copied
     from the user&#8217;s environment if just the variable name is specified, optionally with a final &#8217;*&#8217; for those with the same
     prefix. If specified, this is used for all DUCC processes in the job. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-29">
     --environment&#x00A0;TERM=xterm&#x00A0;DISPLAY=:1.0&#x00A0;LANG&#x00A0;UIMA_*</div>
     <!--l. 68--><p class="nopar" >
     <!--l. 71--><p class="noindent" >Additional entries may be copied from the user&#8217;s environment based on the setting of ducc.submit.environment.propagated
     in the global DUCC configuration ducc.properties.
     <!--l. 75--><p class="noindent" >Note: When used as a CLI option, the environment string must usually be quoted to protect it from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span> </dt><dd 
class="description">Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">log</span><span 
class="cmbx-10">_directory [path-to-log directory]</span>  </dt><dd 
class="description">
     <!--l. 82--><p class="noindent" >This specifies the path to the directory for the user logs. If not specified, the default is $HOME/ducc/logs.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-30">
     --log_directory&#x00A0;/home/bob</div>
     <!--l. 86--><p class="nopar" >
     <!--l. 88--><p class="noindent" >Within this directory DUCC creates a sub-directory for each process, using the numerical ID of the job. The format of
     the generated log file names as described <a 
href="#x1-1260006">here</a>.
     <!--l. 92--><p class="noindent" >Note: Note that <span 
class="cmsy-10">--</span>log_directory specifies only the path to a directory where logs are to be stored. In order to manage
     multiple processes running in multiple machines DUCC, sub-directory and file names are generated by DUCC and may
     not be directly specified.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_executable [program name]</span> </dt><dd 
class="description">This is the full path to a program to be executed. (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_executable</span><span 
class="cmbx-10">_args [argument list]</span> </dt><dd 
class="description">This is a list of arguments for <span 
class="cmti-10">process</span><span 
class="cmti-10">_executable</span>, if any.
     When specified on a command-line the text usually must be surrounded by quotes to protect it from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_memory</span><span 
class="cmbx-10">_size [size]</span>  </dt><dd 
class="description">This specifies the maximum amount of RAM in GB to be allocated to each process. This
     value is used by the Resource Manager to allocate resources. if this amount is exceeded by a process the Agent
     terminates the process with a ShareSizeExceeded message.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">scheduling</span><span 
class="cmbx-10">_class [classname]</span>  </dt><dd 
class="description">This specifies the name of the scheduling class the RM will use to determine the
     resource allocation for each process. The names of the classes are installation dependent. If not specified, the
     FIXED_SHARE default is taken from the site class definitions file described <a 
href="#x1-23000012.6.2">here.</a>
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">specification, </span><span 
class="cmsy-10">-</span><span 
class="cmbx-10">f [file]</span>  </dt><dd 
class="description">All the parameters used to submit a process may be placed in a standard Java properties file.
     This file may then be used to submit the process (rather than providing all the parameters directory to
     submit).
     <!--l. 119--><p class="noindent" >For example,
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-31">
     ducc_process_submit&#x00A0;--specification&#x00A0;job.props
     &#x00A0;<br />ducc_process_submit&#x00A0;-f&#x00A0;job.props</div>
     <!--l. 123--><p class="nopar" >
     <!--l. 125--><p class="noindent" >where job.props contains:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-32">
     working_directory&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/home/bob/projects
     &#x00A0;<br />environment&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;AE_INIT_TIME=10000&#x00A0;LD_LIBRARY_PATH=/a/bogus/path
     &#x00A0;<br />log_directory&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/home/bob/ducc/logs/
     &#x00A0;<br />description&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;Simple&#x00A0;Process
     &#x00A0;<br />scheduling_class&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;fixed
     &#x00A0;<br />process_memory_size&#x00A0;=&#x00A0;15</div>
     <!--l. 133--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">suppress</span><span 
class="cmbx-10">_console</span><span 
class="cmbx-10">_log</span> </dt><dd 
class="description">If specified, suppress creation of the log files that normally hold the redirected stdout and
     stderr.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">timestamp</span>  </dt><dd 
class="description">If specified, messages from the submit process are timestamped. This is intended primarily for use with a
     monitor with &#8211;wait_for_completion.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">wait</span><span 
class="cmbx-10">_for</span><span 
class="cmbx-10">_completion</span>  </dt><dd 
class="description">If specified, the submit command monitors the remote process and prints periodic state and
     progress information to the console. When the process completes, the monitor is terminated and the submit
     command returns. If the command is interrupted, e.g. with CTRL-C, the request will not be canceled unless
     <span 
class="cmsy-10">--</span>cancel_on_interrupt is also specified.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">working</span><span 
class="cmbx-10">_directory</span>  </dt><dd 
class="description">This specifies the working directory to be set by the Job Driver and Job Process processes. If not
     specified, the current directory is used.
     </dd></dl>
<!--l. 153--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-510003.9"></a><span 
class="cmbx-10">Notes:</span></span>
<a name='DUCC_CLI_PROCESS_CANCEL'></a>
<h3 class="sectionHead"><span class="titlemark">3.10   </span> <a 
 id="x1-520003.10"></a>ducc_process_cancel</h3>
<!--l. 26--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-530003.10"></a><span 
class="cmbx-10">Description:</span></span>
The cancel CLI is used to cancel a process that has previously been submitted but which has not yet completed.
<!--l. 30--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-540003.10"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_process_cancel <span 
class="cmti-10">options</span>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar<br 
class="newline" />org.apache.uima.ducc.cli.DuccManagedReservationCancel <span 
class="cmti-10">options</span></dd></dl>
<!--l. 36--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-550003.10"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">id [jobid]</span> </dt><dd 
class="description">The DUCC ID is the id of the process to cancel. (Required)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span> </dt><dd 
class="description">Prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">reason [quoted string]</span> </dt><dd 
class="description">Optional. This specifies the reason the process is canceled, for display in the web server.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">role</span><span 
class="cmbx-10">_administrator</span> </dt><dd 
class="description">The command is being issued in the role of a DUCC administrator. If the user is not also a
     registered administrator this flag is ignored. (This helps to protect administrators from inadvertently canceling
     work they do not own.)</dd></dl>
<!--l. 51--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-560003.10"></a><span 
class="cmbx-10">Notes:</span></span>
None.
<!--l. 22--><p class="noindent" ><a name='DUCC_CLI_SERVICES'></a>
<h3 class="sectionHead"><span class="titlemark">3.11   </span> <a 
 id="x1-570003.11"></a>ducc_services</h3>
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-580003.11"></a><span 
class="cmbx-10">Description:</span></span>
The ducc_services CLI is used to manage service registration. It has a number of functions as listed below.
<!--l. 32--><p class="noindent" >The functions include:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Register</span> </dt><dd 
class="description">This registers a service with the Service Manager by saving a service specification in the Service Manager&#8217;s
     registration area. The specification is retained by DUCC until it is unregistered.
     <!--l. 38--><p class="noindent" >The registration consists primarily of a service specification, similar to a job specification. This specification
     is used when the Service Manager needs to start a service instance. The registered properties for a service are
     made available for viewing from the DUCC Web Server&#8217;s <a 
href="#x1-1490007.7">service details</a> page.
     </dd><dt class="description">
<span 
class="cmbx-10">Unregister</span> </dt><dd 
class="description">This unregisters a service with the Service Manager. When a service is unregistered DUCC stops the
     service instance and moves the specification to history.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Start</span> </dt><dd 
class="description">The start function instructs DUCC to allocate resources for a service and to start it in those resources. The
     service remains running until explicitly stopped. DUCC will attempt to keep the service instances running if
     they should fail. The start function is also used to increase the number of running service instances if desired.
     </dd><dt class="description">
<span 
class="cmbx-10">Stop</span> </dt><dd 
class="description">The stop function stops some or all service instances.
     </dd><dt class="description">
<span 
class="cmbx-10">Modify</span> </dt><dd 
class="description">The modify function allows most aspects of a registered service to be updated without re-registering the
     service. Where feasible the modification takes place immediately; otherwise the service must be stopped and
     restarted.
     </dd><dt class="description">
<span 
class="cmbx-10">Disable</span> </dt><dd 
class="description">This prevents additional instances of a service from being spawned. Existing instances are not affected.
     </dd><dt class="description">
<span 
class="cmbx-10">Enable</span> </dt><dd 
class="description">This reverses the effect of a manual <span 
class="cmti-10">disable </span>command or an automatic disable of the service due to excessive
     errors.
     </dd><dt class="description">
<span 
class="cmbx-10">Ignore References</span> </dt><dd 
class="description">A reference started service no longer exits after the last work referencing the service exits. It
     remains running until a manual stop is performed.
     </dd><dt class="description">
<span 
class="cmbx-10">Observe References</span> </dt><dd 
class="description">A  manually  started  service  is  made  to  behave  like  a  reference-started  service  and  will
     terminate after the last work referencing the service has exited (plus the configured linger time).
     </dd><dt class="description">
<span 
class="cmbx-10">Query</span> </dt><dd 
class="description">The query function returns detailed information about all known services, both registered and otherwise.
     </dd></dl>
<!--l. 78--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-590003.11"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Script wrapper</span> </dt><dd 
class="description">$DUCC_HOME/bin/ducc_services <span 
class="cmti-10">options</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Java Main</span> </dt><dd 
class="description">java -cp $DUCC_HOME/lib/uima-ducc-cli.jar org.apache.uima.ducc.cli.DuccServiceApi <span 
class="cmti-10">options</span></dd></dl>
The ducc_services CLI requires one of the verbs &#8220;register&#8221;, &#8220;unregister&#8221;, &#8220;start&#8221;, &#8220;stop&#8221;, &#8220;query&#8221;, or &#8220;modify&#8221;. Other
arguments are determined by the verb as described below.
<!--l. 87--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-600003.11"></a><span 
class="cmbx-10">Options:</span></span>
<!--l. 89--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.1   </span> <a 
 id="x1-610003.11.1"></a>Common Options</h4>
<!--l. 90--><p class="noindent" >These options are common to all of the service verbs:
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Prints   internal   debugging   information,   intended   for   DUCC   developers   or   extended   problem
     determination.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span> </dt><dd 
class="description">Prints the usage text to the console.</dd></dl>
<!--l. 98--><p class="noindent" ><span 
class="cmbx-12">[</span>
options]]
<h4 class="subsectionHead"><span class="titlemark">3.11.2   </span> <a 
 id="x1-620003.11.2"></a>ducc_services &#8211;register [specification file] [options]</h4>
<!--l. 100--><p class="noindent" >The <span 
class="cmti-10">register </span>function submits a service specification to DUCC. DUCC stores this information until it is <span 
class="cmti-10">unregistered</span>. Once
registered, a service may be started, stopped, etc.
<!--l. 104--><p class="noindent" >The <span 
class="cmti-10">specification file </span>is optional. If designated, it is a Java properties file containing other registration options, minus the
leading &#8220;&#8211;&#8221;. If both a specification file and command-line options are designated, the command-line options override those in
the specification.
<!--l. 109--><p class="noindent" >The options describing the service include:
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">autostart [true or false]</span> </dt><dd 
class="description">This  indicates  whether  to  register  the  service  as  an  autostarted  service.  If  not
     specified, the default is <span 
class="cmti-10">false</span>.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">classpath [path-string]</span> </dt><dd 
class="description">The CLASSPATH used for the service, if the service is a <a 
href="#x1-820005.2">UIMA-AS services</a>. If not
     specified, the CLASSPATH of the process invoking this request is used.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">debug</span>  </dt><dd 
class="description">Enable debugging messages. This is primarily for debugging DUCC itself.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">description [text]</span> </dt><dd 
class="description">The text is any quoted string used to describe the job. It is displayed in the Web Server.
     <!--l. 126--><p class="noindent" >Note: When used as a CLI option, the description string must usually be quoted to protect it from the shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">environment [env vars]</span> </dt><dd 
class="description">Blank-delimited list of environment variables and variable assignments for the service. Entries
     will be copied from the user&#8217;s environment if just the variable name is specified, optionally with a final &#8217;*&#8217; for those
     with the same prefix. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-33">
     --environment&#x00A0;TERM=xterm&#x00A0;DISPLAY=:1.0&#x00A0;LANG&#x00A0;UIMA_*
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 135--><p class="nopar" >
     <!--l. 137--><p class="noindent" >Additional entries may be copied from the user&#8217;s environment based on the setting of
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-34">
     ducc.submit.environment.propagated</div>
     <!--l. 140--><p class="nopar" > in the global DUCC configuration ducc.properties.
     <!--l. 143--><p class="noindent" >Note: When used as a CLI option, the environment string must usually be quoted to protect it from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">help</span>  </dt><dd 
class="description">This prints the usage text to the console.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instances [n]</span> </dt><dd 
class="description">This specifies the number of instances to start when the service is started. If not specified, the default is 1.
     Each instance has the DUCC_SERVICE_INSTANCE environment variable set to a unique sequence number, starting
     from 0. If an instabce is restarted it will be assigned the same number.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instance</span><span 
class="cmbx-10">_failures</span><span 
class="cmbx-10">_window [time-in-minutes]</span> </dt><dd 
class="description">This specifies the time in minutes that service instance
     failures are tracked. If there are more service instance failures within this time period than are allowed by
     <span 
class="cmsy-10">--</span><span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_limit </span>the service&#8217;s <span 
class="cmti-10">autostart </span>flag is set to <span 
class="cmti-10">false </span>and the Service Manager no longer starts instances
     for the service. The instance failures may be reset by resetting the autostart flag with the <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify </span>option, or if no
     subsequent failures occur within the window.
     <!--l. 162--><p class="noindent" >This option pertains only to failures which occur after the service is initialized.
     <!--l. 164--><p class="noindent" >This value is managed the a services ping/monitor. Thus if it is dynamnically changed with the <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify </span>option it
     takes effect immediately.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instance</span><span 
class="cmbx-10">_failures</span><span 
class="cmbx-10">_limit [number of allowable failures]</span> </dt><dd 
class="description">This specifies the maximum number of service failures
     which may occur with the time specified by <span 
class="cmsy-10">--</span><span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_window </span>before the Service Manager disables the
     service&#8217;s <span 
class="cmti-10">autostart </span>flag. The accounting of failures may be reset by resetting the autostart flag with the <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify</span>
     option or if no subsequent failures occur within the time window.
     <!--l. 174--><p class="noindent" >This option pertains only to failures which occur after the service is initialized.
     <!--l. 176--><p class="noindent" >This value is managed the a services ping/monitor. Thus if it is dynamnically changed with the <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify </span>option the
     current failure counter is reset and the new value takes effect immediately.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instance</span><span 
class="cmbx-10">_init</span><span 
class="cmbx-10">_failures</span><span 
class="cmbx-10">_limit [number of allowable failures]</span> </dt><dd 
class="description">This specifies the number of consecutive
     failures allowed while a service is in initialization state. If the maximum is reached, the service&#8217;s <span 
class="cmti-10">autostart</span>
     flag is turned off. The accounting may be reset by reeenabling <span 
class="cmti-10">autostart</span>, or if a successful initialization
     occurs.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">jvm [path-to-java]</span> </dt><dd 
class="description">This specifies the JVM to use for <a 
href="#x1-820005.2">UIMA-AS services</a>. If not specified, the same JVM used by the
     Agents is used.
     <!--l. 190--><p class="noindent" >Note: The path must be the full path the the Java executable (not simply the JAVA_HOME environment variable.).
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-35">
     --jvm&#x00A0;/share/jdk1.6/bin/java</div>
     <!--l. 194--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_jvm</span><span 
class="cmbx-10">_args [list]</span>  </dt><dd 
class="description">This specifes extra JVM arguments to be provided to the server process for <a 
href="#x1-820005.2">UIMA-AS
     services</a>. It is a blank-delimited list of strings. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-36">
     --process_jvm_args&#x00A0;-Xmx100M&#x00A0;-Xms50M</div>
     <!--l. 203--><p class="nopar" >
     <!--l. 205--><p class="noindent" >Note: When used as a CLI option, the argument string must usually be quoted to protect it from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">log</span><span 
class="cmbx-10">_directory [path-to-log directory]</span> </dt><dd 
class="description">This specifies the path to the directory for the individual service instance logs.
     If not specified, the default is $HOME/ducc/logs. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-37">
     --log_directory&#x00A0;/home/bob</div>
     <!--l. 212--><p class="nopar" >
     <!--l. 214--><p class="noindent" >Within this directory DUCC creates a subdirectory for each job, using the numerical ID of the job. The format of the
     generated log file names as described <a 
href="#x1-1260006">here</a>.
     <!--l. 218--><p class="noindent" >Note: Note that <span 
class="cmsy-10">--</span>log_directory specifies only the path to a directory where logs are to be stored. In order to manage
     multiple processes running in multiple machines DUCC, sub-directory and file names are generated by DUCC and may
     not be directly specified.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_descriptor</span><span 
class="cmbx-10">_DD [DD descriptor]</span> </dt><dd 
class="description">This specifies the UIMA Deployment Descriptor for <a 
href="#x1-820005.2">UIMA-AS
     services</a>.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_debug [host:port]</span> </dt><dd 
class="description">The specifies a debug port that a service instance connects to when it is started. If
     specified, only a single service instance is started by the Service Manager regardless of the number of instances
     specified. The service instance&#8217;s JVM options are enhanced so the service instance starts in debug mode with the
     correct call-back host and port. The host and port are used for the callback.
     <!--l. 233--><p class="noindent" >To disable debugging, user the <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify </span>service option to set the host:port to the string &#8220;off&#8221;.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_executable [program-name]</span> </dt><dd 
class="description">For <a 
href="#x1-820005.2">CUSTOM services</a>, this specifies the full path of the program to
     execute.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_executable</span><span 
class="cmbx-10">_args [list-of-arguments]</span> </dt><dd 
class="description">For <a 
href="#x1-820005.2">CUSTOM services</a>, this specifies the program arguments, if
     any.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">process</span><span 
class="cmbx-10">_memory</span><span 
class="cmbx-10">_size [size]</span> </dt><dd 
class="description">This specifies the maximum amount of RAM in GB to be allocated to each Job Process.
     This value is used by the Resource Manager to allocate resources.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">scheduling</span><span 
class="cmbx-10">_class [classname]</span> </dt><dd 
class="description">This specifies the name of the scheuling class the RM will use to determine the resource
     allocation for each process. The names of the classes are installation dependent. If not specified, the FIXED_SHARE
     default is taken from the site class definitions file described <a 
href="#x1-23000012.6.2">here.</a>
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_dependency[list]</span> </dt><dd 
class="description">This specifies a blank-delimited list of services the job processes are dependent upon. Service
     dependencies are discussed in detail <a 
href="#x1-840005.4">here</a>. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-38">
     --service_dependency&#x00A0;UIMA-AS:Service1:tcp:node682:61616&#x00A0;UIMA-AS:OtherSvc:tcp:node123:123</div>
     <!--l. 256--><p class="nopar" >
     <!--l. 258--><p class="noindent" >Note: When used as a CLI option, the list must usually be quoted to protect it from the shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_linger [milliseconds]</span> </dt><dd 
class="description">This is the time in milliseconds to wait after the last referring job or service exits before
     stopping a non-autostarted service.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_arguments [argument-string]</span> </dt><dd 
class="description">This is any arbitrary string that is passed to the <span 
class="cmti-10">init() </span>method of the
     service pinger. The contents of the string is entirely a function of the specific service. If not specified, a <span 
class="cmti-10">null </span>is passed
     in.
     <!--l. 270--><p class="noindent" >Note: When used as a CLI option, the string must usually be quoted to protect it from the shell, if it contains
     blanks.
     <!--l. 273--><p class="noindent" >The build-in default UIMA-AS pinger supports an argument string of the following form (with NO embedded
     blanks):
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-39">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_arguments=broker-jmx-port=pppp,meta-timeout=tttt</div>
     <!--l. 277--><p class="nopar" >
     <!--l. 279--><p class="noindent" >The keywords in the string have the following meaning:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">broker-jmx-port=pppp</span> </dt><dd 
class="description">This is the JMX port for the service&#8217;s broker. If not specified, the default of 1099
         is used. This is used to gather ActiveMQ statistics for the service.
         <!--l. 285--><p class="noindent" >Sometimes it is necessary to disable the gathering of ActiveMQ statistics through JMX; for example, if
         the queue is accessed via HTTP instead of TCP. To disable JMX statistics, specify the port as
         &#8220;none&#8221;.
                                                                                                
                                                                                                
         <div class="verbatim" id="verbatim-40">
         &#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_arguments=broker-jmx-port=none</div>
         <!--l. 290--><p class="nopar" >
         </dd><dt class="description">
     <span 
class="cmbx-10">meta-timeout=tttt</span> </dt><dd 
class="description">This is the time, in milliseconds, to wait for a response to UIMA-AS <span 
class="cmti-10">get-meta</span>. If not specified,
         the default is 5000 milliseconds.</dd></dl>
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_class [classname]</span> </dt><dd 
class="description">This is the Java class used to ping a service.
     <!--l. 297--><p class="noindent" >This parameter is required for CUSTOM services.
     <!--l. 299--><p class="noindent" >This parameter may be specified for UIMA-AS services; however, DUCC supplies a default pinger for UIMA-AS
     services.
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_classpath [classpath]</span> If <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_class </span>is specified, this is the classpath containing
     service_custom_ping class and dependencies. If not specified, the Agent&#8217;s classpath is used (which will generally be
     incorrect.)
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_dolog [true or false]</span> </dt><dd 
class="description">If specified, write pinger stdout and stderr messages to a log, else suppress the log.
     See <a 
href="#x1-870005.6">Service Pingers</a> for details.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_jvm</span><span 
class="cmbx-10">_args [string]</span> </dt><dd 
class="description">If <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_class </span>is specified, these are the arguments to pass to jvm when
     running the pinger. The arguments are specified as a blank-delimited list of strings. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-41">
     --service_ping_jvm_args&#x00A0;-Xmx400M&#x00A0;-Xms100M</div>
     <!--l. 318--><p class="nopar" >
     <!--l. 320--><p class="noindent" >Note: When used as a CLI option, the arguments must usually be quoted to protect them from the
     shell.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_ping</span><span 
class="cmbx-10">_timeout [time-in-ms]</span> </dt><dd 
class="description">This is the time in milliseconds to wait for a ping to the service. If the timer
     expires without a response the ping is &#8220;failed&#8221;. After a certain number of consecutive failed pings, the service is
     considered &#8220;down.&#8221; See <a 
href="#x1-870005.6">Service Pingers</a> for more details.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">service</span><span 
class="cmbx-10">_request</span><span 
class="cmbx-10">_endpoint [string]</span> </dt><dd 
class="description">This specifies the expected service id.
     <!--l. 330--><p class="noindent" >This string is optional for UIMA-AS services; if specified, however, it must be of the form <span 
class="cmtt-10">UIMA-AS:queue:broker-url</span>,
     and both the queue and broker must match those specified in the service DD specifier.
     <!--l. 335--><p class="noindent" >If the service is CUSTOM, the endpoint is required, and must be of the form <span 
class="cmtt-10">CUSTOM:string </span>where the contents of the
     string are determined by the service.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">working</span><span 
class="cmbx-10">_directory [directory-name]</span> </dt><dd 
class="description">This specifies the working directory to be set for the service processes. If not
     specified, the current directory is used.</dd></dl>
<h4 class="subsectionHead"><span class="titlemark">3.11.3   </span> <a 
 id="x1-630003.11.3"></a>ducc_services &#8211;start options</h4>
<!--l. 346--><p class="noindent" >The start function instructs DUCC to allocate resources for a service and to start it in those resources. The service remains
running until explicitly stopped. DUCC will attempt to keep the service instances running if they should fail. The start
function is also used to increase the number of running service instances if desired.
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">start [service-id or endpoint]</span> </dt><dd 
class="description">This indicates that a service is to be started. The service id is either the numeric ID
     assigned by DUCC when the service is registered, or the service endpoint string. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-42">
     ducc_services&#x00A0;--start&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--start&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 358--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instances [integer]</span> </dt><dd 
class="description">This is the number of instances to start. If omitted, sufficient instances to match the registered
     number are started. If more than the registered number of instances is running this command has no
     effect.
     <!--l. 364--><p class="noindent" >If the number of instances is specified, the number is added to the currently number of running instances. Thus if five
     instances are running and
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-43">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc_services&#x00A0;--start&#x00A0;33&#x00A0;--instances&#x00A0;5</div>
     <!--l. 368--><p class="nopar" > is issued, five more service instances are started for service 33 for a total of ten, regardless of the number specified in
     the registration.
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-44">
     ducc_services&#x00A0;--start&#x00A0;23&#x00A0;--intances&#x00A0;5
     &#x00A0;<br />ducc_services&#x00A0;--start&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345&#x00A0;--instances&#x00A0;3</div>
     <!--l. 374--><p class="nopar" >
     </dd></dl>
<!--l. 378--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.4   </span> <a 
 id="x1-640003.11.4"></a>ducc_services &#8211;stop options</h4>
<!--l. 379--><p class="noindent" >The stop function instructs DUCC to stop some number of service instances. If no specific number is specified, all instances
are stopped.
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">stop [service-id or endpoint]</span> </dt><dd 
class="description">This specifies the service to be stopped. The service id is either the numeric ID assigned
     by DUCC when the service is registered, or the service endpoint string. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-45">
     ducc_services&#x00A0;--stop&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--stop&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 390--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">instances [integer]</span> </dt><dd 
class="description">This is the number of instances to stop. If omitted, all instances for the service are stopped. If the
     number of instances is specified, then only the specified number of instances are stopped. Thus if ten instances are
     running for a service with numeric id 33 and
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-46">
     ducc_services&#x00A0;--stop&#x00A0;33&#x00A0;--instances&#x00A0;5</div>
     <!--l. 398--><p class="nopar" > is issued, five (randomly selected) service instances are stopped for service 33, leaving five running. The
     registered number of instances is never reduced to zero even if the number of running instances is reduced to
     zero.
     <!--l. 403--><p class="noindent" >Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-47">
     ducc_services&#x00A0;--stop&#x00A0;23&#x00A0;--intances&#x00A0;5
     &#x00A0;<br />ducc_services&#x00A0;--stop&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345&#x00A0;--instances&#x00A0;3</div>
     <!--l. 407--><p class="nopar" >
     </dd></dl>
<!--l. 412--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.5   </span> <a 
 id="x1-650003.11.5"></a>ducc_services &#8211;enable options</h4>
<!--l. 414--><p class="noindent" >The enable function removes the <span 
class="cmti-10">disabled </span>flag and allows a service to resume spawning new instances according to its
<a 
href="#x1-850005.5">management policy.</a>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">enable [service-id or endpoint]</span> </dt><dd 
class="description">Removes the <span 
class="cmti-10">disabled </span>status, if any. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-48">
     ducc_services&#x00A0;--enable&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--enable&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 422--><p class="nopar" >
     </dd></dl>
<!--l. 426--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.6   </span> <a 
 id="x1-660003.11.6"></a>ducc_services &#8211;disable options</h4>
<!--l. 428--><p class="noindent" >The disable function prevents the service from starting new instances. Existing instances are not affected. Use the
<span 
class="cmti-10">ducc</span><span 
class="cmti-10">_services &#8211;enable </span>command to reset.
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">disable [service-id or endpoint]</span> </dt><dd 
class="description">sets the <span 
class="cmti-10">disabled </span>status. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-49">
     ducc_services&#x00A0;--disable&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--disable&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 436--><p class="nopar" >
     </dd></dl>
<!--l. 441--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.7   </span> <a 
 id="x1-670003.11.7"></a>ducc_services &#8211;observe_references options</h4>
<!--l. 443--><p class="noindent" >If the service is not autostarted and has active instances, this instructs the Service Manager to track references
to the service, and when the last referencing service exits, stop all instances. The registered <span 
class="cmti-10">linger </span>time is
observed after the last reference exits before stopping the service. See the <a 
href="#x1-850005.5">management policy</a> section for more
information.
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">observe</span><span 
class="cmbx-10">_references [service-id or endpoint]</span> </dt><dd 
class="description">Instructs the SM to manage the service as a <span 
class="cmti-10">reference-started </span>service.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-50">
     ducc_services&#x00A0;--observe_references&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--observe_references&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 455--><p class="nopar" >
     </dd></dl>
<!--l. 459--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.8   </span> <a 
 id="x1-680003.11.8"></a>ducc_services &#8211;ignore_references options</h4>
<!--l. 461--><p class="noindent" >If the service is manually started and has active instances, this instructs the Service Manager to NOT stop the service when
the last referencing job has exited. It transforms a <span 
class="cmti-10">manually-started </span>service into a <span 
class="cmti-10">reference-started </span>service. See the
<a 
href="#x1-850005.5">management policy</a> section for more information.
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">ignore</span><span 
class="cmbx-10">_references [service-id or endpoint]</span> </dt><dd 
class="description">Instructs the SM to manage the service as a <span 
class="cmti-10">reference-started </span>service.
     Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-51">
     ducc_services&#x00A0;--igmore_references&#x00A0;23
     &#x00A0;<br />ducc_services&#x00A0;--ignore_references&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345</div>
     <!--l. 471--><p class="nopar" >
     </dd></dl>
<!--l. 476--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.9   </span> <a 
 id="x1-690003.11.9"></a>ducc_services &#8211;modify options</h4>
<!--l. 477--><p class="noindent" >The modify function dynamically updates some of the attributes of a registered service. All service options as
described under <span 
class="cmsy-10">--</span><span 
class="cmti-10">register </span>other than the <span 
class="cmti-10">service</span><span 
class="cmti-10">_endpoint </span>and <span 
class="cmti-10">process</span><span 
class="cmti-10">_descriptor</span><span 
class="cmti-10">_DD </span>may be modified wihtout
re-registering the service. In most cases the service will need to be stopped and restarted for the update to
apply.
<!--l. 482--><p class="noindent" >The modify option is of the following form:
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">modify [service-id or endpoint]</span> </dt><dd 
class="description">This identifies the service to modify. The service id is either the numeric ID assigned
     by DUCC when the service is registered, or the service endpoint string. Example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-52">
     ducc_services&#x00A0;--modify&#x00A0;23&#x00A0;--instances&#x00A0;3
     &#x00A0;<br />ducc_services&#x00A0;--modify&#x00A0;UIMA-AS:Service23:tcp://bob.com:12345&#x00A0;--intances&#x00A0;2</div>
     <!--l. 491--><p class="nopar" ></dd></dl>
<!--l. 494--><p class="noindent" >The following modifications take place immediately without the need to restart the service:
     <ul class="itemize1">
     <li class="itemize">instances
     </li>
     <li class="itemize">autostart
     </li>
     <li class="itemize">service_linger
     </li>
     <li class="itemize">process_debug
     </li>
     <li class="itemize">instance_init_failures_limit</li></ul>
<!--l. 503--><p class="noindent" >Modifying the following registration options causes the service pinger to be stopped and started, without affecting any of the
service instances themselves. The pinger is restarted even if the modification value is the same as the old value. (A good way
to restart a possibly errant pinger is to modify it&#8217;s <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_dolog </span>from &#8220;true&#8221; to &#8220;true&#8221; or from &#8220;false&#8221; to
&#8220;false&#8221;.)
     <ul class="itemize1">
     <li class="itemize">service_ping_arguments
     </li>
     <li class="itemize">service_ping_class
     </li>
     <li class="itemize">service_ping_classpath
     </li>
     <li class="itemize">service_ping_jvmargs
     </li>
     <li class="itemize">service_ping_timeout
     </li>
     <li class="itemize">service_ping_dolog</li></ul>
<!--l. 517--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">3.11.10   </span> <a 
 id="x1-700003.11.10"></a>ducc_services &#8211;query options</h4>
<!--l. 518--><p class="noindent" >The query function returns details about all known services of all types and classes, including the DUCC ids of the service
instances (for submitted and registered services), the DUCC ids of the jobs using each service, and a summary of each
service&#8217;s queue and performance statistics, when available.
<!--l. 523--><p class="noindent" >All information returned by <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_services </span><span 
class="cmsy-10">--</span><span 
class="cmti-10">query </span>is also available via the <a 
href="#x1-1480007.6">Services Page</a> of the Web Server as well as the
DUCC Service API (see the JavaDoc).
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">query [service-id or endpoint]</span> </dt><dd 
class="description">This indicates that a service is to be stopped. The service id is either the
     numeric ID assigned by DUCC when the service is registered, or the service endpoint string.
     <!--l. 532--><p class="noindent" >If no id is given, information about all services is returned.
     <!--l. 534--><p class="noindent" >Below is a sample service query.
     <!--l. 536--><p class="noindent" >The service with endpoint <span 
class="cmtt-10">UIMA-AS:FixedSleepAE</span><span 
class="cmtt-10">_5:tcp://bobmach:61617 </span>is a registered service, whose
     registered numeric id is 2. It was registered by bob for two instances and no autostart. Since it is not autostarted,
     it will be terminated when it is no longer used. It will linger for 5 seconds after the last referencing job completes,
     in case a subsequent job that uses it enters the system (not a realistic linger time!). It has two active instances
     whose DUCC Ids are 9 and 5. It is currently used (referenced) by DUCC jobs 1 and 5.
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-53">
     &#x00A0;<br />Service:&#x00A0;UIMA-AS:FixedSleepAE_5:tcp://bobmach291:61617
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Service&#x00A0;Class&#x00A0;:&#x00A0;Registered&#x00A0;as&#x00A0;ID&#x00A0;2&#x00A0;Owner[bob]&#x00A0;instances[2]&#x00A0;linger[5000]
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Implementors&#x00A0;:&#x00A0;9&#x00A0;8
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;References&#x00A0;:&#x00A0;1&#x00A0;5
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Dependencies&#x00A0;:&#x00A0;none
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Service&#x00A0;State&#x00A0;:&#x00A0;Available
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Ping&#x00A0;Active&#x00A0;:&#x00A0;true
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Autostart&#x00A0;:&#x00A0;false
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Manual&#x00A0;Stop&#x00A0;:&#x00A0;false
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;Queue&#x00A0;Statistics:
     &#x00A0;<br />Consum&#x00A0;Prod&#x00A0;Qsize&#x00A0;minNQ&#x00A0;maxNQ&#x00A0;expCnt&#x00A0;inFlgt&#x00A0;&#x00A0;DQ&#x00A0;&#x00A0;NQ&#x00A0;Disp
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;52&#x00A0;&#x00A0;&#x00A0;44&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;402&#x00A0;402&#x00A0;&#x00A0;402</div>
     <!--l. 559--><p class="nopar" ></dd></dl>
<!--l. 561--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-710003.11.10"></a><span 
class="cmbx-10">Notes:</span></span>
<a name='DUCC_VIADUCC'></a>
<h3 class="sectionHead"><span class="titlemark">3.12   </span> <a 
 id="x1-720003.12"></a>viaducc and java_viaducc</h3>
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-730003.12"></a><span 
class="cmbx-10">Description:</span></span>
Viaducc is a small script wrapper around the <a 
href="#x1-470003.9"><span 
class="cmti-10">ducc</span><span 
class="cmti-10">_process</span><span 
class="cmti-10">_submit </span></a> CLI to facilitate launching processes on DUCC-managed
machines, either from the command line or from an Eclipse run configuration.
<!--l. 33--><p class="noindent" >When run from the command line as &#8220;viaducc&#8221;, the arguments are bundled into the form expected by <a 
href="#x1-470003.9"><span 
class="cmti-10">ducc</span><span 
class="cmti-10">_process</span><span 
class="cmti-10">_submit </span></a>
and submitted to DUCC. By default the remote stdin and stdout of the deployed process are mapped back to the command
line terminal.
<!--l. 39--><p class="noindent" >If a symbolic link to the viaducc script is created with the name &#8220;java_viaducc&#8221; and used from the command line, the
arguments are assumed to be a Java classname and its arguments. The java process will be executed using DUCC&#8217;s default
JRE, or optionally, a specific JRE supplied by the user with a -D argument.
<!--l. 45--><p class="noindent" >If the &#8220;java_viaducc&#8221; symbolic link is installed in a JRE/bin directory, DUCC will use the java executable from
the same directory. More interestingly, it may be specified as an alternative to the &#8220;java&#8221; command in an
eclipse launcher. The remote stdin and stdout of the deployed DUCC process are redirected to the Eclipse
console. This provides essentially transparent execution of code in an Eclipse workspaces on DUCC-managed
resources.
<!--l. 51--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-740003.12"></a><span 
class="cmbx-10">Usage:</span></span>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-54">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;viaducc&#x00A0;[defines]&#x00A0;[command&#x00A0;and&#x00A0;parameters]"</div>
<!--l. 54--><p class="nopar" > or
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-55">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;java_viaducc&#x00A0;[defines]&#x00A0;[java-class&#x00A0;and&#x00A0;parameters]"</div>
<!--l. 58--><p class="nopar" >
<!--l. 60--><p class="noindent" >The &#8220;defines&#8221; are described below. The &#8220;command and parameters&#8221; are either any command (with full path) and it&#8217;s
arguments, or a Java class (with a &#8220;main&#8221;) and its arguments (including the classpath if necessary.)
<!--l. 64--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-750003.12"></a><span 
class="cmbx-10">Defines</span></span>
The arguments are specified in the syntax of Java &#8220;-D&#8221; system properties, to be more consistent with execution under
Eclipse.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-DDUCC</span><span 
class="cmbx-10">_MEMORY</span><span 
class="cmbx-10">_SIZE</span> </dt><dd 
class="description">This specifies the memory required, in GB. If not specified, the smallest memory
     quanta configured for the scheduler is used.
     </dd><dt class="description">
<span 
class="cmbx-10">-DDUCC</span><span 
class="cmbx-10">_CLASS</span> </dt><dd 
class="description">This is the scheduling class to submit the process to. It should generally be a non-preemptable
     class. If not specified, it defaults to class &#8220;fixed&#8221;.
     </dd><dt class="description">
<span 
class="cmbx-10">-DDUCC</span><span 
class="cmbx-10">_ENVIRONMENT</span> </dt><dd 
class="description">This species additional environment parameters to pass to the job. It should specify a
     quoted string of blank-delimited K=V environment values. For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-56">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;-DDUCC_ENVIRONMENT="DUCC_RLIMIT_NOFILE=1000&#x00A0;V1=V2&#x00A0;A=B"</div>
     <!--l. 77--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmbx-10">-DJAVA</span><span 
class="cmbx-10">_BIN</span> </dt><dd 
class="description">This species the exact &#8220;java&#8221; command to use, for &#8220;java_viaducc&#8221;. it must be a full path to some JRE
     that is known to be installed on all the DUCC nodes. If not specified, the JRE used to run ducc is
     uses.</dd></dl>
<!--l. 163--><p class="noindent" ><a name='DUCC_API'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-760004"></a>The DUCC Public API</h2>
<h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-770004.1"></a>Overview Of The DUCC API</h3>
<!--l. 21--><p class="noindent" >The DUCC API provides a simple programmatic (Java) interface to DUCC for submission and cancellation of
work. (Note that the DUCC CLI is implemented using the API and provides a model for how to use the
API.)
<!--l. 25--><p class="noindent" >All the API objects are instantiated using the same arguments as the CLI. The API provides three variants for supplying
arguments:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">An array of Java Strings, for example <span 
class="cmtt-10">DuccJobSubmit(String[] args)</span>.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">A list of Java Strings, for example <span 
class="cmtt-10">DuccJobSubmit(List&#x003C;String&#x003E; args)</span>.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">A Java Properties object, for example <span 
class="cmtt-10">DuccJobSubmit(Properties args)</span>.</dd></dl>
<!--l. 33--><p class="noindent" >After instantiation of an API object, the <span 
class="cmtt-10">boolean execute() </span>method is called. This method transmits the
arguments to DUCC. If DUCC receives and accepts the args, the method return &#8220;true&#8221;, otherwise it returns &#8220;false.
Methods are provided to retrieve relevant information when the <span 
class="cmtt-10">execute() </span>returns such as IDs, messages,
etc.
<!--l. 38--><p class="noindent" >In the case of jobs and managed reservations, if the specification requested debug, console attachment, or &#8220;wait for
completion&#8221;, the API provides methods to block waiting for completion.
<!--l. 42--><p class="noindent" >In the case of jobs and managed reservations, a callback object may also be passed to the constructor. The callback object
provides a means to direct messages to the API user. If the callback is not provided, messages are written to standard
output.
<!--l. 46--><p class="noindent" >The API is thread-safe, so developers may manage multiple, simultaneous requests to DUCC.
<!--l. 49--><p class="noindent" >Below is the &#8220;main()&#8221; method of DuccJobSubmit, demonstrating the use of the API:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-57">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;static&#x00A0;void&#x00A0;main(String[]&#x00A0;args)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;try&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DuccJobSubmit&#x00A0;ds&#x00A0;=&#x00A0;new&#x00A0;DuccJobSubmit(args,&#x00A0;null);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;boolean&#x00A0;rc&#x00A0;=&#x00A0;ds.execute();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;If&#x00A0;the&#x00A0;return&#x00A0;is&#x00A0;&#8217;true&#8217;&#x00A0;then&#x00A0;as&#x00A0;best&#x00A0;the&#x00A0;API&#x00A0;can&#x00A0;tell,&#x00A0;the&#x00A0;submit&#x00A0;worked
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if&#x00A0;(&#x00A0;rc&#x00A0;)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.out.println("Job&#x00A0;"&#x00A0;+&#x00A0;ds.getDuccId()&#x00A0;+&#x00A0;"&#x00A0;submitted");
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;int&#x00A0;exit_code&#x00A0;=&#x00A0;ds.getReturnCode();&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;after&#x00A0;waiting&#x00A0;if&#x00A0;requested
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.exit(exit_code);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}&#x00A0;else&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.out.println("Could&#x00A0;not&#x00A0;submit&#x00A0;job");
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.exit(1);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;catch(Exception&#x00A0;e)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.out.println("Cannot&#x00A0;initialize:&#x00A0;"&#x00A0;+&#x00A0;e);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;System.exit(1);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}</div>
<!--l. 70--><p class="nopar" >
<!--l. 72--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-780004.2"></a>Compiling and Running With the DUCC API</h3>
<!--l. 74--><p class="noindent" >A single DUCC jar file is required for both compilation and execution of the DUCC API, <span 
class="cmtt-10">uima-ducc-cli.jar</span>. This jar is
found in $DUCC_HOME/lib.
<!--l. 77--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-790004.3"></a>Java API</h3>
<!--l. 81--><p class="noindent" >See the <a 
href="api/index.html" >JavaDoc</a> for the DUCC Public API.
<!--l. 173--><p class="noindent" ><a name='DUCC_SERVICES'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-800005"></a>Service Management</h2>
<h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-810005.1"></a>Overview.</h3>
<!--l. 21--><p class="noindent" >A DUCC service is defined by the following two criteria:
     <ul class="itemize1">
     <li class="itemize">A service is one or more long-running processes that await requests and return something in response.
     </li>
     <li class="itemize">A service that is managed by DUCC is accompanied by a small program called a &#8220;pinger&#8221; that the DUCC
     Service Manager uses to gauge the availability and health of the service. This pinger must always be be present.
     DUCC will supply a default pinger for UIMA-AS services if none is specified.
     <!--l. 30--><p class="noindent" >Users may supply their own &#8220;pingers&#8221; by supplying a Java class that implements the pinger API. This is
     referred to as a &#8220;custom&#8221; pinger in this document. There are a number of service registration options which
     allow specification and parametrization of custom pingers.
     </li></ul>
<!--l. 36--><p class="noindent" >The pinger API enables the following functions for custom pingers:
     <ul class="itemize1">
     <li class="itemize">increase and decrease the number of service instances,
     </li>
     <li class="itemize">manage failure restart policies,
     </li>
     <li class="itemize">enable and disable service autostart,
     </li>
     <li class="itemize">notify the Service Manager of the date of last use of a service,
     </li>
     <li class="itemize">notify the Service Manager of the health and availability of a service,
     </li>
     <li class="itemize">returns a string for display in the DUCC Web server to show relevant service information</li></ul>
<!--l. 47--><p class="noindent" >A service is usually a UIMA-AS service, but DUCC supports any arbitrary process as a service.
<!--l. 49--><p class="noindent" >The DUCC Service Manager implements several high-level functions:
     <ul class="itemize1">
     <li class="itemize">Ensure services are available for jobs before allowing the jobs to start.
     </li>
     <li class="itemize">Enable fast-fail for jobs which reference services which are unavailable.
     </li>
     <li class="itemize">Start a service when it is referenced by a job, and stop it when no longer needed.
     </li>
     <li class="itemize">Optionally start a service when DUCC is booted.
     </li>
     <li class="itemize">Insure services remain operational across failures.
     </li>
     <li class="itemize">Report service failures.
                                                                                                
                                                                                                
     </li>
     <li class="itemize">Run service pingers and respond to the pinger API as needed.</li></ul>
<!--l. 61--><p class="noindent" >When work enters the system with a declared dependency on a service, one of the following actions is taken:
     <ul class="itemize1">
     <li class="itemize">If the service is not registered, the work request is automatically canceled (to avoid wasting resources on a job
     that is known cannot succeed.)
     </li>
     <li class="itemize">If the service registered but not running, the Service Manager attempts to start it; the job remains queued
     until the service is started and its pinger reports good health.
     </li>
     <li class="itemize">If the service exists but cannot be started, the remains queued and error status is shown in the web server. Once
     the service is working again the work is allowed to proceed. (Jobs already running are not directly affected,
     unless they also cannot access the service.)
     </li>
     <li class="itemize">If the service processes are running but the pinger reports failure contacting the service, the work remains
     queued with error status shown in the webserver. Once the service pinger indicates the service is functional
     again the work is allowed to proceed.</li></ul>
<!--l. 77--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-820005.2"></a>Service Types.</h3>
<!--l. 79--><p class="noindent" >DUCC supports two types of services: UIMA-AS and CUSTOM:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">UIMA-AS</span> </dt><dd 
class="description">This is a normal UIMA-AS service. DUCC fully supports all aspects of UIMA-AS services with minimal
     effort from developers. A default pinger is supplied by DUCC for UIMA-AS services. It is legal to define a
     custom pinger for a UIMA-AS service.
     </dd><dt class="description">
<span 
class="cmbx-10">CUSTOM</span> </dt><dd 
class="description">This is any arbitrary service. Developers must provide a custom pinger and declare the pinger in the
     service registration.</dd></dl>
<!--l. 90--><p class="noindent" >DUCC also supports services that are not managed by DUCC. These are known as <span 
class="cmti-10">ping-only </span>services. The registration for a
ping-only service contains only keywords needed to support a pinger, which communicates with the non-DUCC
service. Ping-only services must be defined as custom services; there is no default pinger provided for ping-only
services.
<!--l. 95--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-830005.3"></a>Service Instance IDs</h3>
<!--l. 97--><p class="noindent" >DUCC 2.0.0 introduces support for constant service instance IDs. As a service is being started, the SM assigns
monotonically increasing IDs to each service instance, starting with ID 0, up the the maximum number of instances
started.
<!--l. 101--><p class="noindent" >If an instance exits unexpectedly, the SM re-spawns it (unless a failure threshold has been exceeded). The new instance is
assigned the same instance ID as the instance it replaces. This insures that, for example, instance &#8220;three&#8221; is always started as
instance &#8220;three&#8221;, maintained constant over failures and SM restarts.
                                                                                                
                                                                                                
<!--l. 106--><p class="noindent" >The instance ID is communicated to the process through the environment with the key <span 
class="cmtt-10">DUCC</span><span 
class="cmtt-10">_SERVICE</span><span 
class="cmtt-10">_INSTANCE</span>. This key
may also be used in service registrations if it is desired to pass the instance ID via parameters of some sort. For
example:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-58">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_jvm_args&#x00A0;&#x00A0;&#x00A0;-DSERVICE_ID=${DUCC_SERVICE_INSTANCE}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;process_executable_args&#x00A0;-i&#x00A0;${DUCC_SERVICE_INSTANCE}</div>
<!--l. 112--><p class="nopar" >
<!--l. 114--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-840005.4"></a>Service References and Endpoints</h3>
<!--l. 116--><p class="noindent" >Services are identified by an entity called a <span 
class="cmti-10">service endpoint</span>. Jobs and other services use the registered service endpoint to
indicate dependencies on specific services.
<!--l. 120--><p class="noindent" >A service endpoint is of the form
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-59">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;service-type&#x003E;:&#x003C;unique&#x00A0;id&#x003E;</div>
<!--l. 123--><p class="nopar" >
<!--l. 125--><p class="noindent" >The <span 
class="cmti-10">service-type </span>must be either UIMA-AS or CUSTOM.
<!--l. 127--><p class="noindent" >The <span 
class="cmti-10">unique id </span>is any string needed to ensure the service is uniquely named. For UIMA-AS services, the unique ID must be
the same as the service endpoint specified in service&#8217;s DD XML descriptor. The UIMA-AS service endpoint is always of the
form:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-60">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;queue-name:broker-url</div>
<!--l. 133--><p class="nopar" > where <span 
class="cmti-10">queue-name </span>is the name of the ActiveMQ queue used by the service, and <span 
class="cmti-10">broker-url </span>is the ActiveMQ broker URL.
Sample DUCC Service endpoints:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-61">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UIMA-AS:WikipediaSearchServices:tcp://broker1:61616
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;UIMA-AS:GoogleSearchServices:http://broker2:61618</div>
<!--l. 139--><p class="nopar" >
<!--l. 141--><p class="noindent" >Jobs or other services may register dependencies on specific services by listing one or more service endpoints int their
specifications. See the <a 
href="#x1-270003.5"><span 
class="cmti-10">job </span></a> and <a 
href="#x1-570003.11"><span 
class="cmti-10">services </span></a> CLI descriptions for details.
<!--l. 146--><p class="noindent" >A service is registered with DUCC using the <a 
href="#x1-570003.11">ducc_services</a> API/CLI. Service registrations are persisted by DUCC and last
over DUCC and cluster restarts.
<!--l. 149--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-850005.5"></a>Service Management Policies</h3>
<!--l. 152--><p class="noindent" >The Service Manager implements these policies for managing services:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Autostarted Services</span> </dt><dd 
class="description">An autostarted service is automatically started when the DUCC system is first booted. If
     an instance should die, DUCC automatically restarts the instance and continually maintains the registered
     number of service instances.
     <!--l. 159--><p class="noindent" >By default, to handle fatal errors in <span 
class="cmti-10">autostarted </span>services, The Service Manager maintains a time window in
     which only a specific number of instance failures may occur. If the number of failures within that window of
     time is excessive DUCC will set a <span 
class="cmti-10">disabled </span>flag and no longer restart instances. Instance which do not fail are
     left running. The <span 
class="cmti-10">disabled </span>flag must be manually reset once the problem is resolved before new instances can
     be started.
     <!--l. 166--><p class="noindent" >The default failure policy is implemented in the service pinger.. Service owners may redefine the default policy
     by supplying their own pingers for a service.
     </dd><dt class="description">
<span 
class="cmbx-10">Reference-started Services</span> </dt><dd 
class="description">A reference-started service is a registered service that is started only when referenced
     by another job or service. If the service is already started, the dependent job/service is marked &#8220;Services
     Available&#8221; and can be scheduled.. If not, the service registry is checked and if a matching enabled service is
     found, it is started by DUCC. While the service is being started, jobs are held &#8220;Waiting For Services&#8221; to ensure
     the service is viable. Once the service has completed initialization and the pinger indicates it is viable, all work
     waiting on it is then marked &#8220;Services Available&#8221; and started.
     <!--l. 178--><p class="noindent" >To handle fatal errors in <span 
class="cmti-10">reference-started </span>services, The Service Manager maintains a time window in which
     only a specific number of instance failures may occur. If the number of failures within that window of time
     is excessive DUCC will set a <span 
class="cmti-10">disabled </span>flag and no longer restart instances. Instance which do not fail are left
     running. The <span 
class="cmti-10">disabled </span>flag must be manually reset once the problem is resolved before new instances can be
     started. This default policy may be overridden by custom pingers.
     <!--l. 185--><p class="noindent" >When the last job or service that references the on-demand service exits, a timer is established to keep the
     service alive for a while, in anticipation that it will be needed again soon. When the keep-alive timer expires,
     and there are no more dependent jobs or services, the reference-started service is automatically stopped to free
     up its resources for other work. The time the service is allowed to remain alive is known as its <span 
class="cmti-10">linger </span>time and
     can be controlled with the <span 
class="cmti-10">service</span><span 
class="cmti-10">_linger </span>keyword in the service registration.
     </dd><dt class="description">
<span 
class="cmbx-10">Manually started services</span> </dt><dd 
class="description">A service may be started via the CLI if it is not already running and in the absence
     of references by other work. A service which is manually stared by the CLI can only be stopped manually by
     the CLI.
                                                                                                
                                                                                                
     <!--l. 197--><p class="noindent" >As is the case for <span 
class="cmti-10">autostarted </span>and <span 
class="cmti-10">reference-started </span>services, failed instances will be restarted unless the number
     of failures within the failure window is exceeded and the <span 
class="cmti-10">disable </span>flag is set.
     </dd><dt class="description">
<span 
class="cmbx-10">Ping-Only Services</span> </dt><dd 
class="description"><a 
 id="likesection.2"></a> Ping-only services consist of only a ping thread. The service itself is not managed in any way
     by DUCC. This is useful for managing dependencies on services that are not under DUCC control: the pinger
     is used to assess the viability of the external service and prevent dependent jobs from continuing if the service
     is unavailable.
     <!--l. 209--><p class="noindent" >Only CUSTOM services may be defined as ping-only services in this version of DUCC.
     </dd></dl>
<!--l. 213--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-860005.5"></a><span 
class="cmbx-10">Dynamically Changing Service Policies</span></span>
A service may be <span 
class="cmti-10">stopped</span>; that is, no instances are running. This state can occur if the service has experienced too many
errors within its failure window, in which case the service is <span 
class="cmti-10">disabled</span>, or because the service is not <span 
class="cmti-10">autostarted </span>or <span 
class="cmti-10">referenced </span>by
other work.
<!--l. 219--><p class="noindent" >If a manual <span 
class="cmti-10">stop </span>is issued the service will be automatically <span 
class="cmti-10">disabled </span>to insure it cannot be restarted (by <span 
class="cmti-10">reference </span>or at boot
with <span 
class="cmti-10">autostart</span>) without manual intervention.
<!--l. 223--><p class="noindent" >In all cases, if a service is <span 
class="cmti-10">disabled</span>, it must be manually <span 
class="cmti-10">enabled </span>using the CLI.
<!--l. 225--><p class="noindent" >It is possible, via the CLI, to dynamically switch any service from any management policy to any other policy, as shown in
the following table.
<!--l. 228--><p class="noindent" >See the <a 
href="#x1-570003.11"><span 
class="cmti-10">Service CLI </span></a> reference for details on the various commands described in this section.
<div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2"></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3"></colgroup><colgroup id="TBL-2-4g"><col 
id="TBL-2-4"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-1"  
class="td11">Current Mode</td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-1-2"  
class="td11">Desired Mode</td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-3"  
class="td11"><!--l. 233--><p class="noindent" >Action                                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-4"  
class="td11"><!--l. 233--><p class="noindent" >Notes                                            </td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-1"  
class="td11">Autostart </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-2-2"  
class="td11">Manual </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-3"  
class="td11"><!--l. 236--><p class="noindent" >Use CLI to modify registration to
<span 
class="cmti-10">autstart false</span>.                                 </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-4"  
class="td11"><!--l. 236--><p class="noindent" >Service does not stop until requested by
CLI.  Service  will  not  start  at  DUCC
boot.                                            </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-1"  
class="td11">Autostart       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-3-2"  
class="td11">Reference      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-3"  
class="td11"><!--l. 238--><p class="noindent" >Use  CLI  to  modify  registration  to
<span 
class="cmti-10">autostart false </span>and <span 
class="cmti-10">observe references</span>.  </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-4"  
class="td11"><!--l. 238--><p class="noindent" >Service stops after last reference exits,
plus <span 
class="cmti-10">linger </span>time.                              </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-1"  
class="td11">Autostart       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-4-2"  
class="td11"><span 
class="cmti-10">Stopped        </span></td><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-3"  
class="td11"><!--l. 240--><p class="noindent" >Use CLI to stop the service.              </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-4"  
class="td11"><!--l. 240--><p class="noindent" >The CLI stop will by necessity <span 
class="cmti-10">disable</span>
the service to insure it remains stopped.</td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-1"  
class="td11">Reference       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-5-2"  
class="td11">Autostart     </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-3"  
class="td11"><!--l. 242--><p class="noindent" >Use  CLI  to  modify  registration  to
<span 
class="cmti-10">autostart true</span>.                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-4"  
class="td11"><!--l. 242--><p class="noindent" >Service  continues  to  run  after  last
reference exits. Service always started
at DUCC boot.                               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-1"  
class="td11">Reference       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-6-2"  
class="td11">Manual        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-3"  
class="td11"><!--l. 244--><p class="noindent" >Use CLI to <span 
class="cmti-10">ignore references</span>.             </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-4"  
class="td11"><!--l. 244--><p class="noindent" >Service  continues  to  run  after  last
reference exits.                                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-1"  
class="td11">Reference       </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-7-2"  
class="td11"><span 
class="cmti-10">Stopped        </span></td><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-3"  
class="td11"><!--l. 246--><p class="noindent" >Use CLI to stop the service.              </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-4"  
class="td11"><!--l. 246--><p class="noindent" >The CLI stop will by necessity <span 
class="cmti-10">disable</span>
the service to insure it remains stopped.</td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-1"  
class="td11">Manual          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-8-2"  
class="td11">Autostart     </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-3"  
class="td11"><!--l. 248--><p class="noindent" >Use  CLI  to  modify  registraiton  to
<span 
class="cmti-10">autostart true</span>.                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-4"  
class="td11"><!--l. 248--><p class="noindent" >Service will be started on DUCC boots.</td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-1"  
class="td11">Manual          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-9-2"  
class="td11">Reference      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-3"  
class="td11"><!--l. 250--><p class="noindent" >Use CLI to <span 
class="cmti-10">observe references</span>.           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-4"  
class="td11"><!--l. 250--><p class="noindent" >Service will stop after last referencing
job exits, plus <span 
class="cmti-10">linger </span>time..                </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-1"  
class="td11">Manual          </td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-10-2"  
class="td11"><span 
class="cmti-10">Stopped        </span></td><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-3"  
class="td11"><!--l. 252--><p class="noindent" >Use CLI to stop the service.              </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-4"  
class="td11"><!--l. 252--><p class="noindent" >The CLI stop will by necessity <span 
class="cmti-10">disable</span>
the service to insure it remains stopped.</td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-1"  
class="td11"><span 
class="cmti-10">Stopped         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-11-2"  
class="td11">Autostart     </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-3"  
class="td11"><!--l. 254--><p class="noindent" >Use  CLI  to  modify  registration  to
<span 
class="cmti-10">autostart true</span>.                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-4"  
class="td11"><!--l. 254--><p class="noindent" >Service will start immediately. It may
be  necessary  to  <span 
class="cmti-10">enable </span>the  service  as
well.                                             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-1"  
class="td11"><span 
class="cmti-10">Stopped         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-12-2"  
class="td11">Reference      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-3"  
class="td11"><!--l. 256--><p class="noindent" >Submit a job or service that references
the service.                                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-4"  
class="td11"><!--l. 256--><p class="noindent" >It  may  be  necessary  to  <span 
class="cmti-10">enable  </span>the
service  as  well.  The  service  will  stop
after  the  last  referencing  work  exits,
plus <span 
class="cmti-10">linger</span>.                                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-1"  
class="td11"><span 
class="cmti-10">Stopped         </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-2-13-2"  
class="td11">Manual        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-3"  
class="td11"><!--l. 259--><p class="noindent" >Use CLI to start the service.              </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-4"  
class="td11"><!--l. 259--><p class="noindent" >The  CLI  start  will  also  <span 
class="cmti-10">enable  </span>the
service if necessary.                          </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-2-14-1"  
class="td11">            </td>
</tr></table></div>
                                                                                                
                                                                                                
<!--l. 263--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.6   </span> <a 
 id="x1-870005.6"></a>Service Pingers</h3>
<!--l. 265--><p class="noindent" >A service pinger is a small program that queries a service on behalf of the DUCC Service Manager. A default pinger is
provided for UIMA-AS services and provides the following functions:
     <ul class="itemize1">
     <li class="itemize">Determine if the service is responsive by issuing a UIMA-AS &#8220;get-meta&#8221; call to the service.
     </li>
     <li class="itemize">Determine the health of the service by issuing a JMX call to the UIMA-AS broker to collect queueing statistics.
     </li>
     <li class="itemize">Manage the failure window of the service.
     </li>
     <li class="itemize">Returns a string with basic ActiveMQ statistics about the service, or error information if the service is deemed
     unusable.
     </li>
     <li class="itemize">Returns date of last use of the service (as determined by presence or absence of service producers attached to
     the service queue).</li></ul>
<!--l. 280--><p class="noindent" >Users may supply their own pingers. The following additional functions are available for pingers. Note that a <span 
class="cmti-10">custom </span>pinger
MAY be supplied for UIMA-AS services, and MUST be supplied for CUSTOM services. Custom pingers use the Service
Manager&#8217;s &#8220;pinger&#8221; API to perform the following tasks:
     <ul class="itemize1">
     <li class="itemize">Inform the Service Manager if the service is viable.
     </li>
     <li class="itemize">Inform the Service Manager if the service is &#8220;healthy&#8221;. Service &#8220;health&#8221; is a heuristic used in the DUCC Web
     server as an alert that a service is responding but may not be performing well.
     </li>
     <li class="itemize">Manage service failure policies. Default failure-window policy is provided to all pingers by the DUCC API
     handler (optional).
     </li>
     <li class="itemize">Return a string describing current service status, for use by the web server.
     </li>
     <li class="itemize">Instruct the service manager to increase the number of instances (optional).
     </li>
     <li class="itemize">Instruct the service manager to decrease the number of instances (optional).
     </li>
     <li class="itemize">Enable and disable the services autostart flag (optional).
     </li>
     <li class="itemize">Enable logging of a service&#8217;s health and state (optional).
     </li>
     <li class="itemize">Return date of last-use to the Service Manager for display in the webserver (optional).</li></ul>
<!--l. 302--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.6.1   </span> <a 
 id="x1-880005.6.1"></a>The Pinger API</h4>
<!--l. 304--><p class="noindent" >Pingers are passed static information about the service at pinger-initialization time, and subsequently, current state of the
service is provided on each call (ping).
                                                                                                
                                                                                                
<!--l. 307--><p class="noindent" >Information provided at initialization follows. Most of this is provided in fields in the <span 
class="cmti-10">AServicePing </span>base class. See the
Javadoc for specific field names and types.
<!--l. 311--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-890005.6.1"></a>Pinger Initialization Data</h5>
<!--l. 312--><p class="noindent" >Data provided once, during pinger initialization, includes:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Arguments</span> </dt><dd 
class="description">This is the <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_arguments </span>string from the service registration.
     </dd><dt class="description">
<span 
class="cmbx-10">Endpoint</span> </dt><dd 
class="description">This is the CUSTOM:string or UIMA-AS:string endpoint provided in the service registration.
     </dd><dt class="description">
<span 
class="cmbx-10">Monitor Rate</span> </dt><dd 
class="description">This is the rate at which the pinger will be called by the SM, as provided in DUCC&#8217;s configuration.
     </dd><dt class="description">
<span 
class="cmbx-10">Service ID</span> </dt><dd 
class="description">This is the <a 
href="#x1-830005.3">unique numeric service ID</a> assigned to the service by DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">Log Enabled</span> </dt><dd 
class="description">Whether the service log is enabled, as specified by the <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_dolog </span>registration parameter.
     </dd><dt class="description">
<span 
class="cmbx-10">Maximum Allowed Failures</span> </dt><dd 
class="description">This  is  the  value  of  the  <span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_limit  </span>parameter,  provided  by  DUCC
     configuration and optionally overridden by the service registration.
     </dd><dt class="description">
<span 
class="cmbx-10">Instance Failure Window</span> </dt><dd 
class="description">This  is  the  value  of  the  <span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_window  </span>parameter,  provided  by  DUCC
     configuration and optionally overridden by the service registration.
     </dd><dt class="description">
<span 
class="cmbx-10">Autostart Enabled</span> </dt><dd 
class="description">This indicates whether the service registration currently has the <span 
class="cmti-10">autostart </span>flag enabled.
     </dd><dt class="description">
<span 
class="cmbx-10">Last Use</span> </dt><dd 
class="description">This is the time of last known use of the service, persisted and maintained over SM restarts. It is 0 if
     unknown or the service has never been used.</dd></dl>
<!--l. 337--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-900005.6.1"></a>Pinger Dynamic Data</h5>
<!--l. 339--><p class="noindent" >Dynamic information provided to the pinger in each call (ping) consists of:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">All Instance Information</span> </dt><dd 
class="description">This  is  an  array  consisting  of  the  unique  integer  IDS  of  all  running  processes
     implementing the service. This includes instances which may not be currently viable for some reason (still
     initializing, for example).
     </dd><dt class="description">
<span 
class="cmbx-10">Active Instance Information</span> </dt><dd 
class="description">This  is  an  array  consisting  of  the  unique  integer  IDS  of  all  running  processes
     implementing the service. This is a subset of &#8220;All Instance Information&#8221; and includes only the service instances
     that are advanced to Running state.
     </dd><dt class="description">
<span 
class="cmbx-10">Reference Information</span> </dt><dd 
class="description">This is an array consisting of the unique integer IDS of all DUCC work (Jobs, other
     Services, etc) currently referencing the service.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Autostart Enabled</span> </dt><dd 
class="description">The current state of the service&#8217;s autostart flag.
     </dd><dt class="description">
<span 
class="cmbx-10">Run Failures</span> </dt><dd 
class="description">This is the total number of instance failures for the service since the last start of the SM.</dd></dl>
<!--l. 360--><p class="noindent" >Only a Java API is supported.
<!--l. 362--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.6.2   </span> <a 
 id="x1-910005.6.2"></a>Declaring a Pinger in A Service</h4>
<!--l. 364--><p class="noindent" >The following registration options are used for declaring and configuring pingers. Any of these may be dynamically modified
with the service CLI&#8217;s <span 
class="cmsy-10">--</span><span 
class="cmti-10">modify </span>option. Dynamically changing these causes the current pinger to be terminated and
restarted with the new configuration. See <a 
href="#x1-570003.11">ducc_services</a> for details of the options:
     <ul class="itemize1">
     <li class="itemize">service_ping_arguments
     </li>
     <li class="itemize">service_ping_class
     </li>
     <li class="itemize">service_ping_classpath
     </li>
     <li class="itemize">service_ping_jvmargs
     </li>
     <li class="itemize">service_ping_timeout
     </li>
     <li class="itemize">service_ping_dolog
     </li>
     <li class="itemize">instance_failures_window
     </li>
     <li class="itemize">instance_failures_limit</li></ul>
<!--l. 380--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.6.3   </span> <a 
 id="x1-920005.6.3"></a>Implementing a Pinger</h4>
<!--l. 381--><p class="noindent" >Pingers must implement the class <span 
class="cmtt-10">org.apache.uima.ducc.cli.AServicePing</span>. See the Javadoc for the details of this
class.
<!--l. 384--><p class="noindent" >Below is a sample CUSTOM pinger for a hypothetical service that returns four integers in response to a ping. It illustrates
simple use of the three required methods, <span 
class="cmti-10">init()</span>, <span 
class="cmti-10">stop()</span>, and <span 
class="cmti-10">getStatistics()</span>.
<!--l. 388--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-92001r1"></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-62">
import&#x00A0;java.io.DataInputStream;
&#x00A0;<br />import&#x00A0;java.io.InputStream;
&#x00A0;<br />import&#x00A0;java.net.Socket;
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.cli.AServicePing;
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.cli.ServiceStatistics;
&#x00A0;<br />
&#x00A0;<br />public&#x00A0;class&#x00A0;CustomPing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;extends&#x00A0;AServicePing
&#x00A0;<br />{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;host;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;port;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;init(String&#x00A0;args,&#x00A0;String&#x00A0;endpoint)&#x00A0;throws&#x00A0;Exception&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;Parse&#x00A0;the&#x00A0;service&#x00A0;endpoint,&#x00A0;which&#x00A0;is&#x00A0;a&#x00A0;String&#x00A0;of&#x00A0;the&#x00A0;form
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;&#x00A0;&#x00A0;&#x00A0;host:port
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;String[]&#x00A0;parts&#x00A0;=&#x00A0;endpoint.split(":");
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;host&#x00A0;=&#x00A0;parts[1];
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;port&#x00A0;=&#x00A0;parts[2];
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;stop()&#x00A0;&#x00A0;{&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;private&#x00A0;long&#x00A0;readLong(DataInputStream&#x00A0;dis)&#x00A0;throws&#x00A0;Exception&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;Long.reverseBytes(dis.readLong());
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;ServiceStatistics&#x00A0;getStatistics()&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;Contact&#x00A0;the&#x00A0;service,&#x00A0;interpret&#x00A0;the&#x00A0;results,&#x00A0;and&#x00A0;return&#x00A0;a&#x00A0;state
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//&#x00A0;object&#x00A0;for&#x00A0;the&#x00A0;service.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ServiceStatistics&#x00A0;stats&#x00A0;=&#x00A0;new&#x00A0;ServiceStatistics(false,&#x00A0;false,"&#x003C;NA&#x003E;");
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;try&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Socket&#x00A0;sock&#x00A0;=&#x00A0;new&#x00A0;Socket(host,&#x00A0;Integer.parseInt(port));
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DataInputStream&#x00A0;dis&#x00A0;=&#x00A0;new&#x00A0;DataInputStream(sock.getInputStream());
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;long&#x00A0;stat1&#x00A0;=&#x00A0;readLong(dis);&#x00A0;long&#x00A0;stat2&#x00A0;=&#x00A0;readLong(dis);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;long&#x00A0;stat3&#x00A0;=&#x00A0;readLong(dis);&#x00A0;long&#x00A0;stat4&#x00A0;=&#x00A0;readLong(dis);
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stats.setAlive(true);&#x00A0;&#x00A0;stats.setHealthy(true);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stats.setInfo(&#x00A0;&#x00A0;"S1["&#x00A0;+&#x00A0;stat1&#x00A0;+&#x00A0;"]&#x00A0;S2["&#x00A0;+&#x00A0;stat2&#x00A0;+
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;"]&#x00A0;S3["&#x00A0;+&#x00A0;stat3&#x00A0;+&#x00A0;"]&#x00A0;S4["&#x00A0;+&#x00A0;stat4&#x00A0;+&#x00A0;"]"&#x00A0;);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}&#x00A0;catch&#x00A0;(&#x00A0;Throwable&#x00A0;t)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;t.printStackTrace();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;stats.setInfo(t.getMessage());
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;stats;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />}</div>
<!--l. 436--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;5.1: </span><span  
class="content">Sample UIMA-AS Service Pinger</span></div><!--tex4ht:label?: x1-92001r1 -->
                                                                                                
                                                                                                
<!--l. 440--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">5.6.4   </span> <a 
 id="x1-930005.6.4"></a>Building And Testing Your Pinger</h4>
<!--l. 443--><p class="noindent" >This section provides the information needed to use the pinger API and build a custom pinger.
<!--l. 446--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-940005.6.4"></a><span 
class="cmbx-10">1. Establish a compilation CLASSPATH</span></span>
One DUCC jar is required in the CLASSPATH to build your pinger:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-63">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC_HOME/lib/uima-ducc-cli.jar</div>
<!--l. 449--><p class="nopar" > This provides the definition for the <span 
class="cmti-10">AServicePing </span>and <span 
class="cmti-10">ServiceStatistics </span>classes.
<!--l. 452--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-950005.6.4"></a><span 
class="cmbx-10">2. Create a registration</span></span>
Next, create a service registration for the pinger. While debugging, it is useful set the directive
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-64">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_dolog&#x00A0;=&#x00A0;true</div>
<!--l. 456--><p class="nopar" > This will log any output from <span 
class="cmtt-10">System.out.println() </span>to the declared log directory for the service. If not specified in the
reqistration, this directory is:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-65">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$HOME/ducc/logs/S-&#x003C;serviceid&#x003E;/services</div>
<!--l. 461--><p class="nopar" > where <span 
class="cmmi-10">&#x003C;</span><span 
class="cmtt-10">servicid</span><span 
class="cmmi-10">&#x003E; </span>is the DUCC-assigned ID of your service.
<!--l. 464--><p class="noindent" >Once the pinger is debugged you may want to turn logging off.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-66">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_dolog&#x00A0;=&#x00A0;false</div>
<!--l. 467--><p class="nopar" >
<!--l. 469--><p class="noindent" >A sample service registration may look something like the following. Note that you do not need to include any of the
DUCC jars in the classpath for the pinger. DUCC will add the jars it requires to interact with the pinger
automatically. (However you may need other jars to provide UIMA, UIMA-AS, ActiveMQ, Spring, or other
function.)
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-67">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bash-3.2$&#x00A0;cat&#x00A0;myping.svc
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;description&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;Ping-only&#x00A0;service
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_request_endpoint&#x00A0;=&#x00A0;CUSTOM:localhost:7175
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_class&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;CustomPing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_classpath&#x00A0;&#x00A0;&#x00A0;=&#x00A0;/myhome/CustomPing.class
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_dolog&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;true
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_timeout&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;500
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_aruments&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;Arg1&#x00A0;Arg2
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_jvm_args&#x00A0;&#x00A0;&#x00A0;=&#x00A0;-DXmx50M</div>
<!--l. 484--><p class="nopar" >
<!--l. 486--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-960005.6.4"></a><span 
class="cmbx-10">3. Register and start the service and pinger</span></span>
Start up your custom service so the pinger with the registration containing lines similar to those above. As soon as the
service instance is in DUCC state <span 
class="cmti-10">Running </span>the SM starts the pinger.
<!--l. 491--><p class="noindent" >Check the web server to make sure the service &#8220;comes alive&#8221;. Check your pinger&#8217;s debugging log if it doesn&#8217;t. Once registered,
you can dynamically modify and restart the pinger at any time without re-registering the service or restarting the service by
use of the <span 
class="cmsy-10">--</span><span 
class="cmtt-10">modify </span>option of the <a 
href="#x1-570003.11"><span 
class="cmti-10">ducc</span><span 
class="cmti-10">_services CLI:</span></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-68">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc_services&#x00A0;--modify&#x00A0;&#x003C;serviceid&#x003E;&#x00A0;--service_ping_dolog&#x00A0;true
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc_services&#x00A0;--modify&#x00A0;&#x003C;serviceid&#x003E;&#x00A0;--service_ping_class&#x00A0;OtherCustsomPing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--service_ping_classpath&#x00A0;/myhome/OtherCustomPing.class
&#x00A0;<br /></div>
<!--l. 500--><p class="nopar" > where <span 
class="cmmi-10">&#x003C;</span>serviceid<span 
class="cmmi-10">&#x003E; </span>is the id returned when you registered the pinger.
<!--l. 503--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-970005.6.4"></a><span 
class="cmbx-10">4. If all else fails ...</span></span>
If your pinger does not work and you cannot determine the reason, be sure you enable <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_dolog </span>and look in your log
directory, as most problems with pingers are reflected there. As a last resort, you can inspect the the Service Manager&#8217;s log
in
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-69">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/logs/sm.log</div>
<!--l. 509--><p class="nopar" >
<!--l. 511--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.6.5   </span> <a 
 id="x1-980005.6.5"></a>Globally Registered Pingers</h4>
<!--l. 514--><p class="noindent" >A user-built pinger may be registered with DUCC so that it can be globally used by any DUCC service. To do this, a
registration file containing only pinger-specific parameters is created in DUCC&#8217;s run-time directory. Such a pinger may then
be designated for a service by using its registered filename instead of its class in the <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_class </span>field of a
registration. There is no API or CLI to register such a pinger; only a DUCC administrator may create a global ping
registration.
<!--l. 520--><p class="noindent" >A globally-registered pinger may then be designated to run as a thread inside the SM or as a process spawned and managed
by the SM. A pinger that runs in a thread in the SM is called an <span 
class="cmti-10">internal </span>pinger, and one that runs in a process is called an
<span 
class="cmti-10">external </span>pinger. An <span 
class="cmti-10">internal </span>pinger generally has nearly unmeasurable impact on the system, whereas <span 
class="cmti-10">external </span>pingers will
occupy full JVMs with processes of 50-100MB or more.
<!--l. 526--><p class="noindent" >A service may override any of the options of a globally-registered <span 
class="cmti-10">external </span>pinger, thus allowing significant reuse of existing
code. Only the <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_arguments </span>of an <span 
class="cmti-10">internal </span>pinger may be overridden however.
<!--l. 530--><p class="noindent" >The default UIMA-AS pinger is permanently registered as an <span 
class="cmti-10">internal </span>pinger.
<!--l. 532--><p class="noindent" >Globally registered pingers use a special boolean property, not supported by the <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_services </span>API/CLI, &#8220;internal&#8221;, to
determine whether the pinger is to be run internally to SM or as an external process. Only the DUCC administrator may
update a global pinger&#8217;s registration to &#8220;internal&#8221;, to insure such pingers are properly vetted and approved by the
installation.
<!--l. 538--><p class="noindent" >More Details of registering global pingers is found in the <a 
href="#x1-28500014"><span 
class="cmti-10">Administration section</span></a> of this document.
<!--l. 541--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">5.7   </span> <a 
 id="x1-990005.7"></a>Sample Pinger</h3>
<!--l. 543--><p class="noindent" >A sample custom UIMA-AS pinger is provided in the Examples directory shipped with DUCC in
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-70">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC_HOME/examples/src/org/apache/uima/ducc/ping</div>
<!--l. 547--><p class="nopar" >
<!--l. 549--><p class="noindent" >This pinger increases or decreases the number of service instances based on the queue statistics found by querying ActiveMQ.
The goal of this pinger is to maintain the ActiveMQ &#8220;enqueued time&#8221; to be no more than some multiple
of the average service time for a single item. The factor used is a parameter passed in with the argument
string.
<!--l. 555--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.7.1   </span> <a 
 id="x1-1000005.7.1"></a>Using the Sample Pinger</h4>
<!--l. 556--><p class="noindent" >The following arguments may be specified to use the sample pinger with any UIMA-AS service. The <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_arguments</span>
are specific to this pinger.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-71">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_class=org.apache.uima.ducc.ping.SamplePing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_arguments=meta-timeout=15010,broker-jmx-port=1099,window=5,min=1,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;max=20,max-growth=3,fast-shrink=true,goal=2.5
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_classpath&#x00A0;=&#x00A0;${DUCC_HOME}/lib/uima-ducc/examples/*:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;${DUCC_HOME}/apache-uima/lib/*:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;${DUCC_HOME}/apache-uima/apache-activemq/lib/*:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;${DUCC_HOME}/lib//springframework/*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_dolog=True
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;service_ping_timeout=10000
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;instance_failures_window&#x00A0;=&#x00A0;${ducc.sm.instance.failure.window}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;instance_failures_limit&#x00A0;&#x00A0;=&#x00A0;${ducc.sm.instance.failure.max}</div>
<!--l. 571--><p class="nopar" >
<!--l. 573--><p class="noindent" >The full source for the sample pinger is found in
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-72">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC_HOME/examples/src/org/apache/uima/ducc/ping/SamplePing.java</div>
<!--l. 576--><p class="nopar" >
<!--l. 578--><p class="noindent" >The following arguments are accepted by this pinger and may be specified in a single single comma-delimited string
containing the following initialization parameters:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">meta-timeout</span> </dt><dd 
class="description">Defines how long to wait for <span 
class="cmti-10">get</span><span 
class="cmti-10">_meta </span>to return.
     </dd><dt class="description">
<span 
class="cmbx-10">broker-jmx-port</span> </dt><dd 
class="description">Defines the JMX port of the service&#8217;s broker.
     </dd><dt class="description">
<span 
class="cmbx-10">window</span> </dt><dd 
class="description">Defines the shrinkage/growth window size, in minutes.
     </dd><dt class="description">
<span 
class="cmbx-10">enable-log</span> </dt><dd 
class="description">Enable extra logging.
     </dd><dt class="description">
<span 
class="cmbx-10">min</span> </dt><dd 
class="description">The minimum number of service instances to maintain.
     </dd><dt class="description">
<span 
class="cmbx-10">max</span> </dt><dd 
class="description">The maximum number of service instances to allow.
     </dd><dt class="description">
<span 
class="cmbx-10">max-growth</span> </dt><dd 
class="description">The maximum number of instances to grow in a single request.
     </dd><dt class="description">
<span 
class="cmbx-10">fast-shrink</span> </dt><dd 
class="description">If set, allow services to shrink if the queue depth is 0, even if consumer are connected. Otherwise we do
     not shrink if consumers are attached to the queue.
     </dd><dt class="description">
<span 
class="cmbx-10">goal</span> </dt><dd 
class="description">The multiplier of the ActiveMQ Broker&#8217;s <span 
class="cmti-10">average enqeue </span>time to attempt to maintain by managing the number
     of instances.</dd></dl>
<!--l. 597--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.7.2   </span> <a 
 id="x1-1010005.7.2"></a>Understanding Sample Pinger</h4>
<!--l. 599--><p class="noindent" >The best way to understand this pinger is to examine the code itself in the Examples directory. Here we provide a brief
line-by-line synopsis of the code.
<!--l. 602--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1020005.7.2"></a><span 
class="cmbx-10">void init(String args, String ep)</span></span>
This required method examines the service arguments and endpoint and establishes a monitor to issue <span 
class="cmti-10">get-meta </span>calls to the
service and <span 
class="cmti-10">JMS </span>calls to the ActiveMq broker. The argument string <span 
class="cmti-10">args </span>is described above. The endpoint <span 
class="cmti-10">ep </span>is the service
endpoint used to register the service.
                                                                                                
                                                                                                
<!--l. 608--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1030005.7.2"></a><span 
class="cmbx-10">Lines 100-119</span></span>
These lines parse the endpoint <span 
class="cmti-10">ep </span>its components comprising the UIMA-AS queue name and the URL to the service
broker.
<!--l. 612--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1040005.7.2"></a><span 
class="cmbx-10">Lines 121-125</span></span>
These lines disable most UIMA-AS logging as these messages can be quite numerous. However, during debugging it may be
desired to change the logging levels here.
<!--l. 617--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1050005.7.2"></a><span 
class="cmbx-10">Lines 130-172</span></span>
These lines parse the service argument string <span 
class="cmti-10">args </span>into its constituent parts and places the values in variables. They initialize
the expansion and deletion window and normalize it to one slot per minute, regardless of the actual ping
rate.
<!--l. 623--><p class="noindent" >The window normalization uses the DUCC-supplied value <span 
class="cmti-10">monitor</span><span 
class="cmti-10">_rate </span>to determine the number of slots in the
windows.
<!--l. 626--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1060005.7.2"></a><span 
class="cmbx-10">Lines 176-177</span></span>
These lines initialize the DUCC-supplied <span 
class="cmti-10">UimaAsServiceMonitor </span>that queries the UIMA-AS queues, and it resets the queue
statistics via JMX so the monitor can make accurate measurements.
<!--l. 631--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1070005.7.2"></a><span 
class="cmbx-10">Lines 181-187</span></span>
These lines implement the required <span 
class="cmti-10">stop </span>method which is invoked when the Service Manager needs to stop the pinger for any
reason. They stop the ActiveMQ queue monitor and emit a shutdown message.
<!--l. 636--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1080005.7.2"></a><span 
class="cmbx-10">Lines 191-240</span></span>
These lines define the required <span 
class="cmti-10">getStatistics </span>method. This method collects ActiveMQ statistics, issue <span 
class="cmti-10">get-meta </span>to the service
to see if it is responding, sets the formatted information string into the ping reply, and invokes the code to calculate a
potential redeployment of service instances.
<!--l. 643--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1090005.7.2"></a><span 
class="cmbx-10">Lines 245-248</span></span>
These lines override the optional <span 
class="cmti-10">getLastUse </span>method which simply returns the time of last known use of the service. The
actual value is calculated in the pinger-specific <span 
class="cmti-10">calculateNewDeployment </span>method, described below.
                                                                                                
                                                                                                
<!--l. 649--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1100005.7.2"></a><span 
class="cmbx-10">Lines 253-298</span></span>
These lines define the pinger-specific <span 
class="cmti-10">calculateNewDeployment </span>method. This is invoked after <span 
class="cmti-10">get-meta </span>is called and after the
UIMA-AS queue has been queried in ActiveMQ. This is the key method of this pinger. It uses information passed in on the
last ping from the Service Manager in conjunction with information in the ActiveMQ queue to determine if more, or fewer
service instances are needed to meet the performance goals. If fewer instances are needed, it selects specific instances to stop.
The method is <a 
href="#x1-1140005.7.3"><span 
class="cmti-10">described in detail</span></a> below.
<!--l. 660--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1110005.7.2"></a><span 
class="cmbx-10">Lines 407-410</span></span>
These lines override the optional <span 
class="cmti-10">getAdditions </span>method. The method returns the number of new service instances required to
meet performance goals, as calculated in <a 
href="#x1-1140005.7.3"><span 
class="cmti-10">calculateNewDeployment</span></a>.
<!--l. 666--><p class="noindent" >Regardless of what this method returns, the Service Manager may choose not to start new instances, based on its configured
maximum, <span 
class="cmti-10">ducc.sm.max.instances </span>as defined in <span 
class="cmti-10">ducc.properties</span>.
<!--l. 670--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1120005.7.2"></a><span 
class="cmbx-10">Lines 416-419</span></span>
These lines override the optional <span 
class="cmti-10">getDeletions </span>method. This method returns the specific service instances to be stopped, if
any.
<!--l. 674--><p class="noindent" >The DUCC-assigned unique IDs of all service instances are passed in to the pinger on each ping. These instances are
monotonically increasing over time so pingers may assume that lower numbers represent older instances.
<!--l. 680--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1130005.7.2"></a><span 
class="cmbx-10">Lines 429-480</span></span>
These lines define a class used as a call-back on the UIMA-AS <span 
class="cmti-10">get-meta </span>requests to determine the host and PID of the service
instance responding to the <span 
class="cmti-10">get-meta</span>. If the <span 
class="cmti-10">get-meta </span>request should timeout, this information can be used to help identify
ailing or overloaded service instances.
<!--l. 687--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.7.3   </span> <a 
 id="x1-1140005.7.3"></a>Calculating New Deployments in the Pinger</h4>
<!--l. 690--><p class="noindent" >his section details the use of ActiveMQ queue statistics in conjunction with the Service Monitor data to calculate the number
of service instances to increase or decrease.
<!--l. 694--><p class="noindent" >It is important that this code be very careful about &#8220;smoothing&#8221; the performance statistics to keep growth and shrinkage
stable. Things to take into consideration include:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Immediately after a new service instance becomes available to serve, if there is demand for this service, the
     ActiveMQ statistics will fluctuate for a few minutes until traffic stabilizes. Thus decisions based on these
     statistics must reflect history as well as current information.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Immediately after a client begins to use a service, the statistics will also fluctuate, again requiring smoothing.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The DUCC work dispatching model will not over-dispatch work to the job processes. Thus actual demand on a
     service is a function of the number of actively deployed and initialized JPs. If the number of JPs decreases due
     to preemption, demand on the service by that job will decrease proportionally. Similarly, demand can increase
     as the job expands.
                                                                                                
                                                                                                
     <!--l. 714--><p class="noindent" >It is common for demand on a service to ramp up slowly as a job enters the system, and increase rapidly as a
     job completes its initialization phase and starts to double. Thus, the ActiveMQ statistics can be quite erratic
     for a while, until the job stabilizes.
     <!--l. 719--><p class="noindent" >This again requires some sort of smoothing of the data when making decisions about service growth and
     shrinkage.</dd></dl>
<!--l. 723--><p class="noindent" >To handle this data smoothing, the SamplePing classes uses two time-based <span 
class="cmti-10">windows</span>, one for growth, and one for shrinkage,
to keep growth and shrinkage stable. The window size is defined in the service ping argument <span 
class="cmti-10">window</span>. Each window period, if
more services are needed, a mark is made in the current slot of the <span 
class="cmti-10">expansion window</span>; otherwise the current slot is cleared.
Similarly, each period, if fewer services are needed, a mark is made in the <span 
class="cmti-10">shrinkage window</span>; otherwise, the current slot is
cleared.
<!--l. 731--><p class="noindent" >After the marks are made, if the <span 
class="cmti-10">expansion window </span>has all slots filled, a request for new processes is made;
thus, a short period of increased does not destabilize the system with a request for services that may be of
little use. Additionally, when a request is made, the number of new processes requested is capped by the
ping argument <span 
class="cmti-10">max-growth </span>to insure that the service grows smoothly. And finally, if the service is already at
some configured maximum number of instances, defined by the <span 
class="cmti-10">max </span>parameter, no additional instances are
requested.
<!--l. 740--><p class="noindent" >Similarly, the <span 
class="cmti-10">shrinkage window </span>is used to govern shrinkage. All slots must be filled, indicating the service has been
over-provisioned for a while, before a request is made to delete instances. The number of instances is never
reduced below the configured <span 
class="cmti-10">min </span>value. As well, this particular pinger never shrinks by more than a single
instance at a time, on the reasoning that it is more costly to start a new service than to maintain one for
too long. Only if there is no long-term use of the extra instances are they reduced (as determined by the
window).
<!--l. 749--><p class="noindent" >Given this introduction, we describe the key method in detail.
<!--l. 751--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1150005.7.3"></a><span 
class="cmbx-10">Lines 262-277</span></span>
These lines extract four quantities from the ActiveMQ statistics:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Average enqueue time, <span 
class="cmti-10">eT</span>
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Current queue depth, <span 
class="cmti-10">Q</span>
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The current number of service consumers <span 
class="cmti-10">cc</span>
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">The current number of service producers <span 
class="cmti-10">pc</span></dd></dl>
<!--l. 760--><p class="noindent" >The code then gets the DUCC IDs of all the currently started service instances, and the number of instances that are started
but still in their &#8220;initialization&#8221; phase. This is important because instances that are still initializing are not servicing the
queue, but will soon start to do so. The current ActiveMQ statistics reflect do NOT yet reflect this however, they reflect only
the instances that are actually serving.
<!--l. 767--><p class="noindent" >Finally, if there are service producers, we note the time of day to return to the SM as the last known use of this service by
some process.
<!--l. 770--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1160005.7.3"></a><span 
class="cmbx-10">Lines 267</span></span>
This line calculates the number of Java threads per service instance, needed to calculate the maximum capacity of the service
in its current deployment.
                                                                                                
                                                                                                
<!--l. 774--><p class="noindent" >(Note that in each UIMA-AS service, UIMA-AS itself occupies one thread, used to manage the service, and this thread
manifests itself as a consumer on the queue.)
<!--l. 778--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1170005.7.3"></a><span 
class="cmbx-10">Line 301</span></span>
This declares <span 
class="cmti-10">new</span><span 
class="cmti-10">_ni</span>, the number of additional instances, if any. At the end of this method, new_ni will either be 0 or
<span 
class="cmmi-10">&#x003E;</span>0.
<!--l. 782--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1180005.7.3"></a><span 
class="cmbx-10">Lines 303-312</span></span>
If the current queue depth is 0 (Q == 0), we know a number of things:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The service is not over-provisioned; there is no work queued and waiting for some service. We therefor do not
     need to expand.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">If there are no consumers, i.e. no clients that need work done, we are potentially over-provisioned, so we fill in
     a slot in the expansion window.
     <!--l. 791--><p class="noindent" >If there <span 
class="cmti-10">are </span>consumers, we may not want to shrink because it is possible that one of the service instances is
     busy; we cannot tell. So we allow the <span 
class="cmti-10">fast-shrink </span>ping argument to govern whether or not connected consumers
     may prevent service shrinkage.</dd></dl>
<!--l. 798--><p class="noindent" >There is nothing else that can be said about a service if its current queue depth is 0.
<!--l. 801--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1190005.7.3"></a><span 
class="cmbx-10">Lines 312-360</span></span>
If the queue depth is non-zero we are able to calculate the total service capacity and the amount each instance contributes to
the total capacity. From this we can determine
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">whether the service is performing at or near its goal,
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">if the service is performing worse than its goal, how many new instances are needed to meet the goal, and
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">if the service is performing better than its goal, how many instances can be given up and still meet the goal.</dd></dl>
<!--l. 814--><p class="noindent" >Details follow.
<!--l. 816--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1200005.7.3"></a><span 
class="cmbx-10">Lines 314 and 315</span></span>
The average time a single instance takes to serve a single request, <span 
class="cmti-10">Ti </span>is given by the simple formula
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-73">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;Ti&#x00A0;=&#x00A0;(eT&#x00A0;/&#x00A0;Q)&#x00A0;*&#x00A0;active</div>
<!--l. 822--><p class="nopar" > where
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">eT</span> </dt><dd 
class="description">is the average time an item stays in queue (from AMQ),
     </dd><dt class="description">
<span 
class="cmbx-10">Q</span> </dt><dd 
class="description">is the current queue depth (from AMQ),
     </dd><dt class="description">
<span 
class="cmbx-10">active</span> </dt><dd 
class="description">is the current number of service instances (from SM)</dd></dl>
<!--l. 831--><p class="noindent" >Therefore the time taken by a single thread <span 
class="cmti-10">Ti </span>is given by
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-74">
&#x00A0;&#x00A0;&#x00A0;Tt&#x00A0;=&#x00A0;Ti&#x00A0;*&#x00A0;nthreads</div>
<!--l. 834--><p class="nopar" >
<!--l. 836--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1210005.7.3"></a><span 
class="cmbx-10">Lines 319 and 320</span></span>
We want <span 
class="cmti-10">Tt </span>to become close to the current
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-75">
&#x00A0;&#x00A0;&#x00A0;Tt&#x00A0;*&#x00A0;goal</div>
<!--l. 840--><p class="nopar" >
<!--l. 842--><p class="noindent" >where <span 
class="cmti-10">goal </span>is given by the ping arguments. The current ratio of actual service time to desired is then given
by
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-76">
&#x00A0;&#x00A0;&#x00A0;r&#x00A0;=&#x00A0;eT&#x00A0;/&#x00A0;g</div>
<!--l. 846--><p class="nopar" >
<!--l. 848--><p class="noindent" >Because we know that the DUCC job driver will never over-commit; that is, we know the current demand will remain
constant unless the jobs using the service expand or contract (which are relatively rare events), we can state that the number
of service instances required is directly proportional to <span 
class="cmti-10">r</span>.
<!--l. 854--><p class="noindent" >If <span 
class="cmmi-10">r &#x003E; </span>1 we may need more instances to meet our <span 
class="cmti-10">goal </span>and if <span 
class="cmmi-10">r &#x003C; </span>1 we may be over-provisioned.
<!--l. 857--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1220005.7.3"></a><span 
class="cmbx-10">Lines 325-347</span></span>
If <span 
class="cmmi-10">r &#x003E; </span>1 we may be over-provisioned. We calculate the number of required instances by multiplying the current instances by <span 
class="cmti-10">r</span>
and rounding down. We account for instances that we know are starting but not yet started, cap on max instances per
service, and again on max growth per cycle.
<!--l. 863--><p class="noindent" >If we still require additions, we make a mark in the expansion window, otherwise we clear the expansion window.
<!--l. 866--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1230005.7.3"></a><span 
class="cmbx-10">Lines 349-360</span></span>
If <span 
class="cmmi-10">r &#x003C; </span>1 we need to calculate shrinkage. Because starting instances is expensive we conservatively use <span 
class="cmmi-10">r &#x003C; .</span>5 instead and make
a mark in the shrinkage window.
<!--l. 871--><p class="noindent" >Otherwise we clear the mark in the shrinkage window.
<!--l. 873--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1240005.7.3"></a><span 
class="cmbx-10">Lines 367-396</span></span>
Finally we sum across the shrinkage and expansion windows. If either window is full, we schedule growth (line 375, set the
variable <span 
class="cmti-10">additions</span>) or shrinkage (line 388, set <span 
class="cmti-10">deletions</span>).
<!--l. 878--><p class="noindent" >Note that to schedule shrinkage, we must choose a specific instance. In this case we choose the <span 
class="cmti-10">newest </span>instance, i.e. the one
with the largest DUCC ID, as it is most likely not to have initialized, or perhaps not to have &#8220;warmed up&#8221; (i.e. caches filled,
etc.). We could choose more than one but this pinger is conservative and only shrinks by one instance each
time.
<!--l. 885--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">5.7.4   </span> <a 
 id="x1-1250005.7.4"></a>Summary of Sample Pinger</h4>
<!--l. 886--><p class="noindent" >This pinger illustrates these functions over-and above the functions provided by the default UIMA-AS pinger:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Use of pinger-specific arguments
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Use of information provided by SM on each ping (service instances active, total service instances,
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Use of performance information acquired from ActiveMQ
                                                                                                
                                                                                                
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">Requesting new service instances of the SM
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">Requesting that instances be removed by SM,
     </dd><dt class="enumerate-enumitem">
  6. </dt><dd 
class="enumerate-enumitem">Setting of last-use of a service</dd></dl>
<!--l. 898--><p class="noindent" >It illustrates one mechanism for smoothing growth and shrinkage of a service to prevent thrashing in your
system.
<!--l. 901--><p class="noindent" >It illustrates one mechanism for determining the actual performance of a service by analyzing ActiveMQ queueing
statistics.
<!--l. 904--><p class="noindent" >It illustrates the use of &#8220;globally registered pingers.&#8221;
<!--l. 22--><p class="noindent" ><a name='DUCC_LOGS'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-1260006"></a>Job Logs</h2>
<!--l. 28--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1270006"></a><span 
class="cmbx-10">Overview</span></span>
The DUCC logs are managed by Apache log4j. The DUCC log4j configuration file is found in $DUCC_HOME/resources/log4j.xml.
It is not in the scope of this document to describe log4j or its configuration mechanism. Details on log4j can be found at
<a 
href="http://logging.apache.org/log4j" class="url" ><span 
class="cmtt-10">http://logging.apache.org/log4j</span></a>.
<!--l. 33--><p class="noindent" >The &#8221;user logs&#8221; are the Job Driver (JD) and Job Process (JP) logs. There is one log for each process of a job. The JD log is
divided between two physical files:
<!--l. 37--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Stdout and default UIMA logging output written by the UIMA collection reader.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">The diagnostic logs written by the DUCC JD wrapper around the job&#8217;s collection reader.</dd></dl>
<!--l. 41--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1280006"></a><span 
class="cmbx-10">Contents of the Log Directory</span></span>
A number of other useful files are written to the log directory:
<!--l. 44--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">A properties file containing the full job specification for the job. This includes all the parameters specified by
     the user as well as the default parameters. This file is called <span 
class="cmtt-10">job-specification.properties.</span>
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">The UIMA pipeline descriptor constructed by DUCC that describes the process that is dispatched to each Job Process
     (JP). The name of this file is of the form
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-77">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JOBID-uima-ae-descriptor-PROCESS.xml</div>
     <!--l. 51--><p class="nopar" > where
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">JOBID</span> </dt><dd 
class="description">This is the numerical id of the job as assigned by DUCC.
         </dd><dt class="description">
     <span 
class="cmbx-10">PROCESS</span> </dt><dd 
class="description">This is the process id of the Job Driver (JD) process.</dd></dl>
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The UIMA-AS service descriptor that defines the process that defines the job as as UIMAAS service. The name of this
     file is of the form
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-78">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JOBID-uima-as-dd-PROCESS.xml</div>
     <!--l. 62--><p class="nopar" >
     <!--l. 64--><p class="noindent" >where
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">JOBID</span> </dt><dd 
class="description">This is the numerical id of the job as assigned by DUCC.
         </dd><dt class="description">
     <span 
class="cmbx-10">PROCESS</span> </dt><dd 
class="description">This is the process id of the Job Driver (JD) process.</dd></dl>
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">A colllection of gzipped &#8220;json&#8221; files containing the performance breakdown of the job. These can be read and formatted
     using <span 
class="cmbx-10">??</span></dd></dl>
<!--l. 74--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1290006"></a><span 
class="cmbx-10">Job Process Logs</span></span>
The Job Process logs are written to the configured log directory. There is one job process log for every job processes started
for the job. The log names are of the following form:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-79">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JOBID-TYPE-NODE-PROCESS.log</div>
<!--l. 79--><p class="nopar" > where
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">JOBID</span> </dt><dd 
class="description">This is the numerical id of the job as assigned by DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">TYPE</span> </dt><dd 
class="description">This is either the string &#8221;UIMA&#8221; for JP logs, or &#8221;JD&#8221; for JD logs.
     </dd><dt class="description">
<span 
class="cmbx-10">NODE</span> </dt><dd 
class="description">This is the name of the machine where the process ran.
     </dd><dt class="description">
<span 
class="cmbx-10">PROCESS</span> </dt><dd 
class="description">This is the Unix process id of the process on the indicated node.</dd></dl>
<!--l. 88--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1300006"></a><span 
class="cmbx-10">Job Driver Logs</span></span>
There are several Job Driver logs. 988-JD-agent86-1-58087.log jd.out.log jd.err.log
<!--l. 94--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1310006"></a><span 
class="cmbx-10">Sample Log Directory</span></span>
This shows the contents a sample log directory for a small job that consisted of two processes.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-80">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;100-JD-node290-1-29383.log
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;100-uima-ae-descriptor-29383.xml
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;100-uima-as-dd-29383.xml
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;100-UIMA-node290-2-32766.log
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;100-UIMA-node291-63-13594.log
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;jd.out.log
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;job-specification.properties
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;job-performance-summary.json.gz
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;job-processes-data.json.gz
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;work-item-status.json.gz
&#x00A0;<br /></div>
<!--l. 109--><p class="nopar" >
<!--l. 111--><p class="noindent" >In this example,
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">100-JD-node290-1-29383.log</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />is the diagnostic JD log, where the JD executed on node node290-1 in process 29383.
     </dd><dt class="description">
<span 
class="cmbx-10">100-uima-ae-descriptor-29383.xml</span> </dt><dd 
class="description">                                                                                      <br 
class="newline" />is the UIMA pipeline descriptor describing the service process that is launched in each JP, where the JD process
     is 29383.
     </dd><dt class="description">
<span 
class="cmbx-10">100-uima-as-dd-29383.xml</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />is the UIMA-AS service descriptor where the client is the JD process running in process 29383.
     </dd><dt class="description">
<span 
class="cmbx-10">100-UIMA-node290-2-32766.log</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />is a JP log for job 100, that ran on node node290-2, in process 32766.
     </dd><dt class="description">
<span 
class="cmbx-10">100-UIMA-node291-63-13594.log</span> </dt><dd 
class="description">                                                                                        <br 
class="newline" />is a JP log for job 100, that ran on node node291-63, in process 13594
     </dd><dt class="description">
<span 
class="cmbx-10">jd.out.log</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />is the user&#8217;s JD log, containing the user&#8217;s collection reader output.
     </dd><dt class="description">
<span 
class="cmbx-10">job-performance-summary.json.gz</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />This contains the raw statistics describing the operation of each analytic. It corresponds to <a 
href="#x1-1420007.3.3">Performance</a> tab
     of the Job Details page in the Web Server.
     </dd><dt class="description">
<span 
class="cmbx-10">job-process.json.gz</span> </dt><dd 
class="description">                                                                                                          <br 
class="newline" />This contains the raw statistics describing the performance of each individual job process. It corresponds
     <a 
href="#x1-1400007.3.1">Processes</a> tab of the Job Details page in the Web Server.
     </dd><dt class="description">
<span 
class="cmbx-10">work-item-status.json.gz</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />This contains the raw statistics describing the operation of each individual work-item. It corresponds to <a 
href="#x1-1410007.3.2">Work
     Items</a> tab of the Job Details page in the Web Server.</dd></dl>
                                                                                                
                                                                                                
<!--l. 22--><p class="noindent" ><a name='DUCC_WEBSERVER'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-1320007"></a>DUCC Web Server</h2>
<!--l. 26--><p class="noindent" >The DUCC Web Server default address is accessed from the URL http://[DUCC-HOST]:42133. The <span 
class="cmti-10">[DUCC-HOST] </span>is the
hostname where the local installation has installed the DUCC Web Server.
<div class="center" 
>
<!--l. 30--><p class="noindent" >
<div class="fbox">The hostname and port are configurable by the DUCC administrator in ducc.properties</div>
</div>
<!--l. 35--><p class="noindent" >The Webserver is designed to be mostly self-documenting. The design is intentionally simple and contains a link to this
document. Most of the interesting fields and column headers have &#8220;mouse hovers&#8221; which display a short description if you
hover your mouse pointer over it for a moment.
<!--l. 40--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-132001r1"></a>
                                                                                                
                                                                                                

<!--l. 42--><p class="noindent" ><img 
src="images/ducc-webserver/System-Daemons.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.1: </span><span  
class="content">Sample Webserver Page</span></div><!--tex4ht:label?: x1-132001r1 -->
                                                                                                
                                                                                                
<!--l. 44--><p class="noindent" ></div><hr class="endfigure">
<!--l. 46--><p class="noindent" >Normally, the Web Server automatically fetches new data from DUCC and updates the display. This is controlled by setting
one of the two refresh modes:
     <ul class="itemize1">
     <li class="itemize">Manual refresh. In this mode, the browser windows are updated only by using the browser&#8217;s refresh button, or
     the DUCC refresh button to the left in the header of each page.
     </li>
     <li class="itemize">Automatic refresh. In this mode, the browser automatically fetches and displays new data. The rate of refresh
     is currently fixed and cannot be configured.</li></ul>
<!--l. 56--><p class="noindent" >There is a behavior difference between refresh and reload.
<!--l. 57--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1330007"></a><span 
class="cmbx-10">Refresh</span></span>
Refresh causes the current data on the page to be updated with the most current information in the Webserver&#8217;s possession.
This is performed when the refresh button is clicked.
<!--l. 61--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1340007"></a><span 
class="cmbx-10">Reload</span></span>
Reload occurs when the enter key is pressed. Reload causes not just the data to be updated but rather the entire page is
replaced.
<!--l. 65--><p class="noindent" >Two different table styles are supported:
     <ul class="itemize1">
     <li class="itemize">Scroll, and
     </li>
     <li class="itemize">Classic.</li></ul>
<!--l. 70--><p class="noindent" >Table styles are switched using the <span 
class="cmti-10">Preferences </span>link.
<!--l. 72--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1350007"></a><span 
class="cmbx-10">Scroll Mode</span></span>
When <span 
class="cmti-10">scroll table style </span>is the preference, a scroll bar is shown to the right, within the main window. The scroll bar allows
scrolling to be restricted to the data display, leaving column and DUCC headers in place. In this mode any column may be
sorted simply by clicking on it.
<!--l. 77--><p class="noindent" >With respect to sorting, any specified sort is remembered for refresh but forgotten for reload. Sorting is permitted when
either manual or automatic refresh mode is selected.
<!--l. 81--><p class="noindent" >The column sort order is maintained until the page is reloaded.
<!--l. 83--><p class="noindent" >Note that not all pages have a scroll version - some only have a classic version.
<!--l. 85--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1360007"></a><span 
class="cmbx-10">Classic Mode</span></span>
When <span 
class="cmti-10">classic table style </span>is the preference, the main data may extend below the bottom of the page and it will be necessary to
use the browser&#8217;s scroller on the right to access it. The column headers and DUCC header scrolls off when doing this.
Columns may be sorted in this mode but it is necessary to first switch to &#8220;Manual&#8221; refresh mode to prevent browser refreshes
during sorting and display of data.
<!--l. 91--><p class="noindent" >With respect to sorting, any specified sort is forgotten for refresh and reload. Sorting is only permitted when manual refresh
mode is selected.
                                                                                                
                                                                                                
<!--l. 95--><p class="noindent" >The column sort order is maintained until the page is refreshed or reloaded.
<!--l. 97--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-136001r2"></a>
                                                                                                
                                                                                                

<!--l. 99--><p class="noindent" ><img 
src="images/ducc-webserver/Preferences.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.2: </span><span  
class="content">Preferences Page</span></div><!--tex4ht:label?: x1-136001r2 -->
                                                                                                
                                                                                                
<!--l. 101--><p class="noindent" ></div><hr class="endfigure">
<!--l. 106--><p class="noindent" ><a name='DUCC_WS_COMMON'></a>
<h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-1370007.1"></a>Common Links</h3>
<!--l. 110--><p class="noindent" >Every page contains a common header containing links and controls. The links permit navigation to other content at the site.
The controls provide page-wise configuration of the content at that page.
<!--l. 114--><p class="noindent" >The following links are available on every page of the web server:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Authentication</span> </dt><dd 
class="description">                                                                                                               <br 
class="newline" />Authentication is needed in order to cancel jobs and reservations, to create a reservation, and to perform
     administration. It is not required to simply view the pages.
         <ul class="itemize1">
         <li class="itemize">Login - Authenticate and start a session with the Web Server.
         </li>
         <li class="itemize">Logout - Terminate the Web Server session</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">Preferences</span> </dt><dd 
class="description">The following preferences may be set:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Table Style</span> </dt><dd 
class="description">This selects &#8220;scroll&#8221; or &#8220;classic&#8221; display, as described above.
         </dd><dt class="description">
     <span 
class="cmbx-10">Date Style</span> </dt><dd 
class="description">This selects long, medium, or long formats for dates.
         </dd><dt class="description">
     <span 
class="cmbx-10">Description Style</span> </dt><dd 
class="description">This selects long or short formats for the various description fields.
         </dd><dt class="description">
     <span 
class="cmbx-10">Filter Users</span> </dt><dd 
class="description">This controls the &#8220;filter&#8221; box near the middle of the header on each page. It allows various levels
         of inclusion and exclusion of active or completed work for the filtered users.
         </dd><dt class="description">
     <span 
class="cmbx-10">Role</span> </dt><dd 
class="description">This allows selection of &#8220;User&#8221; or &#8220;Administrator&#8221; roles. This protects registered DUCC administrators
         from accidentally affecting other people&#8217;s work.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">DuccBook</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is a link to the HTML version of the document you are reading.
     </dd><dt class="description">
<span 
class="cmbx-10">Jobs</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This navigates to the Jobs page, showing all the jobs in the system.
     </dd><dt class="description">
<span 
class="cmbx-10">Reservations</span> </dt><dd 
class="description">                                                                                                                  <br 
class="newline" />This navigates to the Reservations page, showing all the reservations in the system and provides a button that can be
     used to request new reservations.
     </dd><dt class="description">
<span 
class="cmbx-10">Services</span> </dt><dd 
class="description">                                                                                                                        <br 
class="newline" />This navigates to the Services page, showing all the services in the system.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">System</span> </dt><dd 
class="description">                                                                                                                         <br 
class="newline" />This opens a sub-menu with system-related links:
         <ul class="itemize1">
         <li class="itemize">Administration - This opens a page with administrative functions.
         </li>
         <li class="itemize">Classes - This shows all the scheduling classes defined to the system.
         </li>
         <li class="itemize">Daemons - This shows the status of DUCC&#8217;s management processes.
         </li>
         <li class="itemize">DuccBook - This manual.
         </li>
         <li class="itemize">Machines - This shows the status of all the ducc worker nodes.</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">Viz</span> </dt><dd 
class="description">This opens a page with a visualization of the system hosts, showing all scheduled work in the system.</dd></dl>
<!--l. 174--><p class="noindent" ><a name='DUCC_WS_JOBS'></a>
<!--l. 20--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-1380007.2"></a>Jobs Page</h3>
<!--l. 22--><p class="noindent" >The Web Server&#8217;s home page is also the Jobs page. This page has links to all the rest of the content at the site and shows the
status of all the jobs in the system.
<!--l. 25--><p class="noindent" >The Jobs page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Id</span> </dt><dd 
class="description">                                                                                                                                <br 
class="newline" />This is the ID as assigned by DUCC. This field is hyperlinked to a <a 
href="#x1-1390007.3">Job Details</a> page for that job that shows
     the breakdown of all the processes assigned to the job and their state.
     </dd><dt class="description">
<span 
class="cmbx-10">Start</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the time the Job is accepted into DUCC.
     </dd><dt class="description">
<span 
class="cmbx-10">Duration</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This shows two times. In green the length of time the job has been running. In black is the estimated time of
     completion, based on current resources and remaining work. When the job completes, the time shown is the
     total elapsed time of the job.
     </dd><dt class="description">
<span 
class="cmbx-10">User</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the userid of the job owner.
     </dd><dt class="description">
<span 
class="cmbx-10">Class</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the resource class the job is submitted to.
     </dd><dt class="description">
<span 
class="cmbx-10">State</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This shows the state of the job. The normal job progression is shown below, with an explanation of what each state
                                                                                                
                                                                                                
     means.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Received</span> </dt><dd 
class="description">- The job has been vetted, persisted, and assigned a unique ID.
         </dd><dt class="description">
     <span 
class="cmbx-10">WaitingForDriver</span> </dt><dd 
class="description">- The job is waiting for the Job Driver to initialize.
         </dd><dt class="description">
     <span 
class="cmbx-10">WaitingForServices</span> </dt><dd 
class="description">- The job is waiting for verification from the Service Manager that required services are
         started and responding. This may cause DUCC to start services if necessary. In that even this state will
         persist until all pre-requisite services are ready.
         </dd><dt class="description">
     <span 
class="cmbx-10">WaitingForResources</span> </dt><dd 
class="description">- The job is waiting to be scheduled. In busy systems this may require preemption of
         existing work. In that case this state will persist until preemption is complete.
         </dd><dt class="description">
     <span 
class="cmbx-10">Initializing</span> </dt><dd 
class="description">-  The  job  initializing.  Usually  this  is  the  UIMA-AS  initialization  phase.  In  the  default
         configuration, only two (2) processes are allocated by the Resource Manager. No additional resources are
         allocated until at least one of the new processes successfully completes initialization. Once initialization is
         complete the Resource Manager will double the number of allocated processes until the user&#8217;s fair share
         of the resources is attained.
         </dd><dt class="description">
     <span 
class="cmbx-10">Running</span> </dt><dd 
class="description">- At least one process is now initialized and running.
         </dd><dt class="description">
     <span 
class="cmbx-10">Completing</span> </dt><dd 
class="description">- The last work item has completed and DUCC is freeing resources. If the job had many resources
         allocated at the time the job exited this state will persist until all allocated resources are freed.
         </dd><dt class="description">
     <span 
class="cmbx-10">Completed</span> </dt><dd 
class="description">- The job is complete.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason or Extraordinary Status</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />
     <!--l. 80--><p class="noindent" >This field contains miscellaneous information pertaining to the job. If the job exits the system for any reason, that
     reason is shown here. If the job&#8217;s pre-requisite services are unavailable (or ailing) that fact is displayed here. If there is a
     job monitor running, that fact is shown here. Most of the values for this field support &#8220;hovers&#8221; containing additional
     information about the reason.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">EndOfJob</span> </dt><dd 
class="description">- The job and completed ran with no errors.
         </dd><dt class="description">
     <span 
class="cmbx-10">Error</span> </dt><dd 
class="description">- All work items are processes but at least one had an error.
         </dd><dt class="description">
     <span 
class="cmbx-10">CanceledByDriver</span> </dt><dd 
class="description">- The Job Driver (JD) terminated the job. The reason for termination is seen by hovering
         over the text with your mouse.
         </dd><dt class="description">
     <span 
class="cmbx-10">CanceledBySystem</span> </dt><dd 
class="description">- The job was canceled because DUCC was shutdown.
         </dd><dt class="description">
     <span 
class="cmbx-10">CanceledBySser</span> </dt><dd 
class="description">- The job owner or DUCC administrator canceled the job.
         </dd><dt class="description">
     <span 
class="cmbx-10">Cancel Pending</span> </dt><dd 
class="description">- The job has been canceleled and is not yet fully evicted from the system.
                                                                                                
                                                                                                
         </dd><dt class="description">
     <span 
class="cmbx-10">DriverInitializationFailure</span> </dt><dd 
class="description">- The Job Deiver (JD) process is unable to initialize. Hover over the field with
         your mouse for details (if any are available), and check your JD log.
         </dd><dt class="description">
     <span 
class="cmbx-10">DriverProcessFailed</span> </dt><dd 
class="description">- The Job Driver (JD) process failed for some reason. Hover over the field with your
         mouse for details (if any), and check your JD log.
         </dd><dt class="description">
     <span 
class="cmbx-10">MonitorActive</span> </dt><dd 
class="description">The job has a console monitor active. This is enabled with the job&#8217;s &#8220;wait_for_completion&#8221;
         parameter on job submission.
         </dd><dt class="description">
     <span 
class="cmbx-10">ServicesUnavailable</span> </dt><dd 
class="description">- The job declared a dependency on one or more services, and the Service Manager
         (SM) cannot find or start the required service.
         </dd><dt class="description">
     <span 
class="cmbx-10">Premature</span> </dt><dd 
class="description">- The job was terminated for some unknown reason before all work items were processed. Check
         the JP logs for details.
         </dd><dt class="description">
     <span 
class="cmbx-10">ProcessInitializationFailure</span> </dt><dd 
class="description">- Too many processes failed during initialization and the job was canceled by
         DUCC. Check the JP logs for the reason.
         </dd><dt class="description">
     <span 
class="cmbx-10">ProcessFailure</span> </dt><dd 
class="description">- Too many processes failed while running and DUCC canceled the job. Check the JP logs
         for the reason.
         </dd><dt class="description">
     <span 
class="cmbx-10">ResourcesUnavailable</span> </dt><dd 
class="description">-  The  Resource  Manager  (RM)  is  unable  to  allocate  resources  for  the  job.  For
         non-preemptable jobs this could be because the limit on that type of allocation is reached, or all the nodes
         are already allocated and work cannot be preempted to make space for it. For all jobs, it could be because
         the job class is invalid.
         </dd><dt class="description">
     <span 
class="cmbxti-10">service</span><span 
class="cmbxti-10">_name</span> </dt><dd 
class="description">If there is a service name in this field it indicates the job is dependent on the service but the
         service is not responding to the Ducc Service Monitor&#8217;s pinger.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Services</span> </dt><dd 
class="description">                                                                                                                        <br 
class="newline" />This is the number of services the job has declared dependencies on. There is a &#8220;hover&#8221; that shows the ids of the
     services, if any.
     </dd><dt class="description">
<span 
class="cmbx-10">Processes</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the number of processes currently assigned to the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Init Fails</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This is the total number of initialization failures experienced by the job. This field is hyperlinked to pages with log
     excerpts highlighting the specific failures.
     </dd><dt class="description">
<span 
class="cmbx-10">Run Fails</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the total number of process failures experienced by the job. This field is hyperlinked to pages with log excerpts
     highlighting the specific failures.
     </dd><dt class="description">
<span 
class="cmbx-10">Pgin</span> </dt><dd 
class="description">This is the number of page-in events, over all processes, on the machines running the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Swap</span> </dt><dd 
class="description">This is the total swap space, over all the processes, being used by the job.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the declared memory size of the job
     </dd><dt class="description">
<span 
class="cmbx-10">Total</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the total number of work items declared by the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Done</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the total number of work items successfully completed for the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Error</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the total number of exceptions thrown or other errors experienced by work items. This field is hyperlinked to
     pages containing log excerpts highlighting the failures.
     </dd><dt class="description">
<span 
class="cmbx-10">Dispatch</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This is the total number CASs that are currently dispatched.
     <!--l. 156--><p class="noindent" >This usually represents the quantity derived from the following formula:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-81">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;min(&#x00A0;(initialized.processes&#x00A0;*&#x00A0;threads.per.process),&#x00A0;(incomplete.work.items&#x00A0;-&#x00A0;errors)&#x00A0;)</div>
     <!--l. 159--><p class="nopar" >
     <!--l. 161--><p class="noindent" >The actual number is a measured number, not a calculated number, and may differ slightly from the formula if the
     measurement is taken immediately after process start-up, or in the time between a work item completing and a new one
     being dispatched.
     </dd><dt class="description">
<span 
class="cmbx-10">Retry</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the number of CASs that were retried for any reason. Reasons for retry include preemption for fair-share,
     work-item timeout, or error conditions.
     <!--l. 170--><p class="noindent" >Note: If a work item in any process fails, the entire process is considered suspect, and all work-items in the process are
     terminated. Work items in the process which did not have errors are re-dispatched (retried) to a different
     process.
     </dd><dt class="description">
<span 
class="cmbx-10">Preempt</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This is the total number of processes that have been preempted to make room for other work due to Fair
     Share.
     </dd><dt class="description">
<span 
class="cmbx-10">Description</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This is the description string from the <span 
class="cmsy-10">--</span>description string from submit.</dd></dl>
<!--l. 183--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-138001r3"></a>
                                                                                                
                                                                                                

<!--l. 185--><p class="noindent" ><img 
src="images/ducc-webserver/Jobs.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.3: </span><span  
class="content">Jobs Page</span></div><!--tex4ht:label?: x1-138001r3 -->
                                                                                                
                                                                                                
<!--l. 187--><p class="noindent" ></div><hr class="endfigure">
<!--l. 181--><p class="noindent" ><a name='DUCC_WS_JOB_DETAILS'></a>
<h3 class="sectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-1390007.3"></a>Job Details Page</h3>
<!--l. 23--><p class="noindent" >This page shows details of all the processes that run in support of a job. The information is divided among four
tabs:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Processes</span> </dt><dd 
class="description">This tab contains details on all the processes for the job, both active, and defunct.
     </dd><dt class="description">
<span 
class="cmbx-10">Work Items</span> </dt><dd 
class="description">This tab shows details for each individual work-item in the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Performance</span> </dt><dd 
class="description">This tab shows a performance break-down of all the UIMA analytics in the job.
     </dd><dt class="description">
<span 
class="cmbx-10">Specification</span> </dt><dd 
class="description">This tab shows the job specification for the job.</dd></dl>
<!--l. 34--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.3.1   </span> <a 
 id="x1-1400007.3.1"></a>Processes</h4>
<!--l. 36--><p class="noindent" >The processes page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Id</span> </dt><dd 
class="description">                                                                                                                                <br 
class="newline" />This is the DUCC-assigned numeric id of the process (not the Operating System&#8217;s processid). Process 0 is
     always the Job Driver.
     </dd><dt class="description">
<span 
class="cmbx-10">Log</span> </dt><dd 
class="description">                                                                                                                              <br 
class="newline" />This is the log name for the process. It is hyperlinked to the log itself.
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the size of the log in MB. If you find you have trouble viewing the log from the Web Server it could be
     because it is too big to view in the server and needs to be read by some other means than the Web Server. (It
     is not currently paged in by the Web Server, it is read in full.)
     </dd><dt class="description">
<span 
class="cmbx-10">Hostname</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the name of the node where the process ran.
     </dd><dt class="description">
<span 
class="cmbx-10">PID</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the Unix process ID (PID) of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">State Scheduler</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />
     <!--l. 63--><p class="noindent" >This shows the Resource Manager state of the job. It is one of:
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Allocated</span> </dt><dd 
class="description">- The node is currently allocated for this job by the RM.
         </dd><dt class="description">
     <span 
class="cmbx-10">Deallocated</span> </dt><dd 
class="description">- The resource manager has deallocated the shares for the job on this node.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Scheduler or extraordinary status</span> </dt><dd 
class="description">                                                                            <br 
class="newline" /><a 
 id="likesection.3"></a>
     <!--l. 76--><p class="noindent" >This column provides a reason for the scheduler state, when the scheduler state is other than &#8220;Allocated&#8221;. These all
     have &#8220;hovers&#8221; that provide more information if it is available.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">AutonomousStop</span> </dt><dd 
class="description">- The process terminated unexpectedly of its own accord (&#8221;crashed&#8221;, or simply exited.)
         </dd><dt class="description">
     <span 
class="cmbx-10">Exception</span> </dt><dd 
class="description">- The process is terminated by the JD exception handler.
         </dd><dt class="description">
     <span 
class="cmbx-10">Failed</span> </dt><dd 
class="description">- The process is terminated by the Agent because the JP wrapper was able to detect and communicate
         a fatal condition (Exception) in the pipeline..
         </dd><dt class="description">
     <span 
class="cmbx-10">FailedInitialization</span> </dt><dd 
class="description">- The process is terminated because the UIMA initialization step failed.
         </dd><dt class="description">
     <span 
class="cmbx-10">Forced</span> </dt><dd 
class="description">- The node is preempted by RM for other work because of fair share.
         </dd><dt class="description">
     <span 
class="cmbx-10">JobCanceled</span> </dt><dd 
class="description">- The job was canceled by the user or a system administrator.
         </dd><dt class="description">
     <span 
class="cmbx-10">JobCompleted</span> </dt><dd 
class="description">- The process is canceled because of DUCC restart.
         </dd><dt class="description">
     <span 
class="cmbx-10">JobFailure</span> </dt><dd 
class="description">- The job failure limit is exceeded, causing the job to be canceled by the JD.
         </dd><dt class="description">
     <span 
class="cmbx-10">InitializationTimeout</span> </dt><dd 
class="description">- The UIMA initialization phase exceeded the configured timeout.
         </dd><dt class="description">
     <span 
class="cmbx-10">Killed</span> </dt><dd 
class="description">- The agent terminated the process for some reason. The &#8220;Reason Agent&#8221; field should have more details
         in this case.
         </dd><dt class="description">
     <span 
class="cmbx-10">Stopped</span> </dt><dd 
class="description">-  The  process  was  terminated  by  the  Agent  for  some  reason.  The  hover  should  contain  more
         information.
         </dd><dt class="description">
     <span 
class="cmbx-10">Voluntary</span> </dt><dd 
class="description">- The job is winding down, there&#8217;s no more work for this node, so it stops.
         </dd><dt class="description">
     <span 
class="cmbx-10">Unknown</span> </dt><dd 
class="description">- None of the above. This is an exceptional condition, sometimes an internal DUCC error. Check
         the JP and JD logs for possible causes..</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">State Agent</span> </dt><dd 
class="description">                                                                                                                   <br 
class="newline" /><a 
 id="likesection.4"></a>
     <!--l. 118--><p class="noindent" >This shows the DUCC Agent&#8217;s view of the state of the process.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Starting</span> </dt><dd 
class="description">The DUCC process manager as issued a request to the assigned to start the process.
         </dd><dt class="description">
     <span 
class="cmbx-10">Initializing</span> </dt><dd 
class="description">The  process  is  initializing.  Usually  this  means  the  UIMA  analytic  pipeline  (Job  Process)  is
         executing it&#8217;s initialization method.
         </dd><dt class="description">
     <span 
class="cmbx-10">Running</span> </dt><dd 
class="description">The Job Process has completed the initialization phase and is ready for, or actively executing work.
         </dd><dt class="description">
     <span 
class="cmbx-10">Stopped</span> </dt><dd 
class="description">The DUCC Agent reports the process is stopped and (and has exited).
         </dd><dt class="description">
     <span 
class="cmbx-10">Failed</span> </dt><dd 
class="description">The DUCC Agent reports the process failed with errors. This usually means that UIMA-AS has detected
         exceptions in the pipeline and reported them to the Job Driver for logging.
         </dd><dt class="description">
     <span 
class="cmbx-10">FailedInitialization</span> </dt><dd 
class="description">The process died during the UIMA initialization phase.
         </dd><dt class="description">
     <span 
class="cmbx-10">InitializationTimeout</span> </dt><dd 
class="description">The process exceeded the site&#8217;s limit for time spent in UIMA initialization.
         </dd><dt class="description">
     <span 
class="cmbx-10">Killed</span> </dt><dd 
class="description">The DUCC Agent killed the process for some reason. There are three rosins for this:
             <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
          1. </dt><dd 
class="enumerate-enumitem">The Job Processes failed to initialize,
             </dd><dt class="enumerate-enumitem">
          2. </dt><dd 
class="enumerate-enumitem">The Job Process timed out during initialization,
             </dd><dt class="enumerate-enumitem">
          3. </dt><dd 
class="enumerate-enumitem">The process Exocet&#8217;s its allowed swap.</dd></dl>
         </dd><dt class="description">
     <span 
class="cmbx-10">Abandoned</span> </dt><dd 
class="description">It is possible to cancel a specific process of a job. Usually this is because it became &#8220;stuck&#8221; because of
         hardware failure. It a process is killed in <a 
href="#x1-320003.6">this way</a>, the state is recoreded as <span 
class="cmti-10">Abandonded</span>.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Agent</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" /><a 
 id="likesection.5"></a>
     <!--l. 148--><p class="noindent" >This shows extended reason information if a process exited other than having run out of work to do.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">AgentTimedOutWatingForORState</span> </dt><dd 
class="description">The  DUCC  Agent  is  expecting  a  state  update  from  the  DUCC
         Orchestrator. Timer on this wait has expired. This usually indicates an infrastructure or communication
         problem.
         </dd><dt class="description">
     <span 
class="cmbx-10">Croaked</span> </dt><dd 
class="description">The process exited for no good or clear reason, it simply vanished.
         </dd><dt class="description">
     <span 
class="cmbx-10">Deallocated</span> </dt><dd 
class="description">WHAT IS THIS?
         </dd><dt class="description">
     <span 
class="cmbx-10">ExceededShareSize</span> </dt><dd 
class="description">The process exceeded it&#8217;s declared memory size.
         </dd><dt class="description">
     <span 
class="cmbx-10">ExceededSwapThreshold</span> </dt><dd 
class="description">The process exceeded the configured swap threshold.
                                                                                                
                                                                                                
         </dd><dt class="description">
     <span 
class="cmbx-10">FailedInitialization</span> </dt><dd 
class="description">The process was terminated because the UIMA initialization step failed.
         </dd><dt class="description">
     <span 
class="cmbx-10">InitializationTimeout</span> </dt><dd 
class="description">The process was terminated because the UIMA initialization step took too long.
         </dd><dt class="description">
     <span 
class="cmbx-10">JPHasNoActiveJob</span> </dt><dd 
class="description">This is set when an agent looses connectivity while its JPs are running. The job finishes
         (stopped or killed). The agent regains connectivity. The OR publish no longer includes the job but the agent
         still has processes running for that job. The agent kills ghost processes with the reason: JPHasNoActiveJob.
         </dd><dt class="description">
     <span 
class="cmbx-10">LowSwapSpace</span> </dt><dd 
class="description">The process was terminated because the system is about to run out of swap space. This is
         a preemptive measure taken by DUCC to avoid exhaustion of swap, to effect orderly eviction of the job
         before the operating system starts its own reaping procedures.
         </dd><dt class="description">
     <span 
class="cmbx-10">AdministratorInitiated</span> </dt><dd 
class="description">The process was canceled by an administrator.
         </dd><dt class="description">
     <span 
class="cmbx-10">UserInitated</span> </dt><dd 
class="description">The process was canceled by the owning user.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Time Init</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the clock time this process spent in initialization.
     </dd><dt class="description">
<span 
class="cmbx-10">Time Run</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the clock time this process spent in executing, not including initialization.
     </dd><dt class="description">
<span 
class="cmbx-10">Time GC</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is amount of time spent in Java Garbage Collection for the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Count GC</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the number of garbage collections performed by the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Pgin</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the number of page-in events on behalf of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Swap</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the amount of swap space on the machine being consumed by the process.
     </dd><dt class="description">
<span 
class="cmbx-10">%GC</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />Percentage of time spent in garbage collections by this process, relative to total of initialization + run
     times.
     </dd><dt class="description">
<span 
class="cmbx-10">%CPU</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />Currant CPU percent consumed by the process. This will be <span 
class="cmmi-10">&#x003E; </span>100% on multi-core systems if more than one core is
     being used. Each core contributes up to 100% CPU, so, for example, on a 16-core machine, this can be as high as
     1600%.
     </dd><dt class="description">
<span 
class="cmbx-10">RSS</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />The amount of real memory being consumed by the process (Resident Storage Size)
     </dd><dt class="description">
<span 
class="cmbx-10">Time Avg</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the average time in seconds spent per work item in the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Time max</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the minimum time in seconds spent per work item in the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Time min</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the minimum time in seconds spent per work item in the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Done</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the number of work items processed in this process.
     </dd><dt class="description">
<span 
class="cmbx-10">Error</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the number of exceptions processing work items in this process.
     </dd><dt class="description">
<span 
class="cmbx-10">Retry</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the number of work items that were retried in this process for any reason, excluding preemption.
     </dd><dt class="description">
<span 
class="cmbx-10">Preempt</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This is the number of work items that were preempted from this process, if fair-share caused preemption.
     </dd><dt class="description">
<span 
class="cmbx-10">JConsole URL</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />This is a URL that can be used to connect via JMX to the processes, e.g. via jconsole.
     </dd></dl>
<!--l. 237--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-140004r4"></a>
                                                                                                
                                                                                                

<!--l. 239--><p class="noindent" ><img 
src="images/ducc-webserver/Job-Details-Processes.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.4: </span><span  
class="content">Processes Tab</span></div><!--tex4ht:label?: x1-140004r4 -->
                                                                                                
                                                                                                
<!--l. 241--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">7.3.2   </span> <a 
 id="x1-1410007.3.2"></a>Work Items</h4>
<!--l. 245--><p class="noindent" >This tab provides details for each individual work item. Columns include:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">SeqNo</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />This is the sequence work items are fetched from the Collection Reader&#8217;s getNext() method by the DUCC Job
     Driver.
     </dd><dt class="description">
<span 
class="cmbx-10">Id</span> </dt><dd 
class="description">                                                                                                                                <br 
class="newline" />This is the name of the work item.
     </dd><dt class="description">
<span 
class="cmbx-10">Status</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />The is the current state of the work item. States include:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">ended</span> </dt><dd 
class="description">The work item is complete.
         </dd><dt class="description">
     <span 
class="cmbx-10">error</span> </dt><dd 
class="description">The work item ended with errors.
         </dd><dt class="description">
     <span 
class="cmbx-10">lost</span> </dt><dd 
class="description">The work item was queued to ActiveMQ but never dequeued by any Job Process.
         </dd><dt class="description">
     <span 
class="cmbx-10">operating</span> </dt><dd 
class="description">The work item is current being executed.
         </dd><dt class="description">
     <span 
class="cmbx-10">retry</span> </dt><dd 
class="description">The work item is being retried.
         </dd><dt class="description">
     <span 
class="cmbx-10">start</span> </dt><dd 
class="description">The work item has been picked up for execution and DUCC is waiting for confirmation that it is running.
         </dd><dt class="description">
     <span 
class="cmbx-10">queued</span> </dt><dd 
class="description">The work item has been queued to ActiveMQ but not picked up by any Job Process yet.</dd></dl>
     <!--l. 269--><p class="noindent" >If a work item has not yet been retrieved from the Collect Reader it does not show on this page.
     </dd><dt class="description">
<span 
class="cmbx-10">Queuing Time (sec)</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />The time spent in ActiveMQ after being queued, and before being picked up by a Job Process.
     </dd><dt class="description">
<span 
class="cmbx-10">Processing Time (sec)</span> </dt><dd 
class="description">                                                                                                      <br 
class="newline" />The time spent processing the work item.
     </dd><dt class="description">
<span 
class="cmbx-10">Node (IP)</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />The node IP where the work item was processed.
     </dd><dt class="description">
<span 
class="cmbx-10">Node (Name</span> </dt><dd 
class="description">                                                                                                                  <br 
class="newline" />The node name where the work item was processed.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">PID</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />The Unix Process Id that the work item was processed in.</dd></dl>
<!--l. 284--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-141001r5"></a>
                                                                                                
                                                                                                

<!--l. 286--><p class="noindent" ><img 
src="images/ducc-webserver/Job-Details-WorkItems.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.5: </span><span  
class="content">Work Items Tab</span></div><!--tex4ht:label?: x1-141001r5 -->
                                                                                                
                                                                                                
<!--l. 288--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">7.3.3   </span> <a 
 id="x1-1420007.3.3"></a>Performance</h4>
<!--l. 292--><p class="noindent" >This tab shows performance summaries of all the pipeline components. The statistics are aggregated over all instances of each
component in each process of the job.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Name</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />The short name of the analytic. The full name is shown in the command-line tool <span 
class="cmbx-10">??</span>
     </dd><dt class="description">
<span 
class="cmbx-10">Total</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the total time in days, hours, minutes, and seconds taken by each component of the pipeline.
     </dd><dt class="description">
<span 
class="cmbx-10">% of Total</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the percent of the total usage consumed by this analytic.
     </dd><dt class="description">
<span 
class="cmbx-10">Avg</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the average time spent by all the instances of the analytic.
     </dd><dt class="description">
<span 
class="cmbx-10">Min</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the minimum time spent by any instance of the analytic.
     </dd><dt class="description">
<span 
class="cmbx-10">Max</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the maximum time spent by any instance of the analytic.</dd></dl>
<!--l. 312--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-142001r6"></a>
                                                                                                
                                                                                                

<!--l. 314--><p class="noindent" ><img 
src="images/ducc-webserver/Job-Details-Performance.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.6: </span><span  
class="content">Performance Tab</span></div><!--tex4ht:label?: x1-142001r6 -->
                                                                                                
                                                                                                
<!--l. 316--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">7.3.4   </span> <a 
 id="x1-1430007.3.4"></a>Specification</h4>
<!--l. 319--><p class="noindent" >This tab shows the full job specification in the form of a Java Properties file. This will include all the parameters specified by
the user, plus those filled in by DUCC.
<!--l. 323--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-143001r7"></a>
                                                                                                
                                                                                                

<!--l. 325--><p class="noindent" ><img 
src="images/ducc-webserver/Job-Details-Specification.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.7: </span><span  
class="content">Specification Tab</span></div><!--tex4ht:label?: x1-143001r7 -->
                                                                                                
                                                                                                
<!--l. 327--><p class="noindent" ></div><hr class="endfigure">
<!--l. 188--><p class="noindent" ><a name='DUCC_WS_RESERVATIONS'></a>
<h3 class="sectionHead"><span class="titlemark">7.4   </span> <a 
 id="x1-1440007.4"></a>Reservation Page</h3>
<!--l. 23--><p class="noindent" >This page shows details of all reservations. There are two types of reservations: <span 
class="cmti-10">managed </span>and <span 
class="cmti-10">unmanaged.</span>.
<!--l. 26--><p class="noindent" >A <span 
class="cmti-10">managed reservation </span>is a reservation whose process is fully managed by DUCC. This process is any arbitrary process and is
submitted with the <a 
href="#x1-470003.9">ducc_process_submit</a> CLI. The lifetime of the reservation starts at the time DUCC assigns a unique ID,
and ends when the process terminates for any reason.
<!--l. 31--><p class="noindent" >An <span 
class="cmti-10">unmanaged reservation </span>is essentially a sandbox for the user. DUCC starts no processes in the reservation and manages
none of the processes which run on that node. The lifetime of the reservation starts at the time DUCC assigns a unique ID,
and ends when the submitter or system administrator cancels it. <span 
class="cmti-10">Managed reservations </span>can potentially last an indefinite
period of time.
<!--l. 37--><p class="noindent" >The Reservations page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Id</span> </dt><dd 
class="description">                                                                                                                                <br 
class="newline" />This is the unique DUCC numeric id of the reservation as assigned when the reservation is made. If this is a
     <span 
class="cmti-10">managed </span>reservation, the ID is hyperlinked to a <a 
href="#x1-1450007.5">Managed Reservation Details</a> page with extended details on
     the process running in the reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">Start</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the time the reservation was mode.
     </dd><dt class="description">
<span 
class="cmbx-10">End</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the time the reservation was canceled or otherwise ended.
     </dd><dt class="description">
<span 
class="cmbx-10">User</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the userid if the person who made the reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">Class</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the scheduling class used to schedule the reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">Type</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the reservation type, <span 
class="cmti-10">managed </span>or <span 
class="cmti-10">unmanaged</span>, as described <a 
href="#x1-1440007.4">above</a>.
     </dd><dt class="description">
<span 
class="cmbx-10">State</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the status of the reservation. Values include: Received - Reservation has been vetted, persisted, and assigned
     unique Id.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Assigned</span> </dt><dd 
class="description">- The reservation is active.
         </dd><dt class="description">
     <span 
class="cmbx-10">Completed</span> </dt><dd 
class="description">- The reservation has been terminated.
         </dd><dt class="description">
     <span 
class="cmbx-10">Received</span> </dt><dd 
class="description">- The Reservation has been vetted, persisted, and assigned a unique ID.
         </dd><dt class="description">
     <span 
class="cmbx-10">WaitingForResources</span> </dt><dd 
class="description">- The reservation is waiting for the Resource Manager to find and schedule resources.</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Reason</span> </dt><dd 
class="description">                                                                                                                         <br 
class="newline" />
     <!--l. 78--><p class="noindent" >If a reservation is not active, this shows the reason. Note that for <span 
class="cmti-10">unmanaged reservations</span>, even if the user has
     processes running in the reservation, DUCC does NOT attempt to terminate those processes (hence,
     &#8220;unmanaged&#8221;.)
     <!--l. 82--><p class="noindent" >For <span 
class="cmti-10">managed reservations</span>, DUCC does terminate the associated process.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">CanceledBySystem</span> </dt><dd 
class="description">-  In  the  case  of  the  special  JobDriver  reservation,  this  is  canceled  by  DUCC  and
         reestablished on reboot; hence the state is a result of DUCC having been restarted.
         <!--l. 89--><p class="noindent" >In all other cases, it is a result of DUCC being restarted <span 
class="cmti-10">COLD</span>. When DUCC is started <span 
class="cmti-10">COLD</span>, all
         previous reservations are canceled. (When DUCC is started <span 
class="cmti-10">WARM</span>, the default, previous reservations are
         preserved.)
         </dd><dt class="description">
     <span 
class="cmbx-10">CanceledByAdmin</span> </dt><dd 
class="description">- The DUCC administrator released the reservation.
         </dd><dt class="description">
     <span 
class="cmbx-10">CanceledByUser</span> </dt><dd 
class="description">- The reservation owner released the reservation.
         </dd><dt class="description">
     <span 
class="cmbx-10">ResourcesUnavailable</span> </dt><dd 
class="description">- The Resource Manager was unable to find free or freeable resources match the
         resource request.
         </dd><dt class="description">
     <span 
class="cmbx-10">ProgramExit</span> </dt><dd 
class="description">- The reservation is a <span 
class="cmti-10">managed </span>reservation and the associated process has exited.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Allocation</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the number of resources (shares for FIXED policy reservations, processes for RESERVE policy reservations)
     that are allocated.
     </dd><dt class="description">
<span 
class="cmbx-10">UserProcesses</span> </dt><dd 
class="description">This is the number of processes owned by the user running in all shares of the reservation.
     <!--l. 107--><p class="noindent" >Note that even for <span 
class="cmti-10">unmanaged </span>reservations, the DUCC agent tracks processes owned by the user and reports on them.
     This allows better identification and management of abandoned reservations.
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />The memory size in GB of the each allocated unit. This is the amount of memory that was <span 
class="cmti-10">requested</span>. In the case of
     RESERVE policy reservations, that actual memory of the reserved machine may be greater.
     </dd><dt class="description">
<span 
class="cmbx-10">Host Names</span> </dt><dd 
class="description">                                                                                                                   <br 
class="newline" />The node names of the machines where the resources are allocated.
     </dd><dt class="description">
<span 
class="cmbx-10">Description</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This is the description string from the &#8211;description string from submit.</dd></dl>
<!--l. 123--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-144001r8"></a>
                                                                                                
                                                                                                

<!--l. 125--><p class="noindent" ><img 
src="images/ducc-webserver/Reservations.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.8: </span><span  
class="content">Reservations Page</span></div><!--tex4ht:label?: x1-144001r8 -->
                                                                                                
                                                                                                
<!--l. 127--><p class="noindent" ></div><hr class="endfigure">
<!--l. 195--><p class="noindent" ><a name='DUCC_WS_RESERVATIONS_DETAILS'></a>
<h3 class="sectionHead"><span class="titlemark">7.5   </span> <a 
 id="x1-1450007.5"></a>Managed Reservation Details Page</h3>
<!--l. 22--><p class="noindent" >This page shows details of the processes which run in a managed reservation. The information is divided between two
tabs:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Processes</span> </dt><dd 
class="description">This tab contains details on all the proceses contained in the reserved space.
     </dd><dt class="description">
<span 
class="cmbx-10">Specification</span> </dt><dd 
class="description">This tab shows the specification for the process.</dd></dl>
<!--l. 31--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.5.1   </span> <a 
 id="x1-1460007.5.1"></a>Processes</h4>
<!--l. 34--><p class="noindent" >The processes page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ID</span> </dt><dd 
class="description">                                                                                                                               <br 
class="newline" />This is the DUCC-assigned numeric id of the process. This format of this id is two numbers:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-82">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;RESID.SHAREID</div>
     <!--l. 41--><p class="nopar" > Here, the <span 
class="cmti-10">RESID </span>is the reservation ID. The <span 
class="cmti-10">SHAREID </span>is the share ID assigned by the Resource Manager. Together
     these form a unique ID for each process that runs in the reservation.
     <!--l. 46--><p class="noindent" >Note: The current version of DUCC supports only one process per managed reservation. Future versions are expected
     to support multiple processes within a single managed reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">Log</span> </dt><dd 
class="description">                                                                                                                              <br 
class="newline" />This is the log name for the process. It is hyperlinked to the log itself.
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the size of the log in MB. If you find you have trouble viewing the log from the web server it could be because it
     is too big to view in the browser.
     </dd><dt class="description">
<span 
class="cmbx-10">Hostname</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the name of the node where the process is running (or ran).
     </dd><dt class="description">
<span 
class="cmbx-10">PID</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the Unix process ID (PID) of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">State Scheduler</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />This shows the Resesource Manager state of the job. It is one of:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Allocated</span> </dt><dd 
class="description">- The node is still allocated for this job by the RM.
         </dd><dt class="description">
     <span 
class="cmbx-10">Deallocated</span> </dt><dd 
class="description">- The resource manager has deallocated the shares for the job on this node.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Scheduler or Extraordinary Status</span> </dt><dd 
class="description">                                                                           <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">State Agent</span> </dt><dd 
class="description">                                                                                                                   <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Agent</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">Time Run</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />The current duration of the reservation, or total duration if it has terminated.
     </dd><dt class="description">
<span 
class="cmbx-10">RSS</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />The amount of real memory being consumed by the process (Resident Storage Size)
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 90--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.5.2   </span> <a 
 id="x1-1470007.5.2"></a>Specification</h4>
<!--l. 92--><p class="noindent" >This tab shows the full job specification in the form of a Java Properties file. This will include all the parameters specified by
the user, plus those filled in by DUCC.
<!--l. 202--><p class="noindent" ><a name='DUCC_WS_SERVICES'></a>
<!--l. 20--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7.6   </span> <a 
 id="x1-1480007.6"></a>Services Page</h3>
<!--l. 22--><p class="noindent" >This page shows details of all services.
<!--l. 24--><p class="noindent" >The Services page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Id</span> </dt><dd 
class="description">                                                                                                                                <br 
class="newline" />This is the unique numeric DUCC id of the service. This ID is hyperlinked to a <a 
href="#x1-1490007.7">Service Details</a> page with
     extended details on the service. Note that for some types of services, DUCC may not know more about the
     service than is shown on the main page.
     </dd><dt class="description">
<span 
class="cmbx-10">Name</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the unique service endpoint of the service.
     </dd><dt class="description">
<span 
class="cmbx-10">Type</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the service type, which is one of
         <ul class="itemize1">
         <li class="itemize">Registered
         </li>
         <li class="itemize">Ping-Only</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">State</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the state of the service with respect to the service manager. It is a consolidated state over all the service
     instances. Valid states are
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Available</span> </dt><dd 
class="description">At least one service instance is responding to the service pinger, indicating it is functional.
         </dd><dt class="description">
     <span 
class="cmbx-10">Initializing</span> </dt><dd 
class="description">No service instances are available for use yet but at least one instance is in its UIMA <span 
class="cmti-10">initializing</span>
         phase.
         </dd><dt class="description">
     <span 
class="cmbx-10">Waiting</span> </dt><dd 
class="description">At least one service instance is in Running state, potentially available for use, but no response has
         been received from the service pinger. This usually occurs during the start-up of a service. If a service
         stops responding to its pinger after becoming available, the state can regress to Waiting.
         </dd><dt class="description">
     <span 
class="cmbx-10">NotAvailable</span> </dt><dd 
class="description">No service instance is running or initializing.
         </dd><dt class="description">
     <span 
class="cmbx-10">Stopping</span> </dt><dd 
class="description">The service has been stopped for some reason, but not all instances have terminated. This is an
         intermediate state between Available and NotAvailable to signify that the service is no longer available
         but not all its resources have been returned yet.</dd></dl>
                                                                                                
                                                                                                
     <!--l. 62--><p class="noindent" >DUCC will start dependent jobs ONLY if it&#8217;s services are in state Available. Otherwise DUCC attempts to start the
     service, and if successful, allows the job to start.
     <!--l. 65--><p class="noindent" >If a job is already running and a service becomes other than Available, the <a 
href="#x1-1380007.2">jobs page</a> indicates the service is not
     available but the job is allowed to continue.
     </dd><dt class="description">
<span 
class="cmbx-10">Pinger</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />This indicates whether the Service Manager is running a pinger for the service. This column does not imply the ping is
     successful; see the &#8220;health&#8221; column for ping status.
     </dd><dt class="description">
<span 
class="cmbx-10">Health</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" /><span 
class="cmti-10">Health </span>is a status returned by each pinger and is the result of that pinger&#8217;s evaluation of the state of the service. It is
     shown as on of
         <ul class="itemize1">
         <li class="itemize"><span 
class="cmti-10">Good</span>
         </li>
         <li class="itemize"><span 
class="cmti-10">Poor</span></li></ul>
     <!--l. 80--><p class="noindent" >Both terms are highly subjective. Pingers may return a summary of the underlying data used to label a service as good
     or bad. That status is shown as a hover over this field.
     </dd><dt class="description">
<span 
class="cmbx-10">Instances</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is the number of instances (processes) currently registered for the service.
     </dd><dt class="description">
<span 
class="cmbx-10">Deployments</span> </dt><dd 
class="description">                                                                                                                  <br 
class="newline" />This is the number of actual instances deployed for the service. Note that this may be greater, or less, than
     the number of registered instances, if the service owner decides to temporarily start or stop additional
     instances.
     </dd><dt class="description">
<span 
class="cmbx-10">User</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the userid of the service owner.
     </dd><dt class="description">
<span 
class="cmbx-10">Class</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the scheduling class the service is running in.
     <!--l. 98--><p class="noindent" >If a service is registered as &#8220;ping-only&#8221;, no resources are allocated for it. This is shown as a class of
     <span 
class="cmtt-10">ping-only</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the memory size, in GB, of each service instance
     </dd><dt class="description">
<span 
class="cmbx-10">Jobs</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the number of jobs currently using the service. The IDs of the jobs are shown as hovers over this
     field.
     </dd><dt class="description">
<span 
class="cmbx-10">Services</span> </dt><dd 
class="description">                                                                                                                        <br 
class="newline" />Services may themselves depend on other services. This field shows the number of services dependent on this service.
     The dependent service IDs are shown with a hover over the field.
     </dd><dt class="description">
<span 
class="cmbx-10">Reservations</span> </dt><dd 
class="description">                                                                                                                  <br 
class="newline" />This field shows the number of managed reservations dependent on this service. The IDs of the managed reservations
                                                                                                
                                                                                                
     are shown as a hover over the field.
     </dd><dt class="description">
<span 
class="cmbx-10">Description</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This is the description string from the &#8211;description string from submit.</dd></dl>
<!--l. 209--><p class="noindent" ><a name='DUCC_WS_SERVICE_DETAILS'></a>
<h3 class="sectionHead"><span class="titlemark">7.7   </span> <a 
 id="x1-1490007.7"></a>Service Details Page</h3>
<!--l. 22--><p class="noindent" >This page shows details of the processes which implement.
<!--l. 24--><p class="noindent" >The information is divided between two tabs:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Processes</span> </dt><dd 
class="description">This tab contains details on all the proceses implementing the service, if any.
     </dd><dt class="description">
<span 
class="cmbx-10">Specification</span> </dt><dd 
class="description">This tab shows the specification for the service.</dd></dl>
<!--l. 32--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.7.1   </span> <a 
 id="x1-1500007.7.1"></a>Processes</h4>
<!--l. 35--><p class="noindent" >The processes page contains the following columns:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ID</span> </dt><dd 
class="description">                                                                                                                               <br 
class="newline" />This is the DUCC-assigned numeric id of the process. This format of this id is two numbers:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-83">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;RESID.SHAREID</div>
     <!--l. 42--><p class="nopar" > Here, the <span 
class="cmti-10">RESID </span>is the reservation ID. The <span 
class="cmti-10">SHAREID </span>is the share ID assigned by the Resource Manager. Together
     these form a unique ID for each process that runs in the reservation.
     </dd><dt class="description">
<span 
class="cmbx-10">Log</span> </dt><dd 
class="description">                                                                                                                              <br 
class="newline" />This is the log name for the process. It is hyperlinked to the log itself.
     </dd><dt class="description">
<span 
class="cmbx-10">Size</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the size of the log in MB. If you find you have trouble viewing the log from the web server it could be because it
     is too big to view in the browser.
     </dd><dt class="description">
<span 
class="cmbx-10">Hostname</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />This is the name of the node where the process is running (or ran).
     </dd><dt class="description">
<span 
class="cmbx-10">PID</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the Unix process ID (PID) of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">State Scheduler</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />This shows the Resesource Manager state of the job. It is one of:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Allocated</span> </dt><dd 
class="description">- The node is still allocated for this job by the RM.
         </dd><dt class="description">
     <span 
class="cmbx-10">Deallocated</span> </dt><dd 
class="description">- The resource manager has deallocated the shares for the job on this node.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Scheduler or Extraordinary Status</span> </dt><dd 
class="description">                                                                           <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">State Agent</span> </dt><dd 
class="description">                                                                                                                   <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">Reason Agent</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />These are the same as for the <a 
href="#x1-1400007.3.1">job details.</a>
     </dd><dt class="description">
<span 
class="cmbx-10">Time Init</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />Most services are UIMA-AS services and therefore have an <span 
class="cmti-10">initialization </span>phase to their lifetimes. This field shows the
     time spent in that phase.
     </dd><dt class="description">
<span 
class="cmbx-10">Time Run</span> </dt><dd 
class="description">                                                                                                                     <br 
class="newline" />The current duration of the reservation, or total duration if it has terminated.
     </dd><dt class="description">
<span 
class="cmbx-10">Time GC</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This is amount of time spent in Java Garbage Collection for the process.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Pgin</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the number of page-in events on behalf of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Swap</span> </dt><dd 
class="description">                                                                                                                            <br 
class="newline" />This is the amount of swap space on the machine being consumed by the process.
     </dd><dt class="description">
<span 
class="cmbx-10">%CPU</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />Currnt CPU percent consumed by the process. This will be <span 
class="cmmi-10">&#x003E; </span>100% on multi-core systems if more than one core is
     being used. Each core contributes up to 100% CPU, so, for example, on a 16-core machine, this can be as high as
     1600%.
     </dd><dt class="description">
<span 
class="cmbx-10">RSS</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />The amount of real memory being consumed by the process (Resident Storage Size)
     </dd><dt class="description">
<span 
class="cmbx-10">JConsole URL</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />This is a URL that can be used to connect via JMX to the processes, e.g. via jconsole.
     </dd></dl>
<!--l. 111--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.7.2   </span> <a 
 id="x1-1510007.7.2"></a>Specification</h4>
<!--l. 113--><p class="noindent" >This tab shows the full job specification in the form of a Java Properties file. This will include all the parameters specified by
the user, plus those filled in by DUCC.
<!--l. 117--><p class="noindent" >The specification for a Service contains two types of entries:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Service specification properties, prefixed with &#8220;svc&#8221;. These comprise the service specification that the Service
     Manager submits on behalf of a user in order to start registered services.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Meta properties, prefixed with &#8220;meta&#8221;. This is the Service Manager&#8217;s state record for the sesrvice as it is
     running. In addition to state it contains properties required for service registration that are not used for service
     submission.</dd></dl>
<!--l. 216--><p class="noindent" ><a name='DUCC_WS_SYSTEM'></a>
<!--l. 20--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7.8   </span> <a 
 id="x1-1520007.8"></a>System Details Page</h3>
<!--l. 23--><p class="noindent" >This page shows information relating to the DUCC System itself:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Administration</span> </dt><dd 
class="description">This  displays  system  administrators  and  implements  the  interface  to  various  administrative
     controls.
     </dd><dt class="description">
<span 
class="cmbx-10">Classes</span> </dt><dd 
class="description">This shows the current system&#8217;s scheduling class definitions.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Daemons</span> </dt><dd 
class="description">This shows the status of all DUCC processes.
     </dd><dt class="description">
<span 
class="cmbx-10">DuccBook</span> </dt><dd 
class="description">This is a link to the book you are reading.
     </dd><dt class="description">
<span 
class="cmbx-10">Machines</span> </dt><dd 
class="description">This shows details of all the machines in the DUCC cluster.</dd></dl>
<!--l. 33--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.8.1   </span> <a 
 id="x1-1530007.8.1"></a>Administration</h4>
<!--l. 35--><p class="noindent" >This page has two tabs:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Administrators</span> </dt><dd 
class="description">This shows the user-ids that are authorized to administer DUCC. In addition to executing the
     &#8220;Control&#8221; functions described below, administrators may cancel any job, reservation, or service, and may modify
     services they do not own.
     <!--l. 42--><p class="noindent" >In order to perform administrative functions, the following must be satisfied:
         <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
       1. </dt><dd 
class="enumerate-enumitem">The user is logged-in to the web server.
         </dd><dt class="enumerate-enumitem">
       2. </dt><dd 
class="enumerate-enumitem">The user is a registered administrator.
         </dd><dt class="enumerate-enumitem">
       3. </dt><dd 
class="enumerate-enumitem">The user has set the role as &#8220;administrator&#8221; in the DUCC Preferences page. This is a safeguard so that
         administrators who are also users are less likely to inadvertently affect other people&#8217;s jobs.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">Control</span> </dt><dd 
class="description">Currently DUCC supports a single administrative control function via the web server: Stop new job submissions
     and re-enable them. If submissions are blocked, all existing work runs normally, but no new work is
     accepted.</dd></dl>
<!--l. 56--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.8.2   </span> <a 
 id="x1-1540007.8.2"></a>Classes</h4>
<!--l. 57--><p class="noindent" >This page shows the definitions of the DUCC scheduling classes. The scheduling classes are discussed in more detail in the
<a 
href="#x1-28400013.7">Resource Manager</a> section.
<!--l. 60--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.8.3   </span> <a 
 id="x1-1550007.8.3"></a>Daemons</h4>
<!--l. 63--><p class="noindent" >This page shows the current state of all DUCC processes. By default, only the administrative processes, Orchestrator,
ProcessManager, ResourceManager, ServiceManager, and Webserver are shown. A button in the upper left of the page titled
&#8220;Show Agents&#8221; enables display of the status of all the DUCC agents as well. (Agents are suppressed by default because the
page is expensive to render for large systems.)
<!--l. 69--><p class="noindent" >The columns shown on this page include
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Status</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />This indicates whether the daemon is running and broadcasting state <span 
class="cmti-10">up</span>, or not <span 
class="cmti-10">down</span>.
     <!--l. 76--><p class="noindent" >All DUCC daemons broadcast a heartbeat containing process state. If the Status is <span 
class="cmti-10">down</span>, either the daemon is
     not functioning, or something is preventing state from reaching the web server via DUCC&#8217;s ActiveMQ instance.
     </dd><dt class="description">
<span 
class="cmbx-10">Daemon Name</span> </dt><dd 
class="description">                                                                                                               <br 
class="newline" />This is the name of the process.
     </dd><dt class="description">
<span 
class="cmbx-10">Boot Time</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This shows the date and time of the latest boot of the specific process.
     </dd><dt class="description">
<span 
class="cmbx-10">Host IP</span> </dt><dd 
class="description">                                                                                                                        <br 
class="newline" />This is the IP address of the processor where the process is running.
     </dd><dt class="description">
<span 
class="cmbx-10">Host Name</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This shows the hostname of the processor where the process is running.
     </dd><dt class="description">
<span 
class="cmbx-10">PID</span> </dt><dd 
class="description">                                                                                                                             <br 
class="newline" />This is the Unix processid of the DUCC process.
     </dd><dt class="description">
<span 
class="cmbx-10">Publication Size (last)</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />This shows the size of the most recent state publication of the process, in bytes.
     </dd><dt class="description">
<span 
class="cmbx-10">Publication Size (max)</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />This shows the size of the largest state publication of the process, in bytes.
     </dd><dt class="description">
<span 
class="cmbx-10">Heartbeat (last)</span> </dt><dd 
class="description">                                                                                                             <br 
class="newline" />This shows the number of seconds since the last state publication for the process. Large numbers here indicate
     potential cluster or DUCC problems.
     </dd><dt class="description">
<span 
class="cmbx-10">Heartbeat (max)</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This shows the longest delay since a state publication for the process was received at the web server. Large
     numbers here indicate potential cluster or DUCC problems.
     </dd><dt class="description">
<span 
class="cmbx-10">Heartbeat (max) TOD</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />This shows the time the longest delay of a state publication occurred.
     </dd><dt class="description">
<span 
class="cmbx-10">JConsole URL</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />This is the jconsole URL for the process.
     </dd></dl>
<!--l. 118--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">7.8.4   </span> <a 
 id="x1-1560007.8.4"></a>Machines</h4>
<!--l. 120--><p class="noindent" >This page shows the states of all the machines in the DUCC cluster.
                                                                                                
                                                                                                
<!--l. 122--><p class="noindent" >The columns shown on this page include
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Status</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />This shows the current state of a machine. Values include:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">defined</span> </dt><dd 
class="description">The node is in the DUCC <a 
href="#x1-23400012.7">nodes file</a>, but no DUCC process has been started there, or else there is a
         communication problem and the state messages are not being delivered.
         </dd><dt class="description">
     <span 
class="cmbx-10">up</span> </dt><dd 
class="description">The node has a DUCC Agent process running on it and the web server is receiving regular heartbeat
         packets from it.
         </dd><dt class="description">
     <span 
class="cmbx-10">down</span> </dt><dd 
class="description">The node had a healthy DUCC Agent on it at some point in the past (since the last DUCC boot), but
         the web server has stopped receiving heartbeats from it.
         <!--l. 138--><p class="noindent" >The agent may have been manually shut down, may have crashed, or there may be a communication
         problem.
         <!--l. 141--><p class="noindent" >Additionally, very heavy loads from jobs running the the node can cause the DUCC Agents heartbeats to
         be delayed.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">IP</span> </dt><dd 
class="description">                                                                                                                               <br 
class="newline" />This is the IP address of the node.
     </dd><dt class="description">
<span 
class="cmbx-10">Name</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />This is the hostname of the node.
     </dd><dt class="description">
<span 
class="cmbx-10">Reserve(GB) size</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This is the largest reservation that can be made on this node.
     <!--l. 155--><p class="noindent" >This is usually somewhat less than the physical memory size because it is rounded down to the nearest
     <a 
href="#x1-27500013">share quantum</a>. The purpose of this column is to assist users in requesting the right size for full machine
     reservations.
     </dd><dt class="description">
<span 
class="cmbx-10">Memory(GB) total</span> </dt><dd 
class="description">                                                                                                          <br 
class="newline" />This is the amount of memory, in GB, as reported by each machine.
     <!--l. 163--><p class="noindent" >Usually the amount will be slightly less than the installed memory. This is because a small bit of memory is usually
     reserved by the hardware for its own purposes. For example, a machine with 48GB of installed memory may report only
     47GB available.
     </dd><dt class="description">
<span 
class="cmbx-10">Swap(GB) in use</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This is the total size in-use swap data. DUCC shows any value greater than 0 in red as swapping can very significantly
     slow applications. However, swap use does not always mean there is a performance problem. This is flagged by DUCC
     simply as an alert of a potential problem
     </dd><dt class="description">
<span 
class="cmbx-10">Alien PIDs</span> </dt><dd 
class="description">                                                                                                                    <br 
class="newline" />This shows the number of processes not owned by DUCC, the operating system, or jobs scheduled on each node. The
     Unix Process IDS of these processes is displayed in a hover.
     <!--l. 178--><p class="noindent" >DUCC preconfigures many of the standard operating <a 
href="#x1-22000012.4.7">system process</a> and <a 
href="#x1-22000012.4.7">userids</a>. This list may be updated by each
     installation.
                                                                                                
                                                                                                
     <!--l. 183--><p class="noindent" >A common cause of alien PIDs is errant process run in unmanaged reservations. A user may reserve a machine for use
     as a sandbox. If the reservation is released without properly terminating all the processes, they may linger. When ducc
     schedules the node for other purposes, significant performance penalties may be paid due to competition between the
     legitimately scheduled work and the leftover &#8220;alien&#8221; processes. The purpose of this column is to bring attention to this
     situation.
     </dd><dt class="description">
<span 
class="cmbx-10">Shares (total)</span> </dt><dd 
class="description">                                                                                                                 <br 
class="newline" />This shows the total number of scheduling share supported on this node.
     </dd><dt class="description">
<span 
class="cmbx-10">Shares(in use)</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />This shows the total number of scheduling share in use on the node.
     </dd><dt class="description">
<span 
class="cmbx-10">Heartbeat(last)</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />This shows the number of seconds since the last agent heartbeat from this machine.
     </dd></dl>
<!--l. 223--><p class="noindent" ><a name='DUCC_WS_Viz'></a>
<!--l. 20--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">7.9   </span> <a 
 id="x1-1570007.9"></a>Visualization</h3>
<!--l. 22--><p class="noindent" >This page shows a visualization of all scheduled work. Every host is represented by a square whose area is proportional to the
amount of memory on the host. If work is scheduled to a host, it is represented by a rectangle whose area is proportional to
the amount of memory that is scheduled for the work. In a multi-user environment, each userid is mapped into a different
color, making it possible to see the usage per-user.
<!--l. 28--><p class="noindent" >Hovers are provided to show the real memory size of each host, the schedulable memory for each host, and the amount of
memory scheduled for each bit of work.
<!--l. 31--><p class="noindent" >If multiple allocations are made on a single host for the same job or service, the rectangles are combined into a single
rectangle, reducing clutter and better showing the actual usage of the job (or service).
<!--l. 35--><p class="noindent" >Clicking on any box representing scheduled work sends the browser to the details page for the corresponding
work.
<!--l. 38--><p class="noindent" >The screenshot below shows a visualization with a handful of 127GB hosts, 48GB hosts, and 32GB hosts. Regular UIMA-AS
jobs show as untextured boxes; for example, job 6080, owned by user Hilaria, running in a 37GB allocation in host
bluej291-41 which is a 127GB host.
<!--l. 42--><p class="noindent" >Hosts bluej291-45 and 291-46 are running Managed Reservations, which are shown with crosshatches from lower-left to upper
right.
<!--l. 45--><p class="noindent" >Hosts bluej291-37 and bluej291-40 are running Unmanaged Reservations, shown with vertical-horizontal crosshatches.
<!--l. 48--><p class="noindent" >Below bluej291-34, bluej291-36, bluej293-49, and bluej293-60 are running DUCC-managed services, shown by crosshatching
from upper-left to lower-right.
<!--l. 51--><p class="noindent" >The host representations may be sorted by clicking on the &#8220;size&#8221; or the &#8220;name&#8221; text near the top of the display.
<!--l. 55--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-157001r9"></a>
                                                                                                
                                                                                                

<!--l. 57--><p class="noindent" ><img 
src="images/ducc-webserver/viz.jpg" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;7.9: </span><span  
class="content">Visualization</span></div><!--tex4ht:label?: x1-157001r9 -->
                                                                                                
                                                                                                
<!--l. 59--><p class="noindent" ></div><hr class="endfigure">
                                                                                                
                                                                                                
<!--l. 86--><p class="noindent" >
                                                                                                
                                                                                                
<h1 class="partHead"><span class="titlemark">Part&#x00A0;III<br /></span><a 
 id="x1-158000III"></a>Programming Model And Applications</h1>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;8</span><br /><a 
 id="x1-1590008"></a>Building and Testing Jobs</h2>
<h3 class="sectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-1600008.1"></a>Overview</h3>
<!--l. 23--><p class="noindent" >A DUCC job consists of two process types, a Job Driver process and one or more Job Processes. These processes are
connected together via UIMA-AS. The Job Driver process wraps the job&#8217;s Collection Reader (CR). The CR function is to
define the collection of Work Items to be processed. The Collection Reader returns a small CAS for each Work Item
containing a reference to the Work Item data The Job Driver uses the UIMA-AS client API to send Work Item CASes to the
job&#8217;s input queue. Job Processes containing the analytic pipeline are deployed as UIMA-AS services and comsume CASes
from the job input queue.
<!--l. 33--><p class="noindent" >A basic job&#8217;s analytic pipeline consists of an Aggregate Analysis Engine comprised by the user specified CAS Multiplier
(CM), Analysis Engine (AE) and CAS Consumer (CC) components, along with a built-in DUCC Flow Controller. The Work
Item CAS is typically sent only to the CM and returned by the Job Process when all child CASes produced by the CM have
completed processing; optionally the CR can configure Work Item CAS flow to go to the CC or to the AE &amp; CC to complete
all processing for that Work Item.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">Although the Job Driver will receive back the Work Item CAS, there is no provision for any user code to
     receive the CAS. Therefore a Job Process typically adds no results to a Work Item CAS.</dd></dl>
<!--l. 47--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.1.1   </span> <a 
 id="x1-1610008.1.1"></a>Basic Job Process Threading Model</h4>
<!--l. 48--><p class="noindent" >In addition to the pipeline definition of explicitly named CM, AE and CC components, the job specification also includes the
number of pipeline threads to run in each Job Process (using the job specification parameter: process_thread_count). Each
pipeline thread receives Work Items independently.
<!--l. 53--><p class="noindent" >DUCC creates an aggreate descriptor for the pipeline, and then creates a Deployment Descriptor for the Job Process which
specifying the number of synchronous pipelines.
<!--l. 57--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.1.2   </span> <a 
 id="x1-1620008.1.2"></a>Alternate Pipeline Threading Model</h4>
<!--l. 58--><p class="noindent" >Alternately a Job Process can be fully specified by a user submitted UIMA-AS Deployment Descriptor. Thus any UIMA-AS
service deployment can be used as a Job Process. Here the parameter process_thread_count just defines how many Work
Items CASes will be sent to each Job Process concurrently.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">In general a UIMA-AS service may be configured to return child CASes; although child CASes returned from
     a Job Process will be ignored by the Job Driver, there may be significant overhead in wasted serialization and
     I/O.</dd></dl>
<!--l. 70--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.1.3   </span> <a 
 id="x1-1630008.1.3"></a>Overriding UIMA Configuration Parameters</h4>
                                                                                                
                                                                                                
<!--l. 71--><p class="noindent" >UIMA configuration parameters in the CR, CM, AE or CC components can be overriden using job specification
parameters: driver_descriptor_CR_overrides, process_descriptor_CM_overrides, process_descriptor_AE_overrides and
process_descriptor_CC_overrides, respectively.
<!--l. 75--><p class="noindent" >Another approach is to use the <span 
class="cmti-10">External Configuration Parameter Overrides </span>mechanism in core UIMA. External overrides is
the only approach available for jobs submitted with a Deployment Descriptor.
<!--l. 80--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-1640008.2"></a>Collection Segmentation and Artifact Extraction</h3>
<!--l. 82--><p class="noindent" >UIMA is built around artifact processing. A classic UIMA pipeline starts with a Collection Reader (CR) that defines
collection seqmentation, extracts the artifacts to be analyzed and puts them into the CASes to be delivered to subsequent
analytic components. A CR designed for a specific data collection is highly reusable for many different analytic
scenarios.
<!--l. 88--><p class="noindent" >A single CR supplying artifacts to a large number of analysis pipelines would be a bottleneck. Not only would artifact data
need to be transported twice across the compute cluster, but analysis results would be uselessly returned to the Job Driver.
To solve both of these problems, in a DUCC job the CR only sends a reference to the artifacts in the Work Item CAS, and
artifact data is read directly by the analysis pipeline.
<!--l. 94--><p class="noindent" >In DUCC collection processing the role of collection segmentation is implemented by the CR run in the Job Driver, while
artifact extraction and CAS initialization are implemented in the Cas Multiplier (CM) run in the Job Process. The
combination of a CR and associated CM should be highly reusable.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">In many cases it is useful to reference multiple artifacts in a Work Item CAS. Both DUCC sample applications
     described below exhibit this design.</dd></dl>
<!--l. 105--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-1650008.3"></a>CAS Consumer Changes for DUCC</h3>
<!--l. 107--><p class="noindent" >CAS Consumers in a UIMA pipeline may require changes for scale out into DUCC jobs, to avoid scale out bottlenecks, to
preserve collection level processing, or to flush results at end-of-work-item processing.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Federated ouput:</span> </dt><dd 
class="description">Scaled out DUCC jobs distribute artifact processing to multiple pipeline instances. All instances
     of a CAS Consumer should have independent access to the output target (filesystem, service, database, etc.).
     </dd><dt class="description">
<span 
class="cmbx-10">Singleton processing:</span> </dt><dd 
class="description">Collection level processing requiring that all results go to a singleton process would usually
     be done as a follow-on job, allowing incremental progress; Job Process errors due to data-dependent analysis
     bugs can often be fixed without invalidating completed Work Items, enabling a restarted job to utilize the
     progress made by previous job runs.
     </dd><dt class="description">
<span 
class="cmbx-10">Flushing cached data:</span> </dt><dd 
class="description">In some scenarios each Work Item delivered to a pipeline can be considered an independent
     collection. If a CAS Consumer caches data which needs to be flushed after processing the last artifact for a
     Work Item, the Work Item CAS can be routed to the CAS Consumer after the last artifact CAS is processed
     and used to trigger cache flushing.</dd></dl>
                                                                                                
                                                                                                
<!--l. 130--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8.4   </span> <a 
 id="x1-1660008.4"></a>Job Development for an Existing Pipeline Design</h3>
<!--l. 132--><p class="noindent" >Assuming that an existing job input-output design (CR, CM, CC) is to be reused, job development is focussed
on the Analysis Engine (AE) to be plugged in. Before deploying a new AE in a multithreaded Job Process
it is best to run it single threaded (process_thread_count=1) to separate basic logic errors from threading
problems.
<!--l. 138--><p class="noindent" >To debug a Job Process with eclipse, first create a debug configuration for a &#8221;remote java application&#8221;, specifying
&#8221;Connection Type = Socket Listen&#8221; on some free port P. Start the debug configuration and confirm it is listening on the
specified port. Then add to the job specification process_debug=port, where port is the value P used in the running debug
configuration.
<!--l. 144--><p class="noindent" >When the process_debug parameter is specified, DUCC will only run a single Job Process that will connect back to the
eclipse debug configuration.
<!--l. 148--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">8.5   </span> <a 
 id="x1-1670008.5"></a>Job Development for a New Pipeline Design</h3>
<!--l. 150--><p class="noindent" >A DUCC job is a UIMA application comprised of user code broken into a Collection Reader running in the Job Driver and
an Agreggate Analysis Engine (analysis pipeline) running in one or more Job Processes. Each Job Process may run multiple
instances of the pipeline, each in a different thread. The major components of the basic Job Process application are as
follows:
     <ul class="itemize1">
     <li class="itemize">User Collection reader - segments the input collection in to Work Items
     </li>
     <li class="itemize">User CAS Multiplier - inputs a Work Item and segments it into artifacts (CASes)
     </li>
     <li class="itemize">User Analysis Engine - processes the CASes
     </li>
     <li class="itemize">User CAS Consumer - outputs results for each Work Item
     </li>
     <li class="itemize">DUCC built-in Flow Controller - routes Work Item CASes to the CM and optionally to the CC or AE &amp; CC.</li></ul>
<!--l. 163--><p class="noindent" >It is good if the CR+CM+CC combination can be reused for a broad range of AE.
<!--l. 165--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.5.1   </span> <a 
 id="x1-1680008.5.1"></a>Collection Reader (CR) Characteristics</h4>
<!--l. 166--><p class="noindent" >A DUCC Job CR sends Work Item CASes to the Job Processes. These CASes contain references to the data to be read by
the Job Processes. Typically the CR Type System will be very small; in the DUCC sample applications the CR Type System
only contains the Workitem Feature Structure described below.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">It is important not to include the analytic Type System in the CR. These Type Systems can be quite large
     and will significantly increase the size of each Work Item CAS. The Job Driver process maintains a CAS pool
     which must be as large as the total number of processing threads active in a job.</dd></dl>
                                                                                                
                                                                                                
<!--l. 177--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.5.2   </span> <a 
 id="x1-1690008.5.2"></a>DUCC built-in Flow Controller</h4>
<!--l. 179--><p class="noindent" >This flow controller provides separate flows for Work Item CASes and for CASes produced by the CM and/or AE. Its
behavior is controlled by the existence of a CM component, and then further specified by the org.apache.uima.ducc.Workitem
feature structure in the Work Item CAS.
<!--l. 184--><p class="noindent" >When no CM is defined the Work Item CAS is simply delivered to the AE, and then to the CC if defined. Any CASes created
by the AE will be routed to the CC.
<!--l. 187--><p class="noindent" >With a defined CM, the Work Item CAS is delivered only to the CM, and then returned from the JP when processing of all
child CASes created by the CM and AE has completed. Work Item CAS flow can be further refined by the CR by creating a
org.apache.uima.ducc.Workitem feature structure and setting the setSendToLast feature to true, or by setting the
setSendToAll feature to true.
<!--l. 192--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.5.3   </span> <a 
 id="x1-1700008.5.3"></a>Workitem Feature Structure</h4>
<!--l. 193--><p class="noindent" >In addition to Work Item CAS flow control features, the WorkItem feature structure includes other features that are useful
for a DUCC job application. Here is the complete list of features:
       <dl class="description"><dt class="description">
       <span 
class="cmbx-10">sendToLast</span> </dt><dd 
class="description">(Boolean) - indicates the Work Item CAS be sent to the CC
       </dd><dt class="description">
       <span 
class="cmbx-10">sendToAll</span> </dt><dd 
class="description">(Boolean) - indicates Work Item CAS be sent to the AE and CC
       </dd><dt class="description">
       <span 
class="cmbx-10">inputspec</span> </dt><dd 
class="description">(String) - reference to Work Item input data
       </dd><dt class="description">
       <span 
class="cmbx-10">outputspec</span> </dt><dd 
class="description">(String) - reference to Work Item output data
       </dd><dt class="description">
       <span 
class="cmbx-10">encoding</span> </dt><dd 
class="description">(String) - useful for reading Work Item input data
       </dd><dt class="description">
       <span 
class="cmbx-10">language</span> </dt><dd 
class="description">(String) - used by the CM for setting document text language
       </dd><dt class="description">
       <span 
class="cmbx-10">bytelength</span> </dt><dd 
class="description">(Integer) - size of Work Item
       </dd><dt class="description">
       <span 
class="cmbx-10">blockindex</span> </dt><dd 
class="description">(Integer) - used if a Work Item is one of multiple pieces of an input resource
       </dd><dt class="description">
       <span 
class="cmbx-10">blocksize</span> </dt><dd 
class="description">(Integer) - used to indicate block size for splitting an input resource
       </dd><dt class="description">
       <span 
class="cmbx-10">lastBlock</span> </dt><dd 
class="description">(Boolean) - indicates this is the last block of an input resource</dd></dl>
                                                                                                
                                                                                                
<!--l. 209--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.5.4   </span> <a 
 id="x1-1710008.5.4"></a>Deployment Descriptor (DD) Jobs</h4>
<!--l. 210--><p class="noindent" >Job Processes with arbitrary aggregate hierarchy, flow control and threading can be fully specified via a UIMA AS
Deployment Descriptor. DUCC will modify the input queue to use DUCC&#8217;s private broker and change the queue name to
correspond to the DUCC job ID.
<!--l. 214--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">8.5.5   </span> <a 
 id="x1-1720008.5.5"></a>Debugging</h4>
<!--l. 215--><p class="noindent" >It is best to develop and debug the interactions between job application components as one, single-threaded UIMA aggregate.
DUCC provides an easy way to accomplish this, for both basic and DD job models, using the all_in_one specification
parameter.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">all</span><span 
class="cmbx-10">_in</span><span 
class="cmbx-10">_one=local</span> </dt><dd 
class="description">When set to local, all Job components are run in the same single-threaded process, on the same
     machine as eclipse.
     </dd><dt class="description">
<span 
class="cmbx-10">all</span><span 
class="cmbx-10">_in</span><span 
class="cmbx-10">_one=remote</span> </dt><dd 
class="description">With remote, the single-threaded process is run on a DUCC worker machine as a DUCC
     Managed Reservation.</dd></dl>
<!--l. 226--><p class="noindent" >To debug an all_in_one job with eclipse, first create a debug configuration for a &#8221;remote java application&#8221;, specifying
&#8221;Connection Type = Socket Listen&#8221; on some free port P. Start the debug configuration and confirm it is listening on the
specified port. Then, before submitting the all_in_one job, add the argument process_debug=port, where port is the value P
used in the running debug configuration.
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;9</span><br /><a 
 id="x1-1730009"></a>Sample Application: Raw Text Processing</h2>
<h3 class="sectionHead"><span class="titlemark">9.1   </span> <a 
 id="x1-1740009.1"></a>Application Function and Design</h3>
<!--l. 236--><p class="noindent" >This application expects as input a directory containing one or more flat text files, uses paragraph boundaries to segment the
text into separate artifacts, processes each artifact with the OpenNlpTextAnalyzer, and writes the results as compressed
UIMA CASes packaged in zip files. Paragraph boundaries are defined as two or more consecutive newline
characters.
<!--l. 242--><p class="noindent" >By default each input file is a Work Item. In order to facilitate processing scale out, an optional blocksize parameter can
be specified that will be used to break larger files into multiple Work Items. Paragraphs that cross block
boundaries are processed in the block where they started. An error is thrown if a paragraph crosses two block
boundaries.
<!--l. 248--><p class="noindent" >An output zip file is created for each Work Item. The CAS compression format is selectable as either ZIP compressed
XmiCas or UIMA compressed binary form 6 format. When compressed binary is used, each zip file also contains the full
UIMA Type System in ZIP compressed text. CASes in UIMA compressed binary form 6 format have the same
flexibility as an XmiCas in that they can be deserialized into a CAS with a different, but compatible Type
System.
<!--l. 254--><p class="noindent" >By default any previously completed output files found in the output directory are preserved. While Work Item processing is
in progress the associated output files have &#8221;_temp&#8221; appended to their filenames, and any such incomplete output files are
always ignored for subsequent jobs.
<!--l. 258--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.2   </span> <a 
 id="x1-1750009.2"></a>Configuration Parameters</h3>
<!--l. 259--><p class="noindent" >The Collection Reader for this job is the DuccJobTextCR. It has the following configuration parameters:
       <dl class="description"><dt class="description">
       <span 
class="cmbx-10">InputDirectory</span> </dt><dd 
class="description">path to directory containing input files.
       </dd><dt class="description">
       <span 
class="cmbx-10">OutputDirectory</span> </dt><dd 
class="description">path to directory for output files.
       </dd><dt class="description">
       <span 
class="cmbx-10">IgnorePreviousOutput</span> </dt><dd 
class="description">(optional) boolean to ignore (overwrite) existing output files.
       </dd><dt class="description">
       <span 
class="cmbx-10">Encoding</span> </dt><dd 
class="description">(optional) character encoding of the input files.
       </dd><dt class="description">
       <span 
class="cmbx-10">Language</span> </dt><dd 
class="description">(optional) language of the input documents, i.e. cas.setDocumentLanguage(language).
       </dd><dt class="description">
       <span 
class="cmbx-10">BlockSize</span> </dt><dd 
class="description">(optional) integer value used to break larger input files into multiple Work Items.
       </dd><dt class="description">
       <span 
class="cmbx-10">SendToLast</span> </dt><dd 
class="description">(optional) boolean to route WorkItem CAS to last pipeline component. Is set to true for this
       application.
       </dd><dt class="description">
       <span 
class="cmbx-10">SendToAll</span> </dt><dd 
class="description">(optional)  boolean  to  route  WorkItem  CAS  to  all  pipeline  components.  Not  used  in  this
       application.</dd></dl>
                                                                                                
                                                                                                
<!--l. 273--><p class="noindent" >The CAS Consumer is the DuccCasCC and has the following configuration parameters:
       <dl class="description"><dt class="description">
       <span 
class="cmbx-10">XmiCompressionLevel</span> </dt><dd 
class="description">(optional) compression value if using ZIP compression. Default is 7, range is 0-9.
       </dd><dt class="description">
       <span 
class="cmbx-10">UseBinaryCompression</span> </dt><dd 
class="description">(optional) boolean to select UIMA binary CAS compression.</dd></dl>
<!--l. 280--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.3   </span> <a 
 id="x1-1760009.3"></a>Set up a working directory</h3>
<!--l. 281--><p class="noindent" >For this and the following sample program, create a working directory in a writable filesystem.
<!--l. 283--><p class="noindent" >Copy to this directory the example job specification files:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-84">
&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$DUCC_HOME/examples/sampleapps/descriptors/*.job&#x00A0;.</div>
<!--l. 286--><p class="nopar" >
<!--l. 288--><p class="noindent" >Copy a UIMA logger configuration file that suppresses tons of output from OpenNLP:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-85">
&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$DUCC_HOME/examples/sampleapps/descriptors/ConsoleLogger.properties&#x00A0;.</div>
<!--l. 291--><p class="nopar" >
<!--l. 293--><p class="noindent" >Copy the executable code and resources for the DUCC sample application components:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-86">
&#x00A0;&#x00A0;&#x00A0;mkdir&#x00A0;lib
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;cp&#x00A0;$DUCC_HOME/lib/uima-ducc/examples/uima-ducc-examples*.jar&#x00A0;lib</div>
<!--l. 297--><p class="nopar" >
<!--l. 299--><p class="noindent" >For reference the source code for DUCC sample applications is in $DUCC_HOME/examples/src, with descriptors in
$DUCC_HOME/examples/sampleapps/descriptors.
<!--l. 302--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.4   </span> <a 
 id="x1-1770009.4"></a>Download and Install OpenNLP</h3>
<!--l. 303--><p class="noindent" >Download the OpenNLP source distribution from http://opennlp.apache.org and follow the directions in the <span 
class="cmti-10">UIMA</span>
<span 
class="cmti-10">Integration </span>section of the included documentation to build the UIMA pear file. Then <span 
class="cmti-10">install </span>the UIMA pear file in a directory
(which we will refer to below as $OPENNLP_HOME) with the <span 
class="cmti-10">runPearInstaller </span>script and test it with the UIMA Cas Visual
Debugger application.
<!--l. 309--><p class="noindent" >A small modification of the installed OpenNLP descriptor file is necessary for DUCC to run the component
multithreaded. Edit <span 
class="cmti-10">opennlp.uima.OpenNlpTextAnalyzer/desc/OpenNlpTextAnalyzer.xml </span>and change the setting for
<span 
class="cmti-10">multipleDeploymentAllowed </span>from false to true.
<!--l. 314--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.5   </span> <a 
 id="x1-1780009.5"></a>Get some Input Text</h3>
<!--l. 315--><p class="noindent" >Choose one or more flat text files in UTF8 format that only use newline characters, <span 
class="cmti-10">not CR-LF sequences</span>. The
text should be big enough to see the impact of DUCC job scale out. We used test data from gutenberg.org
at
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-87">
&#x00A0;&#x00A0;&#x00A0;http://www.gutenberg.org/ebooks/search/?sort_order=downloads</div>
<!--l. 321--><p class="nopar" > downloading &#8217;Plain Text UTF-8&#8217; versions of <span 
class="cmti-10">Moby Dick</span>, <span 
class="cmti-10">War and Peace </span>and <span 
class="cmti-10">The Complete Works of William</span>
<span 
class="cmti-10">Shakespeare </span>as flat text files in a subdirectory &#8216;Books&#8217;, and removing all &#8217;CR&#8217; characters (0xD) as well as extraneous
text.
<!--l. 326--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.6   </span> <a 
 id="x1-1790009.6"></a>Run the Job</h3>
<!--l. 327--><p class="noindent" >The job specification, DuccRawTextSpec.job, uses placeholders to reference the working directory and various operational
components located there. As run below the placeholders are resolved from environmental variables.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">The classpath for the application, defined in DuccRawTextSpec.job, requires that environmental parameters
     $UIMA_HOME and $OPENNLP_HOME are pointing at a valid UIMA SDK and the installed OpenNLP
     PEAR file, respectively.</dd></dl>
<!--l. 336--><p class="noindent" >The job is submitted from the command line with the following:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-88">
&#x00A0;&#x00A0;&#x00A0;MyAppDir=$PWD&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyInputDir=$PWD/Books&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyOutputDir=$PWD/Books.processed&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/bin/ducc_submit&#x00A0;-f&#x00A0;DuccRawTextSpec.job</div>
<!--l. 342--><p class="nopar" >
<!--l. 344--><p class="noindent" >The total size of the three txt files is 9.4Mbytes and with a blocksize of 100000 there are 100 Work Items. Each Job Process
is configured to run 8 parallel OpenNLP pipelines. To examine the performance of processing with just a single Job Process,
the job can be submitted as:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-89">
&#x00A0;&#x00A0;&#x00A0;MyAppDir=$PWD&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyInputDir=$PWD/Books&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyOutputDir=$PWD/Books.processed&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/bin/ducc_submit&#x00A0;-f&#x00A0;DuccRawTextSpec.job&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;--process_deployments_max&#x00A0;1</div>
<!--l. 354--><p class="nopar" >
<!--l. 356--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.7   </span> <a 
 id="x1-1800009.7"></a>Job Output</h3>
<!--l. 357--><p class="noindent" >There will be an output zipfile for every Work Item, with zipfiles containing a compressed CAS for each document
(paragraph) found in a Work Item. If UseBinaryCompression=true each zipfile will also contain the TypeSystem for the
CASes. This is needed when deserializing these CASes into a different TypeSystem.
<!--l. 361--><p class="noindent" >DuccTextCM finds 19245 paragraphs in the three txt files. If the output CASes are stored as 19245 uncompressed XMI files,
the total size is 911MB. Using the default ZIP compressed XMI format and packed into 100 Work Item zip files, the
total size is 165MB, a 5.5x compression. Using UIMA binary compressed format further reduces total size to
62MB.
<!--l. 363--><p class="noindent" >This output data will be used as input data for the following CAS input processing sample application.
<!--l. 365--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">9.8   </span> <a 
 id="x1-1810009.8"></a>Job Performance Details</h3>
<!--l. 366--><p class="noindent" >DUCC captures a number of process performance metrics. <a 
href="#x1-181001r1">Figure &#x00A0;9.1</a> shows details on the JD and single JP processes. The
%CPU time shown, 728, is lower than the actual because the Job Process was idle for some time before it received the first
Work Item and also idle between finishing the last Work Item and being shut down. DUCC shows the JVM spent a total of
58 seconds in GC (garbage collection), had no major page faults or page space, and used a max of 2.1GB of
RSS.
<!--l. 373--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-181001r1"></a>
                                                                                                
                                                                                                

<!--l. 375--><p class="noindent" ><img 
src="images/BooksRaw.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;9.1: </span><span  
class="content">OpenNLP Process Measurements</span></div><!--tex4ht:label?: x1-181001r1 -->
                                                                                                
                                                                                                
<!--l. 378--><p class="noindent" ></div><hr class="endfigure">
<!--l. 380--><p class="noindent" >On the Performance tab, DUCC shows the breakdown of clock time spent in each primitive UIMA component running in the
Job Process. See <a 
href="#x1-181002r2">Figure &#x00A0;9.2</a>. Processing time was dominated by the Parser component at 76.7%. The time
spent compressing and writing out CASes was 0.5%, and the time reading the input text files well below
0.1%.
<!--l. 385--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-181002r2"></a>
                                                                                                
                                                                                                

<!--l. 387--><p class="noindent" ><img 
src="images/BooksRawPerf.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;9.2: </span><span  
class="content">OpenNLP Process Breakdown</span></div><!--tex4ht:label?: x1-181002r2 -->
                                                                                                
                                                                                                
<!--l. 390--><p class="noindent" ></div><hr class="endfigure">
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;10</span><br /><a 
 id="x1-18200010"></a>Sample Application: CAS Input Processing</h2>
<h3 class="sectionHead"><span class="titlemark">10.1   </span> <a 
 id="x1-18300010.1"></a>Application Function and Design</h3>
<!--l. 396--><p class="noindent" >The main purpose of this application is to demonstrate the overhead of processing a collection of CASes grouped into zipfiles
and stored as ZIP compressed XmiCas or with UIMA compressed binary form 6 format.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">This application depends on successful processing of the work in the previous chapter.</dd></dl>
<!--l. 403--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">10.2   </span> <a 
 id="x1-18400010.2"></a>Configuration Parameters</h3>
<!--l. 404--><p class="noindent" >The Collection Reader for this job is the DuccJobCasCR. It has the following configuration parameters:
       <dl class="description"><dt class="description">
       <span 
class="cmbx-10">InputSpec</span> </dt><dd 
class="description">path to directory containing input files (named InputSpec in the hope that more options will
       be added).
       </dd><dt class="description">
       <span 
class="cmbx-10">OutputDirectory</span> </dt><dd 
class="description">path to directory for output files.
       </dd><dt class="description">
       <span 
class="cmbx-10">IgnorePreviousOutput</span> </dt><dd 
class="description">(optional) boolean to ignore (overwrite) previous output files.
       </dd><dt class="description">
       <span 
class="cmbx-10">SendToLast</span> </dt><dd 
class="description">(optional) boolean to route WorkItem CAS to last pipeline component. Set to true in this
       application.
       </dd><dt class="description">
       <span 
class="cmbx-10">SendToAll</span> </dt><dd 
class="description">(optional)  boolean  to  route  WorkItem  CAS  to  all  pipeline  components.  Not  used  in  this
       application.</dd></dl>
<!--l. 416--><p class="noindent" >The CAS Consumer is the DuccCasCC and has the following configuration parameters:
       <dl class="description"><dt class="description">
       <span 
class="cmbx-10">XmiCompressionLevel</span> </dt><dd 
class="description">(optional) compression value if using ZIP compression. Default is 7.
       </dd><dt class="description">
       <span 
class="cmbx-10">UseBinaryCompression</span> </dt><dd 
class="description">(optional) boolean to select UIMA binary CAS compression.</dd></dl>
<!--l. 423--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">10.3   </span> <a 
 id="x1-18500010.3"></a>Run the Job</h3>
<!--l. 424--><p class="noindent" >The job specification, DuccCasInputSpec.job, uses placeholders to reference the working directory and various
operational components located there. As run below the placeholders will be resolved from environmental
variables.
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">The classpath for the application, defined in DuccCasInputSpec.job, requires that environmental parameters
     $UIMA_HOME and $OPENNLP_HOME are pointing at a valid UIMA SDK and the installed OpenNLP
     PEAR file, respectively.</dd></dl>
<!--l. 433--><p class="noindent" >The job is submitted from the command line with the following:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-90">
&#x00A0;&#x00A0;&#x00A0;MyAppDir=$PWD&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyInputDir=$PWD/Books.processed&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;MyOutputDir=$PWD/Books.followon&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/bin/ducc_submit&#x00A0;-f&#x00A0;DuccCasInputSpec.job&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;--process_deployments_max&#x00A0;1</div>
<!--l. 440--><p class="nopar" >
<!--l. 442--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">10.4   </span> <a 
 id="x1-18600010.4"></a>Job Performance Details</h3>
<!--l. 443--><p class="noindent" ><a 
href="#x1-186001r1">Figure &#x00A0;10.1</a> shows the component breakdown using binary CAS compression. Reading and deserializing took 38% vs the
60% spent serializing and writing. Using 8 pipeline threads in one process the 19245 CASes output from the last application
were read and re-written in 9 seconds.
<!--l. 448--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-186001r1"></a>
                                                                                                
                                                                                                

<!--l. 450--><p class="noindent" ><img 
src="images/BooksCasPerf.png" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;10.1: </span><span  
class="content">CAS Input Processing Performacne</span></div><!--tex4ht:label?: x1-186001r1 -->
                                                                                                
                                                                                                
<!--l. 453--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">10.5   </span> <a 
 id="x1-18700010.5"></a>Limiting Job Resources</h3>
<!--l. 456--><p class="noindent" >Although this 8-threaded Job Process was primarily CPU bound doing serialization work, it is possible to become
I/O bound with enough threads banging on a shared filesystem. DuccCasInputSpec.job demonstrates how to
limit the total number of processing threads to 32 using the combination of process_thread_count=8 and
process_deployments_max=4.
<!--l. 461--><p class="noindent" >I/O vs CPU bottlenecks can be detected using the detailed performance job data reported by DUCC and comparing results
with various levels of scale out.
                                                                                                
                                                                                                
<!--l. 89--><p class="noindent" >
                                                                                                
                                                                                                
<h1 class="partHead"><span class="titlemark">Part&#x00A0;IV<br /></span><a 
 id="x1-188000IV"></a>Ducc Administrators Guide</h1>
<!--l. 23--><p class="noindent" ><a name='DUCC_INSTALL'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;11</span><br /><a 
 id="x1-18900011"></a>Installation, Configuration, and Verification</h2>
<h3 class="sectionHead"><span class="titlemark">11.1   </span> <a 
 id="x1-19000011.1"></a>Overview</h3>
<!--l. 21--><p class="noindent" >DUCC is a multi-user, multi-system distributed application. The instuctions below follow a staged installation/verification
methodology, roughly as follows:
     <ul class="itemize1">
     <li class="itemize">Single system installation.
     </li>
     <li class="itemize">Add new machines to DUCC control.
     </li>
     <li class="itemize">Enable processes to run with the credentials of multiple submitting user. This step requires root authority on
     one or more machines.
     </li>
     <li class="itemize">Enable CGroup containers. This step requires root authority on every DUCC machine.</li></ul>
<!--l. 36--><p class="noindent" >DUCC is distributed as a compressed tar file. The instructions below assume installation from one of this distribution media.
If building from source, the build creates this file in your svn trunk/target directory. The distribution file is in the
form
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-91">
&#x00A0;&#x00A0;&#x00A0;uima-ducc-[version]-bin.tar.gz</div>
<!--l. 41--><p class="nopar" > where [version] is the DUCC version; for example, <span 
class="cmti-10">uima-ducc-VERSION-bin.tar.gz </span>(where VERSION is the current DUCC
version). This document will refer to the distribution file as the &#8220;<span 
class="cmmi-10">&#x003C;</span>distribution.file<span 
class="cmmi-10">&#x003E;</span>&#8221;.
<!--l. 45--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.2   </span> <a 
 id="x1-19100011.2"></a>Software Prerequisites</h3>
<!--l. 48--><p class="noindent" >Single system installation:
     <ul class="itemize1">
     <li class="itemize">Reasonably current Linux. DUCC has been tested on SLES 11.x and RHEL 6.x
     <!--l. 53--><p class="noindent" ><span 
class="cmti-10">Note: </span>On some systems the default <span 
class="cmti-10">user limits </span>for max user processes (ulimit -u) and nfiles (ulimit -n) are
     defined too low for DUCC. The shell login profile for user <span 
class="cmti-10">ducc </span>should set the soft limit for max user processes
     to be the same as the hard limit (ulimit -u &#8216;ulimit -Hu&#8216;), and the nfiles limit raised above 1024 to at least twice
     the number of user processes running on the cluster.
     </li>
     <li class="itemize">Python 2.x, where &#8217;x&#8217; is 4 or greater. DUCC has not been tested on Python 3.x.
     </li>
     <li class="itemize">Java 7. DUCC has been tested and run using IBM and Oracle JDK 1.7.
     </li>
     <li class="itemize">Passwordless ssh for user running DUCC</li></ul>
<!--l. 66--><p class="noindent" >Additional requirements for multiple system installation:
     <ul class="itemize1">
     <li class="itemize">All systems must have a shared filesystem (such as NFS or GPFS) and common user space. The $DUCC_HOME
     directory must be located on a shared filesystem.</li></ul>
<!--l. 73--><p class="noindent" >Additional requirements for running multiple user processes with their own credentials.
     <ul class="itemize1">
     <li class="itemize">A userid <span 
class="cmti-10">ducc</span>, and group <span 
class="cmti-10">ducc</span>. User <span 
class="cmti-10">ducc </span>must the the only member of group <span 
class="cmti-10">ducc</span>.
     </li>
     <li class="itemize">DUCC run with user <span 
class="cmti-10">ducc </span>credentials.
     </li>
     <li class="itemize">Root access is required to setuid-root the DUCC process launcher.</li></ul>
<!--l. 81--><p class="noindent" >Additional requirements for CGroup containers:
     <ul class="itemize1">
     <li class="itemize">A userid <span 
class="cmti-10">ducc</span>, and group <span 
class="cmti-10">ducc</span>. User <span 
class="cmti-10">ducc </span>must the the only member of group <span 
class="cmti-10">ducc</span>.
                                                                                                
                                                                                                
     </li>
     <li class="itemize">DUCC run with user <span 
class="cmti-10">ducc </span>credentials.
     </li>
     <li class="itemize">libcgroup1-0.37+ on SLES and libcgroup-0.37+ on RHEL, along with a custom /etc/cgconfig.conf</li></ul>
<!--l. 90--><p class="noindent" >In order to build DUCC from source the following software is also required:
     <ul class="itemize1">
     <li class="itemize">A    Subversion    client,    from    <a 
href="http://subversion.apache.org/packages.html" class="url" ><span 
class="cmtt-10">http://subversion.apache.org/packages.html</span></a>.    The    svn    url    is
     <a 
href="https://svn.apache.org/repos/asf/uima/sandbox/uima-ducc/trunk" class="url" ><span 
class="cmtt-10">https://svn.apache.org/repos/asf/uima/sandbox/uima-ducc/trunk</span></a>.
     </li>
     <li class="itemize">Apache Maven, from <a 
href="http://maven.apache.org/index.html" class="url" ><span 
class="cmtt-10">http://maven.apache.org/index.html</span></a></li></ul>
<!--l. 97--><p class="noindent" >The DUCC webserver server optionally supports direct &#8220;jconsole&#8221; attach to DUCC job processes. To install this, the
following is required:
     <ul class="itemize1">
     <li class="itemize">Apache Ant, any reasonably current version.</li></ul>
<!--l. 103--><p class="noindent" >To (optionally) build the documentation, the following is also required:
     <ul class="itemize1">
     <li class="itemize">Latex,  including  the  <span 
class="cmti-10">pdflatex  </span>and  <span 
class="cmti-10">htlatex  </span>packages.  A  good  place  to  start  if  you  need  to  install  it  is
     <a 
href="https://www.tug.org/texlive/" class="url" ><span 
class="cmtt-10">https://www.tug.org/texlive/</span></a>.</li></ul>
<!--l. 109--><p class="noindent" >More detailed one-time setup instructions for source-level builds via subversion can be found here:
<a 
href="http://uima.apache.org/one-time-setup.html\#svn-setup" class="url" ><span 
class="cmtt-10">http://uima.apache.org/one-time-setup.html\#svn-setup</span></a>
<!--l. 112--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.3   </span> <a 
 id="x1-19200011.3"></a>Building from Source</h3>
<!--l. 114--><p class="noindent" >To build from source, ensure you have Subversion and Maven installed. Extract the source from the SVN repository named
above.
<!--l. 117--><p class="noindent" >Then from your extract directory into the root directory (usually current-directory/trunk), and run the command
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-92">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;mvn&#x00A0;install</div>
<!--l. 121--><p class="nopar" > or
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-93">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;mvn&#x00A0;install&#x00A0;-Pbuild-duccdocs</div>
<!--l. 125--><p class="nopar" > if you have LaTeX insalled and wish to do the optional build of documentation.
<!--l. 128--><p class="noindent" >If this is your first Maven build it may take quite a while as Maven downloads all the open-source pre-requisites. (The
pre-requisites are stored in the Maven repository, usually your $HOME/.m2).
<!--l. 132--><p class="noindent" >When build is complete, a tarball is placed in your current-directory/trunk/target directory.
<!--l. 135--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.4   </span> <a 
 id="x1-19300011.4"></a>Documentation</h3>
<!--l. 137--><p class="noindent" >After installation the DUCC documentation is found (in both PDF and HTML format) in the directory ducc_runtime/docs.
As well, the DUCC webserver contains a link to the full documentation on each major page. The API is documented only via
JavaDoc, distributed in the webserver&#8217;s root directory <span 
class="cmtt-10">$DUCC</span><span 
class="cmtt-10">_HOME/webserver/root/doc/api.</span>
<!--l. 143--><p class="noindent" >If building from source, Maven places the documentation in
     <ul class="itemize1">
     <li class="itemize"><span 
class="cmtt-10">trunk/uima-ducc-duccdocs/target/site </span>(main documentation), and
     </li>
     <li class="itemize"><span 
class="cmtt-10">trunk/target/site/apidocs </span>(API Javadoc)</li></ul>
<!--l. 149--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.5   </span> <a 
 id="x1-19400011.5"></a>Single System Installation and Verification</h3>
<!--l. 151--><p class="noindent" >Although any user ID can be used to run DUCC, it is recommended to create user &#8220;ducc&#8221; to later enable use of cgroups as
well as running processes with the credentials of the submitting user.
<!--l. 154--><p class="noindent" >If multiple nodes are going to be added later, it is recommended to install the ducc runtime tree on a shared filesystem so
that it can be mounted on the additional nodes.
<!--l. 157--><p class="noindent" >Verification submits a very simple UIMA pipeline for execution under DUCC. Once this is shown to be working, one may
proceed installing additional features.
<!--l. 161--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.6   </span> <a 
 id="x1-19500011.6"></a>Minimal Hardware Requirements for Single System Installation</h3>
     <ul class="itemize1">
     <li class="itemize">One Intel-based or IBM Power-based system. (More systems may be added later.)
     </li>
     <li class="itemize">8GB of memory. 16GB or more is preferable for developing and testing applications beyond the non-trivial.
                                                                                                
                                                                                                
     </li>
     <li class="itemize">1GB disk space to hold the DUCC runtime, system logs, and job logs. More is usually needed for larger
     installations.</li></ul>
<!--l. 172--><p class="noindent" >Please note: DUCC is intended for scaling out memory-intensive UIMA applications over computing clusters consisting of
multiple nodes with large (16GB-256GB or more) memory. The minimal requirements are for initial test and evaluation
purposes, but will not be sufficient to run actual workloads.
<!--l. 177--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.7   </span> <a 
 id="x1-19600011.7"></a>Single System Installation</h3>
<!--l. 180--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Expand the distribution file with the appropriate umask:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-94">
     (umask&#x00A0;022&#x00A0;&amp;&amp;&#x00A0;tar&#x00A0;-zxf&#x00A0;&#x003C;distribution.file&#x003E;)</div>
     <!--l. 183--><p class="nopar" >
     <!--l. 185--><p class="noindent" >This creates a directory with a name of the form &#8220;apache-uima-ducc-[version]&#8221;.
     <!--l. 187--><p class="noindent" >This directory contains the full DUCC runtime which you may use &#8220;in place&#8221; but it is highly recommended
     that you move it into a standard location on a shared filesystem; for example, under ducc&#8217;s HOME
     directory:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-95">
     mv&#x00A0;apache-uima-ducc-[version]&#x00A0;/home/ducc/ducc_runtime</div>
     <!--l. 192--><p class="nopar" >
     <!--l. 194--><p class="noindent" >We refer to this directory, regardless of its location, as $DUCC_HOME. For simplicity, some of the examples in this
     document assume it has been moved to /home/ducc/ducc_runtime.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Change directories into the admin sub-directory of $DUCC_HOME:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-96">
     cd&#x00A0;$DUCC_HOME/admin</div>
     <!--l. 200--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Run the post-installation script:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-97">
     ./ducc_post_install</div>
     <!--l. 205--><p class="nopar" > If this script fails, correct any problems it identifies and run it again.
     <!--l. 208--><p class="noindent" >Note that <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_post</span><span 
class="cmti-10">_install </span>initializes various default parameters which may be changed later by the system
     administrator. Therefore it usually should be run only during this first installation step.
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">If you wish to install jconsole support from the webserver, make sure Apache Ant is installed, and run
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-98">
     ./sign_jconsole_jar</div>
     <!--l. 216--><p class="nopar" > This step may be run at any time if you wish to defer it.
     </dd></dl>
<!--l. 221--><p class="noindent" >That&#8217;s it, DUCC is installed and ready to run. (If errors were displayed during ducc_post_install they must be corrected
before continuing.)
<!--l. 224--><p class="noindent" >The post-installation script performs these tasks:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Verifies that the correct level of Java and Python are installed and available.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Creates a default nodelist, $DUCC_HOME/resources/ducc.nodes, containing the name of the node you are
     installing on.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Defines the &#8220;ducc head&#8221; node to be to node you are installing from.
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">Sets up the default https keystore for the webserver.
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">Installs the DUCC documentation &#8220;ducc book&#8221; into the DUCC webserver root.
     </dd><dt class="enumerate-enumitem">
  6. </dt><dd 
class="enumerate-enumitem">Builds and installs the C program, &#8220;ducc_ling&#8221;, into the default location.
     </dd><dt class="enumerate-enumitem">
  7. </dt><dd 
class="enumerate-enumitem">Ensures that the (supplied) ActiveMQ broker is runnable.</dd></dl>
<!--l. 235--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.8   </span> <a 
 id="x1-19700011.8"></a>Initial System Verification</h3>
<!--l. 237--><p class="noindent" >Here we verify the system configuration, start DUCC, run a test Job, and then shutdown DUCC.
<!--l. 239--><p class="noindent" >To run the verification, issue these commands.
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">cd $DUCC_HOME/admin
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">./check_ducc
     <!--l. 244--><p class="noindent" >Examine the output of check_ducc. If any errors are shown, correct the errors and rerun check_ducc until there
     are no errors.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Finally, start ducc: ./start_ducc</dd></dl>
<!--l. 249--><p class="noindent" >Start_ducc will first perform a number of consistency checks. It then starts the ActiveMQ broker, the DUCC control
processes, and a single DUCC agent on the local node.
<!--l. 253--><p class="noindent" >You will see some startup messages similar to the following:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-99">
ENV:&#x00A0;Java&#x00A0;is&#x00A0;configured&#x00A0;as:&#x00A0;/share/jdk1.7/bin/java
&#x00A0;<br />ENV:&#x00A0;java&#x00A0;full&#x00A0;version&#x00A0;"1.7.0_40-b43"
&#x00A0;<br />ENV:&#x00A0;Threading&#x00A0;enabled:&#x00A0;True
&#x00A0;<br />MEM:&#x00A0;memory&#x00A0;is&#x00A0;15&#x00A0;gB
&#x00A0;<br />ENV:&#x00A0;system&#x00A0;is&#x00A0;Linux
&#x00A0;<br />allnodes&#x00A0;/home/ducc/ducc_runtime/resources/ducc.nodes
&#x00A0;<br />Class&#x00A0;definition&#x00A0;file&#x00A0;is&#x00A0;ducc.classes
&#x00A0;<br />OK:&#x00A0;Class&#x00A0;and&#x00A0;node&#x00A0;definitions&#x00A0;validated.
&#x00A0;<br />OK:&#x00A0;Class&#x00A0;configuration&#x00A0;checked
&#x00A0;<br />Starting&#x00A0;broker&#x00A0;on&#x00A0;ducchead.biz.org
&#x00A0;<br />Waiting&#x00A0;for&#x00A0;broker&#x00A0;.....&#x00A0;0
&#x00A0;<br />Waiting&#x00A0;for&#x00A0;broker&#x00A0;.....&#x00A0;1
&#x00A0;<br />ActiveMQ&#x00A0;broker&#x00A0;is&#x00A0;found&#x00A0;on&#x00A0;configured&#x00A0;host&#x00A0;and&#x00A0;port:&#x00A0;ducchead.biz.org:61616
&#x00A0;<br />Starting&#x00A0;1&#x00A0;agents
&#x00A0;<br />**********&#x00A0;Starting&#x00A0;agents&#x00A0;from&#x00A0;file&#x00A0;/home/ducc/ducc_runtime/resources/ducc.nodes
&#x00A0;<br />Starting&#x00A0;warm
&#x00A0;<br />Waiting&#x00A0;for&#x00A0;Completion
&#x00A0;<br />ducchead.biz.org&#x00A0;Starting&#x00A0;rm
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;14198
&#x00A0;<br />ducchead.biz.org&#x00A0;Starting&#x00A0;pm
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;14223
&#x00A0;<br />ducchead.biz.org&#x00A0;Starting&#x00A0;sm
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;14248
&#x00A0;<br />ducchead.biz.org&#x00A0;Starting&#x00A0;or
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;14275
&#x00A0;<br />ducchead.biz.org&#x00A0;Starting&#x00A0;ws
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;PID&#x00A0;14300
&#x00A0;<br />ducchead.biz.org
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc_ling&#x00A0;OK
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC&#x00A0;Agent&#x00A0;started&#x00A0;PID&#x00A0;14325
&#x00A0;<br />All&#x00A0;threads&#x00A0;returned</div>
<!--l. 287--><p class="nopar" >
<!--l. 289--><p class="noindent" >Now open a browser and go to the DUCC webserver&#8217;s url, http://<span 
class="cmmi-10">&#x003C;</span>hostname<span 
class="cmmi-10">&#x003E;</span>:42133 where <span 
class="cmmi-10">&#x003C;</span>hostname<span 
class="cmmi-10">&#x003E; </span>is the name of the
host where DUCC is started. Navigate to the Reservations page via the links in the upper-left corner. You should see the
DUCC JobDriver reservation in state WaitingForResources. In a few minutes this should change to Assigned. Now jobs can
be submitted.
<!--l. 295--><p class="noindent" >To submit a job,
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">$DUCC_HOME/bin/ducc_submit &#8211;specification $DUCC_HOME/examples/simple/1.job</dd></dl>
<!--l. 300--><p class="noindent" >Open the browser in the DUCC jobs page. You should see the job progress through a series of transitions: Waiting For
Driver, Waiting For Services, Waiting For Resources, Initializing, and finally, Running. You&#8217;ll see the number of work items
submitted (15) and the number of work items completed grow from 0 to 15. Finally, the job will move into Completing and
then Completed..
<!--l. 306--><p class="noindent" >Since this example does not specify a log directory DUCC will create a log directory in your HOME directory
under
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-100">
$HOME/ducc/logs/job-id</div>
<!--l. 309--><p class="nopar" >
<!--l. 311--><p class="noindent" >In this directory, you will find a log for the sample job&#8217;s JobDriver (JD), JobProcess (JP), and a number of other files
relating to the job.
<!--l. 314--><p class="noindent" >This is a good time to explore the DUCC web pages. Notice that the job id is a link to a set of pages with details about the
execution of the job.
<!--l. 317--><p class="noindent" >Notice also, in the upper-right corner is a link to the full DUCC documentation, the &#8220;DuccBook&#8221;.
<!--l. 319--><p class="noindent" >Finally, stop DUCC:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">cd $DUCC_HOME/admin
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">./stop_ducc -a</dd></dl>
<!--l. 326--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.9   </span> <a 
 id="x1-19800011.9"></a>Add additional nodes to the DUCC cluster</h3>
<!--l. 327--><p class="noindent" >Additional nodes must meet all <a 
href="#x1-19100011.2"><span 
class="cmti-10">prerequisites</span></a>.
<!--l. 334--><p class="noindent" >$DUCC_HOME must be on a shared filesystem and mounted at the same location on all DUCC nodes.
<!--l. 337--><p class="noindent" >If user&#8217;s home directories are on local filesystems the location for user logfiles should be specified to be on a shared
filesystem.
<!--l. 340--><p class="noindent" >Addional nodes are normally added to a worker node group. Note that the DUCC head node does not have to be a worker
node. In addition, the webserver node can be separate from the DUCC head node (see webserver configuration options in
ducc.properties).
<!--l. 345--><p class="noindent" >For worker nodes DUCC needs to know what node group each machine belongs to, and what nodes need an Agent process to
be started on.
<!--l. 348--><p class="noindent" >The configuration shipped with DUCC have all nodes in the same &#8221;default&#8221; node pool. Worker nodes are listed in the
file
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-101">
$DUCC_HOME/resources/ducc.nodes.</div>
<!--l. 352--><p class="nopar" >
<!--l. 354--><p class="noindent" >During initial installation, this file was initialized with the node DUCC is installed on. Additional nodes may be added to the
file using a text editor to increase the size of the DUCC cluster.
<!--l. 359--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.10   </span> <a 
 id="x1-19900011.10"></a>Ducc_ling Configuration - Running with credentials of submitting user</h3>
<!--l. 362--><p class="noindent" >DUCC launches user processes through ducc_ling, a small native C application. By default the resultant process runs with
the credentials of the user ID of the DUCC application. It is possible for multiple users to submit work to DUCC in this
configuration, but it requires that the user ID running DUCC has write access to all directories to which the user process
outputs data. By configuring the ducc user ID and ducc_ling correctly, work submitted by all users will run with their own
credentials.
<!--l. 370--><p class="noindent" >Before proceeding with this step, please note:
     <ul class="itemize1">
     <li class="itemize">The sequence operations consisting of <span 
class="cmti-10">chown </span>and <span 
class="cmti-10">chmod </span>MUST be performed in the exact order given below.
     If the <span 
class="cmti-10">chmod </span>operation is performed before the <span 
class="cmti-10">chown </span>operation, Linux will regress the permissions granted by
     <span 
class="cmti-10">chmod </span>and ducc_ling will be incorrectly installed.</li></ul>
<!--l. 378--><p class="noindent" >ducc_ling is designed to be a setuid-root program whose function is to run user processes with the identity of the submitting
user. This must be installed correctly; incorrect installation can prevent jobs from running as their submitters, and in the
worse case, can introduce security problems into the system.
<!--l. 382--><p class="noindent" >ducc_ling can either be installed on a local disk on every system in the DUCC cluster, or on a shared-filesystem that does not
suppress setuid-root permissions on client nodes. The path to ducc_ling must be the same on each DUCC node. The default
path configuration is $DUCC_HOME/admin/$<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">}</span>/ in order to handle clusters with mixed OS platforms.
$<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">} </span>is the architecture specific value of the Java system property with that name; examples are amd64 and
ppc64.
<!--l. 390--><p class="noindent" >The steps are: build ducc_ling for each node architecture to be added to the cluster, copy ducc_ling to the
desired location, and then configure ducc_ling to give user ducc the ability to spawn a process as a different
user.
<!--l. 394--><p class="noindent" >In the example below ducc_ling is left under $DUCC_HOME, where it is built.
<!--l. 396--><p class="noindent" >As user <span 
class="cmti-10">ducc</span>, build ducc_ling for necessary architectures (this is done automatically for the DUCC head machine by the
ducc_post_install script). For each unique OS platform:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">cd $DUCC_HOME/admin
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">./build_duccling</dd></dl>
<!--l. 404--><p class="noindent" >Then, as user <span 
class="cmti-10">root </span>on the shared filesystem, <span 
class="cmti-10">cd </span><span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/admin</span>, and for each unique OS architecture:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">chown ducc.ducc $<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">}</span><br 
class="newline" />(set directory ownership to be user ducc, group ducc)
                                                                                                
                                                                                                
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">chmod 700 $<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">}</span><br 
class="newline" />(only user ducc can read contents of directory)
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">chown root.ducc $<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">}</span>/ducc_ling <br 
class="newline" />(make root owner of ducc_ling, and let users in group ducc access it)
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">chmod 4750 $<span 
class="cmsy-10">{</span>os.arch<span 
class="cmsy-10">}</span>/ducc_ling <br 
class="newline" />(ducc_ling runs as user root when started by users in group ducc)</dd></dl>
<!--l. 416--><p class="noindent" >If these steps are correctly performed, ONLY user <span 
class="cmti-10">ducc </span>may use the ducc_ling program in a privileged way. ducc_ling
contains checks to prevent even user <span 
class="cmti-10">root </span>from using it for privileged operations.
<!--l. 420--><p class="noindent" >If a different location is chosen for ducc_ling the new path needs to be specified for ducc.agent.launcher.ducc_spawn_path in
$DUCC_HOME/resources/site.ducc.properties. See more info at see <a 
href="#x1-21200012.3">Properties merging</a>.
<!--l. 430--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.11   </span> <a 
 id="x1-20000011.11"></a>CGroups Installation and Configuration</h3>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Note:</span> </dt><dd 
class="description">A key feature of DUCC is to run user processes in CGroups in order to guarantee each process always has
     the amount of RAM requested. RAM allocated to the managed process (and any child processes) that exceed
     requested DUCC memory size will be forced into swap space. Without CGroups a process that exceeds its
     requested memory size by N% is killed (default N=5 in ducc.properties), and memory use by child processes is
     ignored.
     <!--l. 439--><p class="noindent" >DUCC&#8217;s CGroup configuration also allocates CPU resources to managed processes based on relative memory
     size. A process with 50% of a machine&#8217;s RAM will be guaranteed at least 50% of the machine&#8217;s CPU resources
     as well.</dd></dl>
<!--l. 444--><p class="noindent" >The steps in this task must be done as user root and user ducc.
<!--l. 446--><p class="noindent" >To install and configure CGroups for DUCC:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Install the appropriate <a 
href="#x1-19100011.2">libcgroup package</a> at level 0.37 or above.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Configure /etc/cgconfig.conf as follows:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-102">
     &#x00A0;&#x00A0;&#x00A0;#&#x00A0;Mount&#x00A0;cgroups
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;mount&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;memory&#x00A0;=&#x00A0;/cgroup;
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;cpu&#x00A0;=&#x00A0;/cgroup;
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;#&#x00A0;Define&#x00A0;cgroup&#x00A0;ducc&#x00A0;and&#x00A0;setup&#x00A0;permissions
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;group&#x00A0;ducc&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;perm&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;task&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;uid&#x00A0;=&#x00A0;ducc;
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;admin&#x00A0;{
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;uid&#x00A0;=&#x00A0;ducc;
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;memory&#x00A0;{}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;cpu{}
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;}</div>
     <!--l. 475--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Start the cgconfig service:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-103">
     &#x00A0;&#x00A0;&#x00A0;service&#x00A0;cgconfig&#x00A0;start</div>
     <!--l. 479--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">Verify cgconfig service is running by the existence of directory:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-104">
     &#x00A0;&#x00A0;&#x00A0;/cgroups/ducc</div>
     <!--l. 484--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">Configure the cgconfig service to start on reboot:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-105">
     &#x00A0;&#x00A0;&#x00A0;chkconfig&#x00A0;cgconfig&#x00A0;on</div>
     <!--l. 489--><p class="nopar" ></dd></dl>
<!--l. 492--><p class="noindent" ><span 
class="cmti-10">Note: </span>if CGroups is not installed on a machine the DUCC Agent will detect this and not attempt to use the feature. CGroups
can also be disabled for all machines (see <a 
href="#x1-22000012.4.7"><span 
class="cmti-10">ducc.agent.launcher.cgroups.enable</span></a>) or it can be disabled for individual machines
(see <a 
href="#x1-22000012.4.7"><span 
class="cmti-10">ducc.agent.exclusion.file</span></a>).
<!--l. 509--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.12   </span> <a 
 id="x1-20100011.12"></a>Full DUCC Verification</h3>
<!--l. 511--><p class="noindent" >This is identical to initial verification, with the one difference that the job &#8220;1.job&#8221; should be submitted as any user other
than ducc. Watch the webserver and check that the job executes under the correct identity. Once this completes, DUCC is
installed and verified.
<!--l. 515--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">11.13   </span> <a 
 id="x1-20200011.13"></a>Enable DUCC webserver login</h3>
<!--l. 517--><p class="noindent" >This step is optional. As shipped, the webserver is disabled for logins. This can be seen by hovering over the Login text
located in the upper right of most webserver pages:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-106">
System&#x00A0;is&#x00A0;configured&#x00A0;to&#x00A0;disallow&#x00A0;logins</div>
<!--l. 522--><p class="nopar" >
<!--l. 524--><p class="noindent" >To enable logins, a Java-based authenticator must be plugged-in and the login feature must be enabled in the ducc.properties
file by the DUCC administrator. Also, ducc_ling should be properly deployed (see Ducc_ling Installation section
above).
<!--l. 529--><p class="noindent" >A beta version of a Linux-based authentication plug-in is shipped with DUCC. It can be found in the source
tree:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-107">
org.apache.uima.ducc.ws.authentication.LinuxAuthenticationManager</div>
<!--l. 533--><p class="nopar" >
<!--l. 535--><p class="noindent" >The Linux-based authentication plug-in will attempt to validate webserver login requests by appealing to the host OS. The
user who wishes to login provides a userid and password to the webserver via https, which in-turn are handed-off to the OS
for a success/failure reply.
<!--l. 540--><p class="noindent" >To have the webserver employ the beta Linux-based authentication plug-in, the DUCC administrator should perform the
following as user ducc:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-108">
1.&#x00A0;edit&#x00A0;ducc.properties
&#x00A0;<br />2.&#x00A0;locate:&#x00A0;ducc.ws.login.enabled&#x00A0;=&#x00A0;false
&#x00A0;<br />3.&#x00A0;modify:&#x00A0;ducc.ws.login.enabled&#x00A0;=&#x00A0;true
&#x00A0;<br />4.&#x00A0;save</div>
<!--l. 547--><p class="nopar" >
<!--l. 549--><p class="noindent" >Note: The beta Linux-based authentication plug-in has limited testing. In particular, it was tested using:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-109">
Red&#x00A0;Hat&#x00A0;Enterprise&#x00A0;Linux&#x00A0;Workstation&#x00A0;release&#x00A0;6.4&#x00A0;(Santiago)</div>
<!--l. 553--><p class="nopar" >
<!--l. 555--><p class="noindent" >Alternatively, you can provide your own authentication plug-in. To do so:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-110">
1.&#x00A0;author&#x00A0;a&#x00A0;Java&#x00A0;class&#x00A0;that&#x00A0;implements
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;org.apache.uima.ducc.common.authentication.IAuthenticationManager
&#x00A0;<br />2.&#x00A0;create&#x00A0;a&#x00A0;jar&#x00A0;file&#x00A0;comprising&#x00A0;your&#x00A0;authentication&#x00A0;class
&#x00A0;<br />3.&#x00A0;put&#x00A0;the&#x00A0;jar&#x00A0;file&#x00A0;in&#x00A0;a&#x00A0;location&#x00A0;accessible&#x00A0;by&#x00A0;the&#x00A0;DUCC&#x00A0;webserver,&#x00A0;such&#x00A0;as
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/lib/authentication
&#x00A0;<br />4.&#x00A0;put&#x00A0;any&#x00A0;authentication&#x00A0;dependency&#x00A0;jar&#x00A0;files&#x00A0;there&#x00A0;as&#x00A0;well
&#x00A0;<br />5.&#x00A0;edit&#x00A0;ducc.properties
&#x00A0;<br />6.&#x00A0;add&#x00A0;the&#x00A0;following:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;ducc.local.jars&#x00A0;=&#x00A0;authentication/*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;ducc.authentication.implementer=&#x003C;your.authenticator.class.Name&#x003E;
&#x00A0;<br />7.&#x00A0;locate:&#x00A0;ducc.ws.login.enabled&#x00A0;=&#x00A0;false
&#x00A0;<br />8.&#x00A0;modify:&#x00A0;ducc.ws.login.enabled&#x00A0;=&#x00A0;true
&#x00A0;<br />9.&#x00A0;save</div>
<!--l. 570--><p class="nopar" >
<!--l. 31--><p class="noindent" ><a name='DUCC_ADMIN'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;12</span><br /><a 
 id="x1-20300012"></a>Administration</h2>
<h3 class="sectionHead"><span class="titlemark">12.1   </span> <a 
 id="x1-20400012.1"></a>WebServer Authentication</h3>
<!--l. 22--><p class="noindent" >By default, DUCC is configured such that there is effectively no authentication enforcement by the WebServer.
No password entry is permitted on the Login panel and any userid specified is accepted whether it exists or
not.
<!--l. 27--><p class="noindent" >To enable your own authentication measures, you should perform the following steps:
<!--l. 31--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Author an authentication manager Java class implementing interface
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-111">
     org.apache.uima.ducc.common.authentication.IAuthenticationManager
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
     <!--l. 34--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Create an authentication jar file comprising the authentication manager Java class
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Install your authentication jar file and any dependency jar files into your DUCC&#8217;s lib folder
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">Update your ducc.properties file with authentication class name and jar file name(s) information
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">Create a ducc.administrators file</dd></dl>
<!--l. 44--><p class="noindent" >Note: When a user clicks on the WebServer Login link, the login dialog is shown. On that dialog panel is shown the
authenticator: <span 
class="cmti-10">version</span>, which is supplied by your authentication manager implementation&#8217;s <span 
class="cmti-10">getVersion()</span> method. Also shown
are boxes for userid and password entry. If your authentication manager implemenation&#8217;s <span 
class="cmti-10">isPasswordChecked()</span> method
returns true then the password box will accept input, otherwise it will be disabled.
<!--l. 52--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.1   </span> <a 
 id="x1-20500012.1.1"></a>Example Implementation</h4>
<!--l. 54--><p class="noindent" >Shown below is an example implementation which can be used as a template for coding protection by means of interfacing
with your site&#8217;s security measures.
<!--l. 58--><p class="noindent" >In this example, the SiteSecurity Java class is presumed to be existing and available code at your installation.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-112">
package&#x00A0;org.apache.uima.ducc.example.authentication.module;
&#x00A0;<br />
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.common.authentication.AuthenticationResult;
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.common.authentication.IAuthenticationManager;
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.common.authentication.IAuthenticationResult;
&#x00A0;<br />import&#x00A0;org.apache.uima.ducc.example.authentication.site.SiteSecurity;
&#x00A0;<br />
&#x00A0;<br />public&#x00A0;class&#x00A0;AuthenticationManager&#x00A0;implements&#x00A0;IAuthenticationManager&#x00A0;{
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;private&#x00A0;final&#x00A0;String&#x00A0;version&#x00A0;=&#x00A0;"example&#x00A0;1.0";
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;@Override
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;String&#x00A0;getVersion()&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;version;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;@Override
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;boolean&#x00A0;isPasswordChecked()&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;true;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;@Override
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;IAuthenticationResult&#x00A0;isAuthenticate(String&#x00A0;userid,&#x00A0;String&#x00A0;domain,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;String&#x00A0;password)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IAuthenticationResult&#x00A0;authenticationResult&#x00A0;=&#x00A0;new&#x00A0;AuthenticationResult();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;authenticationResult.setFailure();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;try&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if(SiteSecurity.isAuthenticUser(userid,&#x00A0;domain,&#x00A0;password))&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;authenticationResult.setSuccess();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;catch(Exception&#x00A0;e)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//TODO
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;authenticationResult;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;@Override
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;IAuthenticationResult&#x00A0;isGroupMember(String&#x00A0;userid,&#x00A0;String&#x00A0;domain,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Role&#x00A0;role)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;IAuthenticationResult&#x00A0;authenticationResult&#x00A0;=&#x00A0;new&#x00A0;AuthenticationResult();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;authenticationResult.setFailure();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;try&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;if(SiteSecurity.isAuthenticRole(userid,&#x00A0;domain,&#x00A0;role.toString()))&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;authenticationResult.setSuccess();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;catch(Exception&#x00A0;e)&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;//TODO
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;return&#x00A0;authenticationResult;
                                                                                                
                                                                                                
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 116--><p class="nopar" >
<!--l. 118--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.2   </span> <a 
 id="x1-20600012.1.2"></a>IAuthenticationManager</h4>
<!--l. 120--><p class="noindent" >Shown below is the interface which must be implemented by your authentication manager.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-113">
package&#x00A0;org.apache.uima.ducc.common.authentication;
&#x00A0;<br />
&#x00A0;<br />public&#x00A0;interface&#x00A0;IAuthenticationManager&#x00A0;{
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;/**
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;This&#x00A0;method&#x00A0;is&#x00A0;expected&#x00A0;to&#x00A0;return&#x00A0;AuthenticationManager&#x00A0;implementation&#x00A0;version
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;information.&#x00A0;&#x00A0;It&#x00A0;is&#x00A0;nominally&#x00A0;displayed&#x00A0;by&#x00A0;the&#x00A0;DUCC&#x00A0;webserver&#x00A0;on&#x00A0;the&#x00A0;Login/Logout
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;pages.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;Example&#x00A0;return&#x00A0;value:&#x00A0;Acme&#x00A0;Authenticator&#x00A0;1.0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@return&#x00A0;The&#x00A0;version&#x00A0;of&#x00A0;the&#x00A0;AuthenticationManager&#x00A0;implementation.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;String&#x00A0;getVersion();
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;/**
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;This&#x00A0;method&#x00A0;is&#x00A0;expected&#x00A0;to&#x00A0;return&#x00A0;password&#x00A0;checking&#x00A0;information.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;It&#x00A0;is&#x00A0;nominally&#x00A0;employed&#x00A0;by&#x00A0;the&#x00A0;DUCC&#x00A0;webserver&#x00A0;to&#x00A0;enable/disable
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;&#x00A0;password&#x00A0;input&#x00A0;area&#x00A0;on&#x00A0;the&#x00A0;Login/Logout&#x00A0;pages.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@return&#x00A0;True&#x00A0;if&#x00A0;the&#x00A0;AuthenticationManager&#x00A0;implementation&#x00A0;checks&#x00A0;passwords;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;false&#x00A0;otherwise.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;boolean&#x00A0;isPasswordChecked();
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;/**
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;This&#x00A0;method&#x00A0;is&#x00A0;expected&#x00A0;to&#x00A0;perform&#x00A0;authentication.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;It&#x00A0;is&#x00A0;nominally&#x00A0;employed&#x00A0;by&#x00A0;the&#x00A0;DUCC&#x00A0;webserver&#x00A0;for&#x00A0;submitted&#x00A0;Login&#x00A0;pages.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;userid
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;domain
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;password
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@return&#x00A0;True&#x00A0;if&#x00A0;authentic&#x00A0;userid+domain+password;&#x00A0;false&#x00A0;otherwise.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;IAuthenticationResult&#x00A0;isAuthenticate(String&#x00A0;userid,&#x00A0;String&#x00A0;domain,&#x00A0;String&#x00A0;password);
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;/**
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;This&#x00A0;method&#x00A0;is&#x00A0;expected&#x00A0;to&#x00A0;perform&#x00A0;role&#x00A0;validation.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;It&#x00A0;is&#x00A0;nominally&#x00A0;employed&#x00A0;by&#x00A0;the&#x00A0;DUCC&#x00A0;webserver&#x00A0;for&#x00A0;submitted&#x00A0;Login&#x00A0;pages.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;userid
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;domain
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@param&#x00A0;role
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;@return&#x00A0;True&#x00A0;if&#x00A0;authentic&#x00A0;userid+domain+role;&#x00A0;false&#x00A0;otherwise.
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;IAuthenticationResult&#x00A0;isGroupMember(String&#x00A0;userid,&#x00A0;String&#x00A0;domain,&#x00A0;Role&#x00A0;role);
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;/**
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*&#x00A0;The&#x00A0;supported&#x00A0;Roles
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;*/
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;enum&#x00A0;Role&#x00A0;{
                                                                                                
                                                                                                
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;User,
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Admin
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;}
&#x00A0;<br />}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 179--><p class="nopar" >
<!--l. 182--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.3   </span> <a 
 id="x1-20700012.1.3"></a>IAuthenticationResult</h4>
<!--l. 184--><p class="noindent" >Shown below is the interface which must be returned by the required authentication methods in your authentication
manager.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-114">
package&#x00A0;org.apache.uima.ducc.common.authentication;
&#x00A0;<br />
&#x00A0;<br />public&#x00A0;interface&#x00A0;IAuthenticationResult&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;setSuccess();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;setFailure();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;boolean&#x00A0;isSuccess();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;boolean&#x00A0;isFailure();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;setCode(int&#x00A0;code);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;int&#x00A0;getCode();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;setReason(String&#x00A0;reason);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;String&#x00A0;getReason();
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;void&#x00A0;setException(Exception&#x00A0;exception);
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;public&#x00A0;Exception&#x00A0;getException();
&#x00A0;<br />}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 202--><p class="nopar" >
<!--l. 204--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.4   </span> <a 
 id="x1-20800012.1.4"></a>Example ANT script to build jar</h4>
<!--l. 206--><p class="noindent" >Shown below is an example ANT script to build a ducc-authenticator.jar file. The resulting jar file should be placed user
DUCC&#8217;s lib directory along with any dependency jars, and defined in ducc.properties file.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-115">
&#x003C;project&#x00A0;name="uima-ducc-examples"&#x00A0;default="build"&#x00A0;basedir="."&#x003E;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;property&#x00A0;name="TGT-LIB"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;value="${basedir}/lib"&#x00A0;/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;property&#x00A0;name="TGT-DUCC-AUTH-JAR"&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;value="${TGT-LIB}/ducc-authenticator.jar"&#x00A0;/&#x003E;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;target&#x00A0;name="build"&#x00A0;depends="clean,&#x00A0;jar"&#x00A0;/&#x003E;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;target&#x00A0;name="clean"&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;delete&#x00A0;file="${TGT-DUCC-AUTH-JAR}"&#x00A0;/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;/target&#x003E;
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;target&#x00A0;name="jar"&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;mkdir&#x00A0;dir="${TGT-LIB}"&#x00A0;/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;jar&#x00A0;destfile="${TGT-DUCC-AUTH-JAR}"&#x00A0;basedir="${basedir}/target/classes/org/apache/uima/ducc/example/authentication/module"/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;/target&#x003E;
&#x00A0;<br />
&#x00A0;<br />&#x003C;/project&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 228--><p class="nopar" >
<!--l. 230--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.5   </span> <a 
 id="x1-20900012.1.5"></a>Example ducc.properties entries</h4>
<!--l. 232--><p class="noindent" >Shown here is a snippet of the ducc.properties file defining the class to be used for authentication and the administrator
created folder <span 
class="cmti-10">site-security</span>, which should contain the ducc-authenticator.jar you built plus any jar files upon which it
depends.
<!--l. 237--><p class="noindent" >Note: the <span 
class="cmti-10">site-security </span>directory must be located within DUCC&#8217;s lib directory.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-116">
#&#x00A0;The&#x00A0;class&#x00A0;that&#x00A0;performs&#x00A0;authentication&#x00A0;(for&#x00A0;the&#x00A0;WebServer)
&#x00A0;<br />ducc.authentication.implementer&#x00A0;=&#x00A0;org.apache.uima.ducc.example.authentication.module.AuthenticationManager
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;Site&#x00A0;specific&#x00A0;jars:&#x00A0;include&#x00A0;all&#x00A0;jars&#x00A0;in&#x00A0;directory&#x00A0;site-security
&#x00A0;<br />ducc.local.jars&#x00A0;=&#x00A0;site-security/*
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 246--><p class="nopar" >
<!--l. 248--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.1.6   </span> <a 
 id="x1-21000012.1.6"></a>Example ducc.administrators</h4>
<!--l. 250--><p class="noindent" >Example contents of ducc.administrators file located within DUCC&#8217;s resources directory. Only userids listed here can assume
the Administrator role when performing operations via the WebServer.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-117">
jdoe
&#x00A0;<br />fred
&#x00A0;<br />hal9000
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;</div>
<!--l. 258--><p class="nopar" >
<!--l. 20--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.2   </span> <a 
 id="x1-21100012.2"></a>Properties</h3>
<!--l. 22--><p class="noindent" >Public properties are in a primary configuration file is called ducc.properties and always resides in the directory
ducc_runtime/resources.
<!--l. 26--><p class="noindent" >Private properties are in a secondary configuration file call ducc.private.properties and always resides in the directory
ducc_runtime/resources/private.
<!--l. 30--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.3   </span> <a 
 id="x1-21200012.3"></a>Properties merging</h3>
<!--l. 33--><p class="noindent" >With DUCC 2.0.0 the shipped DUCC properties file is designed to be read-only. Installations create a local properties file
which is automatically merged with the default properties file as part of system startup.
<!--l. 37--><p class="noindent" >The shipped DUCC properties file is called <span 
class="cmti-10">default.ducc.properties</span>. This file should never be edited or modified.
<!--l. 40--><p class="noindent" >The local site override properties file is called <span 
class="cmti-10">site.ducc.properties</span>. This is a normal Java properties file containing
override and additional properties. An initial <span 
class="cmti-10">site.ducc.properties </span>is created on installation of DUCC 2.0.0 by
<span 
class="cmti-10">ducc</span><span 
class="cmti-10">_post</span><span 
class="cmti-10">_install</span>.
<!--l. 44--><p class="noindent" >On startup (<a 
href="#x1-23700012.9.1"><span 
class="cmti-10">start</span><span 
class="cmti-10">_ducc</span></a>), verification (<a 
href="#x1-24900012.9.3"><span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc</span></a>), and RM reconfiguration (<a 
href="#x1-25300012.9.4"><span 
class="cmti-10">rm</span><span 
class="cmti-10">_reconfigure</span></a>), the two properties files are
merged, with <span 
class="cmti-10">site.ducc.properties </span>taking preference, to create the operational file, <span 
class="cmti-10">ducc.properties</span>, which is used by all DUCC
compononts. This file should not be edited as it will be over-written whenever <span 
class="cmti-10">start</span><span 
class="cmti-10">_ducc </span>or <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc </span>is
run.
<!--l. 55--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.4   </span> <a 
 id="x1-21300012.4"></a>ducc.properties</h3>
<!--l. 58--><p class="noindent" >Some of the properties in ducc.properties are intended as the &#8221;glue&#8221; that brings the various DUCC components together and
lets then run as a coherent whole. These types of properties should be modified only by developers of DUCC itself. In the
description below these properties are classified as &#8221;Private&#8221;.
<!--l. 63--><p class="noindent" >Some of the properties are tuning parameters: timeouts, heartbeat intervals, and so on. These may be modified by DUCC
administrators, but only after experience is gained with DUCC, and only to solve specific performance problems. The default
tuning parameters have been chosen by the DUCC system developers to provide &#8221;best&#8221; operation under most reasonable
situations. In the description below these properties are classified as &#8221;Tuning&#8221;.
                                                                                                
                                                                                                
<!--l. 69--><p class="noindent" >Some of the properties describe the local cluster configuration: the location of the ActiveMQ broker, the location of the Java
JRE, port numbers, etc. These should be modified by the DUCC administrators to configure DUCC to each individual
installation. In the description below these properties are classified as &#8221;Local&#8221;.
<!--l. 74--><p class="noindent" >See also
<!--l. 76--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.1   </span> <a 
 id="x1-21400012.4.1"></a>General DUCC Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.authentication.implementer</span> </dt><dd 
class="description">                                                                                        <br 
class="newline" />This specifies the class used for WebServer session authentication. If unconfigured, the Web Server enforces no
     authentication.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">org.apache.uima.ducc.common.authentication.LinuxAuthenticationManager
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.authentication.users.include</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />Specify users allowed to log in to the web server. This is used only if <span 
class="cmti-10">ducc.authentication.implementor </span>is the
     LinuxAuthenticationManager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">All users may log in.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.authentication.users.exclude</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />Specify users not allowed to log in to the webserver. This is used only if <span 
class="cmti-10">ducc.authentication.implementor </span>is the
     LinuxAuthenticationManager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">No users are excluded.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.authentication.groups.include</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" />Specify groups allowed to log in. Groups are defined by Unix authentication. Only users in the groups
     specified here may log in to the web server. This is used only if <span 
class="cmti-10">ducc.authentication.implementor </span>is the
     LinuxAuthenticationManager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">Users in all groups may log in.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.authentication.groups.exclude</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" />Specify groups not allowed to log in. Groups are defined by Unix authentication. Users in the groups
     specified here may not log in to the web server. This is used only if <span 
class="cmti-10">ducc.authentication.implementor </span>is the
                                                                                                
                                                                                                
     LinuxAuthenticationManager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">No users are excluded due to group membership.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.admin.endpoint</span> </dt><dd 
class="description">                                                                                                       <br 
class="newline" />This is the JMS endpoint name used for DUCC administration messages.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">ducc.admin.channel
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.admin.endpoint.type</span> </dt><dd 
class="description">                                                                                                 <br 
class="newline" />This is the JMS message type used for DUCC administration requests. If changed DUCC admin may not
     work.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.automanage</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />If set to &#8220;true&#8221;, DUCC will start and stop the ActiveMQ broker as part of its normal start/stop scripting.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.configuration</span> </dt><dd 
class="description">                                                                                                 <br 
class="newline" />This is the ActiveMQ configuration file to use, for auto-managed brokers only. The path must be specified relative to
     the ActiveMQ installation directory.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">conf/activemq-ducc.xml
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.credentials</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />This is the ActiveMQ credentials file used to authenticate DUCC daemons with the broker, for auto-managed brokers
     only.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">$ducc.private.resources/ducc-broker-credentials.properties
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.home</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />For DUCC auto-managed brokers only, this names the location where ActiveMQ is installed installed.
                                                                                                
                                                                                                
     <!--l. 164--><p class="noindent" >Note that the DUCC installation includes a default ActiveMQ.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">$DUCC_HOME/activemq
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.memory.options</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />For DUCC auto-managed brokers only, this names the ActiveMQ configuration file. The configuration file is
     assumed to reside in the directory specified by <span 
class="cmti-10">ducc.broker.home</span>, so the path must be relative to that
     location.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">conf/activemq-ducc.xml
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.url.decoration</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />The property is used by the DUCC Job Driver processes to modify the ActiveMQ broker URL when connecting to the
     Job Processes.
     <!--l. 184--><p class="noindent" >The supplied default is used to disable broker connection timeouts. From the ActiveMQ documentation: &#8221;The
     maximum inactivity duration (before which the socket is considered dead) in milliseconds. On some platforms it can
     take a long time for a socket to appear to die, so we allow the broker to kill connections if they are inactive
     for a period of time. Use by some transports to enable a keep alive heart beat feature. Set to a value
     less-than-or-equal0 to disable inactivity monitoring. Declare the wire protocol used to communicate with
     ActiveMQ.&#8221;
     <!--l. 192--><p class="noindent" >This decoration is used to keep the broker connection alive while a JVM is in a long garbage collection. The
     applications that DUCC is designed to support can spend significant time in garbage collection, which
     can cause spurious timeouts. By default the DUCC configuration disables the timeout by setting it to
     0.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">wireFormat.maxInactivityDuration=0
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.hostname</span> </dt><dd 
class="description">                                                                                                      <br 
class="newline" />This declares the node where the ActiveMQ broker resides. It MUST be updated to the actual node where the broker is
     running as part of DUCC installation. The default value will not work.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">$<span 
class="cmsy-10">{</span>ducc.head<span 
class="cmsy-10">}</span>. The default is defined in the ducc property, <span 
class="cmti-10">ducc.head</span>. If you want to run the ActiveMQ
         broker on the &#8220;ducc head&#8221;, this parameter need not be changed.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.jmx.port</span> </dt><dd 
class="description">                                                                                                       <br 
class="newline" />This is the port used to make JMX connections to the broker. This should only be changed by administrators familiar
     with ActiveMQ configuration.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">1100
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.memory.options</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />For DUCC auto-managed brokers only, this sets the <span 
class="cmtt-10">-Xmx </span>heap size for the broker.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx2G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.name</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />This is the internal name of the broker, used to locate Broker&#8217;s MBean in JMX Registry. It is NOT
     related to any node name. When using the ActiveMQ distribution supplied with DUCC it should always
     be set to &#8221;localhost&#8221;. The default should be changed only by administrators familiar with ActiveMQ
     configuration.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">localhost
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.port</span> </dt><dd 
class="description">                                                                                                             <br 
class="newline" />This declares the port on which the ActiveMQ broker is listening for messages. It MAY be updated as
     part of DUCC installation. ActiveMQ ships with port 61616 as the default port, and DUCC uses that
     default.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">61617
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.protocol</span> </dt><dd 
class="description">                                                                                                        <br 
class="newline" />Declare the wire protocol used to communicate with ActiveMQ.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">tcp
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.broker.server.url.decoration</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />For DUCC auto-managed brokers only, this configures ActiveMQ Server url decoration.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">transport.soWriteTimeout=45000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.cli.httpclient.sotimeout</span> </dt><dd 
class="description">                                                                                             <br 
class="newline" />This is the timeout used by the CLI to communicate with DUCC, in milliseconds. If no response is heard within
     this time, the request times out and is aborted. When set to 0 (the default), the request never times
     out.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">0
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.cluster.name</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />This is a string used in the Web Server banner to identify the local cluster. It is used for informational purposes only
     and may be set to anything desired.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">Apache UIMA-DUCC
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.head</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This property declares the node where the DUCC adminstrative processes run (Orchestrator, Resource
     Manager, Process Manager, Service Manager). This property is required and MUST be configured in new
     installation. The installation script <a 
href="#x1-19600011.7">ducc_post_install</a> initializes this property to the node the script is executed
     on.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">There is no default, this must be configured during system installation.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jms.provider</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />Declare the type of middleware providing the JMS service used by DUCC.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">activemq
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jmx.port</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />Every process started by DUCC has JMX enabled by default. When more than one process runs on the same machine
     this can cause port conflicts. The property &#8221;ducc.jmx.port&#8221; is used as the base port for JMX. If the port is busy, it is
     incremented internally until a free port is found.
     <!--l. 307--><p class="noindent" >The web server&#8217;s <a 
href="#x1-1550007.8.3">&#8221;System <span 
class="cmsy-10">- </span><span 
class="cmmi-10">&#x003E; </span>Daemons&#8221;</a> tab is used to find the JMX URL that gets assigned to each of the DUCC
     management processes. The web server&#8217;s <a 
href="#x1-1390007.3">Job details</a> page for each job is used to find the JMX URL that is assigned to
     each JP.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">2099
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jvm</span> </dt><dd 
class="description">                                                                                                                       <br 
class="newline" />This specifies the full path to the JVM to be used by the DUCC processes. This MUST be configured. The installation
     script <a 
href="#x1-19600011.7">ducc_post_install</a> initializes this property to full path to &#8220;java&#8221; in the installer&#8217;s environment. (If the &#8220;java&#8221;
     command cannot be found, ducc_post_install exits with error.)
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">None. Must be configured during installation.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.node.min.swap.threshold</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />Specify a minimum amount of free swap space available on a node. If an agent detects free swap space dipping below
     the value defined below, it will find the fattest (in terms of memory) process in its inventory and kill it. The value of
     the parameter below is expressed in bytes.
     <!--l. 335--><p class="noindent" >If set to 0, the threshold is disabled.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">0
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.jvm.args</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />This specifies the list of arguments passed to the JVM when spawning the Agent.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx100M
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.driver.jvm.args</span> </dt><dd 
class="description">                                                                                                        <br 
class="newline" />If enabled, the arguments here are automatically added to the JVM arguments specified for the Job Driver
     process.
     <!--l. 354--><p class="noindent" >Note: if the user-supplied JVM arguments contain a -Xmx entry then any -Xmx value specified here will be
     ignored.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">(unconfigured)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.driver.jetty.max.threads</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />Max number of threads in Jetty thread pool servicing incoming HTTP requests.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">100
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.driver.jetty.thread.idletime</span> </dt><dd 
class="description">                                                                                        <br 
class="newline" />Max idle time for jetty threads (in milliseconds). When a thread exceeds its idle time it will be terminated.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">60000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.jvm.args</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />This specifies the list of arguments passed to the JVM when spawning the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx1G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.jvm.args</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This specifies the list of arguments passed to the JVM when spawning the Process Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx1G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.process.jvm.args</span> </dt><dd 
class="description">                                                                                                      <br 
class="newline" />If enabled, the arguments here are added by DUCC to the JVM arguments in the user&#8217;s job processes.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">(unconfigured)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.jvm.args</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This specifies the list of arguments passed to the JVM when spawning the Resource Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx1G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.jvm.args</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />This specifies the list of arguments passed to the JVM when spawning the Service Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx1G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.jvm.args</span> </dt><dd 
class="description">                                                                                                            <br 
class="newline" />specifies the list of arguments passed to the JVM when spawning the Webserver.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">-Xmx8G
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.locale.language</span> </dt><dd 
class="description">                                                                                                        <br 
class="newline" />Establish the language for national language support of messages. Currently only &#8221;en&#8221; is supported.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">en
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.locale.country</span> </dt><dd 
class="description">                                                                                                          <br 
class="newline" />Establish the country for National Language Support of messages. Currently only &#8221;us&#8221; is supported.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">us
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.runmode</span> </dt><dd 
class="description">                                                                                                                <br 
class="newline" />When set to &#8221;Test&#8221; this property bypasses userid and authentication checks. It is intended for use ONLY by DUCC
     developers. It allows developers of DUCC to simulate a multiuser environment without the need for root
     privileges.
     <!--l. 444--><p class="noindent" >Note: WARNING! Enabling this feature in a production DUCC system is a serious security breach. It should only be
     set by DUCC developers running with an un-privileged ducc_ling.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">Unconfigured. When unconfigured, test mode is DISABLED.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.signature.required</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />When set, the CLI signs each request so the Orchestrator can be sure the requestor is actually who he claims to
     be.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">on
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.threads.limit</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />This enforces a maximum number of pipeline threads per job, over all its processes. No job will have more active
     work-items than this dispatched. This limit is disabled by default.
     <!--l. 466--><p class="noindent" >The value represents the size of the underlying CAS pool in the Job Driver and therefore is related to the size of the
     Job Driver heap and the real memory consumed by JD. If the JD is consuming too much memory, try setting or
     reducing this value.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">(unconfigured)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.environment.propagated</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />This specifies the environmental variables whose values will be merged with the user-specified environment option on
     job, process and service submissions.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default</span> </dt><dd 
class="description">USER HOME LANG DUCC_SERVICE_INSTANCE
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd></dl>
<!--l. 487--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.2   </span> <a 
 id="x1-21500012.4.2"></a>Web Server Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.ws.configuration.class</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />The name of the pluggable java class used to implement the Web Server.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.ws.config.WebServerConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.node</span> </dt><dd 
class="description">                                                                                                                 <br 
class="newline" />This is the name of the node the web server is started on. If not specified, the web server is started on
     <span 
class="cmtt-10">$</span><span 
class="cmsy-10">{</span><span 
class="cmtt-10">ducc</span><span 
class="cmtt-10">&#x1E23;ead</span><span 
class="cmsy-10">}</span>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">(unconfigured)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.ipaddress</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />In multi-homed systems it may be necessary to specify to which of the multiple addresses the Web Server listens for
     requests. This property is an IP address that specifies to which address the Web Server listens.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">(unconfigured)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.port</span> </dt><dd 
class="description">                                                                                                                  <br 
class="newline" />This is the port on which the DUCC Web Server listens for requests.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">42133
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.port.ssl</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />This is the port that the Web Server uses for SSL requests (such as authentication).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">42155
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.session.minutes</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />Once authenticated, this property determines the lifetime of the authenticated session to the Web Server.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">60
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.max.history.entries</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />DUCC maintains a history of all jobs. The state of jobs, both old and current are shown in the Webserver&#8217;s Jobs Page.
     To avoid overloading this page and the Web Server, the maximum number of entries that can be shown is regulated by
     this parameter.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">4096
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.login.enabled</span> </dt><dd 
class="description">                                                                                                      <br 
class="newline" />If true, users are allowed to login to Webserver. If false, users are not allowed to login to Webserver. Shipped value set
     to false. However, default value if property not specified is true.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.precalculate.machines</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />This is a choice between updating the sorted internal representation of the Machines page as each Agent
     publication arrives (true, somewhat CPU intensive in a large cluster but fast browser response time) and
     updating only upon viewer demand (false, CPU intensive for each browser request with slower response
     time).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.automatic.cancel.minutes</span> </dt><dd 
class="description">                                                         &#x00A0;Optionally configure the
     webserver job automatic cancel timeout. To disable this feature specify 0. This is employed when a user
     specifies <span 
class="cmsy-10">--</span><span 
class="cmti-10">wait</span><span 
class="cmti-10">_for</span><span 
class="cmti-10">_completion </span>flag on job submission, in which case the job monitor program must
     visit
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-118">
     &#x00A0;&#x00A0;&#x00A0;http://&#x003C;host&#x003E;:&#x003C;port&#x003E;/ducc-servlet/proxy-job-status?id=&#x003C;job-id&#x003E;</div>
     <!--l. 571--><p class="nopar" > within this expiry time. Otherwise the job will be automatically canceled.
     <!--l. 574--><p class="noindent" >This provides a safeguard against runaway jobs or managed reservations, if the submitter gets disconnected from
     DUCC in some way.
     <!--l. 577--><p class="noindent" >If the feature is disabled by specifing &#8220;0&#8221;, no work is canceled even if the monitor itself disappears.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">10
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.jsp.compilation.directory</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />This specifies the temporary used by the Web Server&#8217;s JSP engine to compile its JSPs.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">/tmp/ducc/jsp
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.requestLog.RetainDays</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />Optionally configure the webserver request log, default, if not configured, is 0 (meaning no request logging). Logs are
     written to DUCC_HOME/logs/webserver.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">30
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.ws.visualization.strip.domain</span> </dt><dd 
class="description">                                                                                      <br 
class="newline" />If set, the visualization will strip domain names from nodes to present a cleaner visualization.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd></dl>
<!--l. 610--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.3   </span> <a 
 id="x1-21600012.4.3"></a>Job Driver Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.jd.configuration.class</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />The name of the pluggable java class used to implement the Job Driver.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.jd.config.JobDriverConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.state.update.endpoint</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />This is the JMS endpoint name by the Job Driver to send state to the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.jd.state
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.startup.initialization.error.limit</span> </dt><dd 
class="description">                                                                               <br 
class="newline" />For a newly started Job, the number of JP UIMA initialization failures allowed until at least one JP succeeds -
     otherwise, the Job self-destructs.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">1
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.state.update.endpoint.type</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" />This is the JMS message type used to send state to the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.state.publish.rate</span> </dt><dd 
class="description">                                                                                                  <br 
class="newline" />The interval in milliseconds between JD state publications to the Orchestrator. A higher rate (smaller number) may
     slightly increase system response but will increase network load. A lower rate will somewhat decrease system response
     and lower network load.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">15000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.queue.prefix</span> </dt><dd 
class="description">                                                                                                        <br 
class="newline" />This is a human-readable string used to form queue names for the JMS queues used to pass CASs from the Job Driver
     to the Job Processes. The completed queue named comprises the prefix concatenated with the DUCC assigned Job
     number.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.jd.queue.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.queue.timeout.minutes</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />After dispatching a work item to UIMA-AS client for processing, the number of minutes that the Job
                                                                                                
                                                                                                
     Driver will wait for two callbacks (queued and assigned) before considering the work item lost. The
     elapsed time for the callbacks is normally sub-second. Intermittent network problems may cause unusual
     spikes.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">5
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.jd.share.quantum</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />When CGroups are enabled, this is the RSS, in MB, that is reserved for each JD process, and enforced by the CGroup
     support. Larger JDs are permitted, but the CGroup support will force the excess RSS onto swap. This
     potentially slows the performance of that JD, but preserves the resources for other, better-behaved,
     JDs.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">400
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd></dl>
<!--l. 692--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.4   </span> <a 
 id="x1-21700012.4.4"></a>Service Manager Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.sm.configuration.class</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the name of the pluggable java class used to implement the Service Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.sm.config.JobDriverConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.default.monitor.class</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />This is the name of the default UIMA-AS ping/monitor class. The default class issues <span 
class="cmti-10">get-meta </span>to a service and uses
     JMX to fetch queue statistics for presentation in the web server.
     <!--l. 707--><p class="noindent" >This name is either
         <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
       1. </dt><dd 
class="enumerate-enumitem">The fully qualified name of the class to use as the default UIMA-AS pinger. It may be necessary to include
         the class or jar file in the classpath used to start the SM. (The reccomended way to do this is add an
         entry to the <span 
class="cmti-10">ducc.local.jars </span>property in <span 
class="cmti-10">ducc.properties.</span>
         </dd><dt class="enumerate-enumitem">
       2. </dt><dd 
class="enumerate-enumitem">The name of a pinger registration file. This is the reccomended way to provide installation-customized
         pingers. See the <a 
href="#x1-28500014">Service Management</a> chapter for details of setting up this file. In short, it resides in
         <span 
class="cmti-10">ducc.properties </span>and contains the full set of ping-related properties needed to run a pinger.</dd></dl>
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.cli.UimaAsPing
                                                                                                
                                                                                                
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.state.update.endpoint</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />This is the JMS endpoint name used for state messages sent by the Service Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.sm.state
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.state.update.endpoint.type</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" />This is the JMS message type used for state messages sent by the Service Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.meta.ping.rate</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />This is the time, in milliseconds, between pings by the Service Manager to each known, running service.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">60000
         </dd><dt class="description">
     <span 
class="cmbx-10">Typ</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.meta.ping.stability</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the number of consecutive pings that may be missed before a service is considered unavailable.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">10
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.meta.ping.timeout</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the time in milliseconds the SM waits for a response to a ping. If the service does not respond within this time
     the ping is accounted for as a &#8221;missed&#8221; ping.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">15000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.http.port</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />This is the HTTP port used by the Service Manager to field requests from the CLI / API.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">19989
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.http.node</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />This is the node where the Service Manager runs. It MUST be configured as part of DUCC setup. The <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_post</span><span 
class="cmti-10">_install</span>
     procedures initialize this to <span 
class="cmsl-10">$</span><span 
class="cmsy-10">{</span><span 
class="cmti-10">ducc.head</span><span 
class="cmsy-10">}</span>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">$<span 
class="cmsy-10">{</span>ducc.head<span 
class="cmsy-10">}</span>
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.default.linger</span> </dt><dd 
class="description">                                                                                                      <br 
class="newline" />This is the length of time, in milliseconds, that the SM allows a service to remain alive after all jobs that reference it
     have exited. If no new job referencing it enters the system before this time has expired, the SM stops the
     service.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">300000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.init.failure.limit</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />This is the maximum number of consecutive failures of service instance initialization permitted before DUCC stops
     creating new instances. When this cap is hit the SM will disable autostart for the service. It may be overridden by the
     service registration&#8217;s <span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_limit </span>parameter.
     <!--l. 793--><p class="noindent" >NOTE: This was <span 
class="cmti-10">ducc.sm.instance.failure.max </span>which is now deprecated.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">2
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.instance.failure.limit</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />This is the maximum number of instance failures allowed within some period of time before the Service Manger disables
     <span 
class="cmti-10">autostart </span>and ceases to restart instances automatically. The time window for failures is defined with the property
     <span 
class="cmti-10">ducc.sm.instance.failure.window</span>.
     <!--l. 805--><p class="noindent" >This may be overridden by individual service pingers using the registration property <span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_limit</span>. See the
     <a 
href="#x1-620003.11.2">service registration options</a> for details.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">5
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.sm.instance.failure.window</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />This specifies a window of time in minutes over which some number of service instance failures are tolerated. If the
     maximum number of tolerated failures is exceeded within this time window the Service Manager ceases to restart
     instances automatically. The maximum tolerated failures is defined in <span 
class="cmti-10">ducc.sm.instance.failure.limit</span>.
     <!--l. 822--><p class="noindent" >This may be overridden by individual service pingers using the registration property <span 
class="cmti-10">instance</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_window</span>. See the
     <a 
href="#x1-620003.11.2">service registration options</a> for details.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">30 (minutes)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd></dl>
<!--l. 835--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.5   </span> <a 
 id="x1-21800012.4.5"></a>Orchestrator Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator. configuration.class</span> </dt><dd 
class="description">                                                                                  <br 
class="newline" />This is the name of the pluggable java class used to implement the DUCC Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.orchestrator.config.OrchestratorConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.start.type</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />This indicates the level of recovery to be taken on restarting a system. There are two levels of startup:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">cold</span> </dt><dd 
class="description">All  reservations  are  canceled,  all  currently  running  jobs  (if  any)  are  terminated.  All  services  are
         terminated. The system starts with no jobs, reservations, or services active.
         </dd><dt class="description">
     <span 
class="cmbx-10">warm</span> </dt><dd 
class="description">All unmanaged reservations are restored. All currently running jobs (if any) are terminated. All services
         are started or restarted as indicated by their state when the system went down. The system starts with
         no jobs active, but unmanaged reservations and services are preserved.
         </dd><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">warm
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.state.endpoint</span> </dt><dd 
class="description">                                                                                        <br 
class="newline" />This is the name of the JMS endpoint through which the Orchestrator broadcasts its full state messages. These
     messages include full job information and can be large. This state is used by the Process Manager and the
     Webserver.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.orchestrator.request?requestTimeout=180000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.state.update.endpoint.type</span> </dt><dd 
class="description">                                                                        <br 
class="newline" />This is the JMS endpoint type used for the &#8221;full&#8221; state messages sent by the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
                                                                                                
                                                                                                
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.state.publish.rate</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" /><a 
 id="likesection.6"></a>
     <!--l. 882--><p class="noindent" >The interval in milliseconds between Orchestrator publications of its non-abbreviated state.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">10000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.maintenance.rate</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" />This is the interval in milliseconds between Orchestrator maintenance cycles, which check and update history and
     state.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">60000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.http.port</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the HTTP port used by the Orchestrator to field requests from the CLI / API.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">19988
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.http.node</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />This is the node where the Orchestrator runs. It MUST be configured as part of DUCC setup. The <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_post</span><span 
class="cmti-10">_install</span>
     procedures initialize this to <span 
class="cmsl-10">$</span><span 
class="cmsy-10">{</span><span 
class="cmti-10">ducc.head</span><span 
class="cmsy-10">}</span>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">$<span 
class="cmsy-10">{</span>ducc.head<span 
class="cmsy-10">}</span>
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.orchestrator.unmanaged.reservations.accepted</span> </dt><dd 
class="description">                                                               <br 
class="newline" />This flag controls whether the Orchestrator will accept requests for unmanaged reservations (true) or deny request for
     unmanaged reservations (false).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 922--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.6   </span> <a 
 id="x1-21900012.4.6"></a>Resource Manager Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.rm.configuration.class</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the name of the pluggable java class used to implement the DUCC Resource Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.rm.config.ResourceManagerConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.state.update.endpoint</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />This is the name of the JMS endpoint through which the Resource Manager broadcasts its abbreviated
     state.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.rm.state
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.state.update.endpoint.type</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" />This is the JMS endpoint type used for state messages sent by the Resource Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.state.publish.ratio</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />This specifies the frequency of RM schedules, relative to the number of Orchestrator publications. If the value is set to
     1, RM runs and publishes a schedule immediately on receipt of OR state. If set to some number N, RM runs a schedule
     after receipt of every N Orchestrator publications.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">1
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.share.quantum</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />The share quantum is the smallest amount of RAM that is schedulable for jobs, in GB. Jobs are scheduled based
     entirely on their memory requirements. Memory is allocated in multiples of the share quantum.
     <!--l. 962--><p class="noindent" >See the <a 
href="#x1-27500013">Resource Management</a> section for more information on the share quantum.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">1
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.global.allotment</span> </dt><dd 
class="description">                                                                                                  <br 
class="newline" />This specifies the maximum non-preemptable shares any user may be awarded, in GB. If not configured, there is no
                                                                                                
                                                                                                
     maximum enforced. This can be overridden on a per-user basis in the user registry. See the <a 
href="#x1-27500013">Resource Management</a>
     section for more information on the share quantum.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">(not set, no limit imposed)
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.scheduler</span> </dt><dd 
class="description">                                                                                                           <br 
class="newline" />The component that implements the scheduling algorithm is pluggable. This specifies the name of that
     class.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.rm.scheduler.NodepoolScheduler
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.user.registry</span> </dt><dd 
class="description">                                                                                                       <br 
class="newline" />This names the file with the user registr, within the DUCC_HOME/resources directoryy. As of this version of DUCC,
     the registry is used only to override the global allotments. The registry entries may also be placed in the <a 
href="#x1-22500012.6"><span 
class="cmti-10">ducc.classes</span></a>
     file if desired.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.users
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.class.definitions</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />This specifies the name of the file that contains the site&#8217;s class definitions. This file is described in detail in the
     <a 
href="#x1-22500012.6"><span 
class="cmti-10">ducc.classes</span></a> section.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.classes
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.node.stability</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />The RM receives regular &#8221;heartbeats&#8221; from the DUCC agents in order to know what nodes are available for scheduling.
     The node.stability property configures the number of consecutive heartbeats that may be missed before the Resource
     Manager considers the node to be inoperative.
     <!--l. 1009--><p class="noindent" >If a node becomes inoperative, the Resource Manager deallocates all processes on that node and attempts to
     reallocate them on other nodes. The node is marked offline and is unusable until its heartbeats start up
     again.
     <!--l. 1013--><p class="noindent" >The default configuration declares the agent heartbeats to occur at 1 minute intervals. Therefore heartbeats must be
     missed for five minutes before the Resource Manager takes corrective action.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">5
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.init.stability</span> </dt><dd 
class="description">                                                                                                       <br 
class="newline" />During DUCC initialization the Resource Manager must wait some period of time for all the nodes in
     the cluster to check-in via their &#8221;heartbeats&#8221;. If the RM were to start scheduling too soon there would
     be a period of significant &#8221;churn&#8221; as the perceived cluster configurations changes rapidly. As well, it
     would be impossible to recover work in a warm or hot start if the affected nodes had not yet checked
     in.
     <!--l. 1029--><p class="noindent" >The init.stability property indicates how many heartbeat intervals the RM must wait before it starts scheduling after
     initialization.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">2
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.eviction.policy</span> </dt><dd 
class="description">                                                                                                    <br 
class="newline" />The alternative value is SHRINK_BY_MACHINE.
     <!--l. 1039--><p class="noindent" >The eviction.policy is a heuristic to choose which processes of a job to preempt because of competition from other
     jobs.
     <!--l. 1042--><p class="noindent" >The SHRINK_BY_INVESTMENT policy attempts to preempt processes such that the least amount of work is lost. It
     chooses candidates for eviction in order of:
         <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
       1. </dt><dd 
class="enumerate-enumitem">Processes still initializing, with the smallest time spent in the initializing step.
         </dd><dt class="enumerate-enumitem">
       2. </dt><dd 
class="enumerate-enumitem">Processes whose currently active work items have been executing for the shortest time.</dd></dl>
     <!--l. 1049--><p class="noindent" >The SHRINK_BY_MACHINE policy attempts to preempt processes so as to minimize fragmentation on machines with
     large memories that can contain multiple job processes. No consideration of execution time or initialization time is
     made.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">SHRINK_BY_INVESTMENT
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.initialization.cap</span> </dt><dd 
class="description">                                                                                                  <br 
class="newline" />The type of jobs supported by DUCC generally have very long and often fragile initialization periods. Errors in the
     applications and other problems such is missing or errant services can cause processes to fail during this
     phase.
     <!--l. 1063--><p class="noindent" >To avoid preempting running jobs and allocating a large number of resources to jobs only to fail during initialization,
     the Resource Manager schedules a small number of processes until it is determined that the initialization phase will
     succeed.
     <!--l. 1067--><p class="noindent" >The initialization.cap determines the maximum number of processes allocated to a job until at least one process
     successfully initializes. Once any process initializes the Resource Manager will proceed to allocate the job its full fair
     share of processes.
     <!--l. 1071--><p class="noindent" >The initialization cap can be overridden on a class basis by configuration via <a 
href="#x1-22500012.6">ducc.classes</a>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">1
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.expand.by.doubling</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />When a job expands because its fair share has increased, or it has completed initialization, it may be desired
     to govern the rate of expansion. If expand.by.doubling is set to &#8221;true&#8221;, rather than allocate the full
     fair share of processes, the number of processes is doubled each scheduling cycle, up to the maximum
     allowed.
     <!--l. 1086--><p class="noindent" >Expand.by.doubling can be overridden on a class basis by configuration via <a 
href="#x1-22500012.6">ducc.classes</a>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.prediction</span> </dt><dd 
class="description">                                                                                                          <br 
class="newline" />Because initialization time may be very long, it may be the case that a job that might be eligible for expansion will be
     able to complete in the currently assigned shares before any new processes are able to complete their initialization. In
     this case expansion results in waste of resources and potential eviction of processes that need not be
     evicted.
     <!--l. 1101--><p class="noindent" >The Resource Manager monitors the rate of task completion and attempts to predict the maximum number of processes
     that will be needed at a time in the future based on the known process initialization time. If it is determined that
     expansion is unnecessary then it is not done for the job.
     <!--l. 1106--><p class="noindent" >Prediction can be overridden on a class basis by configuration via <a 
href="#x1-22500012.6">ducc.classes</a>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.prediction.fudge</span> </dt><dd 
class="description">                                                                                                  <br 
class="newline" /><a 
 id="likesection.7"></a>
     <!--l. 1117--><p class="noindent" >When ducc.rm.prediction is enabled, the known initialization time of a job&#8217;s processes plus some &#8221;fudge&#8221; factor is used
     to predict the number of future resources needed. The &#8221;fudge&#8221; is specified in milliseconds.
     <!--l. 1121--><p class="noindent" >The default &#8221;fudge&#8221; is very conservative. Experience and site policy should be used to set a more practical
     number.
     <!--l. 1124--><p class="noindent" >Prediction.fudge can be overridden on a class basis by configuration via <a 
href="#x1-22500012.6">ducc.classes</a>.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">120000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.defragmentation.threshold</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" /><a 
 id="likesection.8"></a>
     <!--l. 1136--><p class="noindent" >If <span 
class="cmti-10">ducc.rm.defragmentation </span>is enable, limited defragmentation of resources is performed by the Resource
     Manager to create sufficient space to schedule work that has insufficient resources (new jobs, for example.).
     The term <span 
class="cmti-10">insufficient </span>is defined as &#8220;needing more processes than the defragmentation threshold, but
     currently having fewer processes than the defragmentation threshold.&#8221; These are called &#8220;needy&#8221; jobs.
                                                                                                
                                                                                                
     Additionally, the Resource Manager will never evict processes from &#8220;needy&#8221; jobs for the purpose of
     defragmentation.
     <!--l. 1144--><p class="noindent" >This property allows installations to customize the value used to determine if a job is &#8220;needy&#8221;. Jobs with fewer
     processes than this are potentially needed, and jobs with more processes are never needy.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">8
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.admin.endpoint</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />This JMS endpoint used for RM administrative requests.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.rm.admin.channe.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.rm.admin.type</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />This is the JMS endpoint type used for RM administrative requests.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.rm.admin.channe.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd></dl>
<!--l. 1172--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.7   </span> <a 
 id="x1-22000012.4.7"></a>Agent Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.agent.configuration.class</span> </dt><dd 
class="description">                                                                                            <br 
class="newline" />This is the name of the pluggable java class used to implement the DUCC Agents.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.nodeagent.config.AgentConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.request.endpoint</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />This is the JMS endpoint through which agents receive state from the Process Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.agent
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.request.endpoint.type</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />This is the JMS endpoint type used for state messages sent by the Process Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.managed.process.state.update.endpoint</span> </dt><dd 
class="description">                                                                <br 
class="newline" />This is the JMS endpoint used to communicate from the managed process to the Agent (Job Process).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.managed.process. state.update
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.managed.process.state.update.endpoint.type</span> </dt><dd 
class="description">                                                          <br 
class="newline" />This is the JMS endpoint type used to communicate from the managed process (Job Process) to the
     Agent.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">socket
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.managed.process. state.update.endpoint.params</span> </dt><dd 
class="description">                                                     <br 
class="newline" />These are configuration parameters for the Agent-to-JP communication socket. These should only be modified by
     DUCC developers.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">transferExchange=true&amp;sync=false
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.metrics.endpoint</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />This is the JMS endpoint used to send node metrics updates to listeners. Listeners are usually the Resource Manager
     and Web Server. These messages serve as node &#8221;heartbeats&#8221;. As well, the node metrics heartbeats contain the amount
     of RAM on the node and the number of processors.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.node.metrics
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.metrics.endpoint.type</span> </dt><dd 
class="description">                                                                                <br 
class="newline" />This is the JMS endpoint type used to send node metrics updates from the agents.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.metrics.publish.rate</span> </dt><dd 
class="description">                                                                                   <br 
class="newline" />The interval in milliseconds between node metric publications. Every agent publishes its updates at this rate. On large
     clusters, a high rate (small interval) can be a burden on the network.
     <!--l. 1243--><p class="noindent" >Note: the Resource Manager uses the data in the node metrics for scheduling.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">60000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.inventory.endpoint</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" />This is the JMS endpoint used to send node inventory messages to listeners. Listeners are usually the
     Orchestrator and Web Server. Information in these messages include a map of processes being managed on the
     node.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.node.inventory
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.inventory.endpoint.type</span> </dt><dd 
class="description">                                                                              <br 
class="newline" />This is the JMS endpoint type used to send node inventory updates from the agents.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.inventory.publish.rate</span> </dt><dd 
class="description">                                                                                <br 
class="newline" />The interval in milliseconds between node inventory publications.
     <!--l. 1268--><p class="noindent" >If the inventory has not changed since the last update the agent bypasses sending the update, up to a maximum of
     ducc.agent.node.inventory.publish.rate.skip times.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">10000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.node.inventory.publish.rate.skip</span> </dt><dd 
class="description">                                                                          <br 
class="newline" />This is the number of times the agent will bypass publishing its node inventory if the inventory has not
     changed.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">30
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.thread.pool.size</span> </dt><dd 
class="description">                                                                                   <br 
class="newline" />This is establishes the size of the agent&#8217;s threadpool used to manage spawned processes.
                                                                                                
                                                                                                
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">10
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.ducc</span><span 
class="cmbx-10">_spawn</span><span 
class="cmbx-10">_path</span> </dt><dd 
class="description">                                                                                 <br 
class="newline" />This property specifies the full path to the ducc_ling utility. During installation ducc_ling is normally
     moved to local disk and given setuid-root privileges. Use this property to tell the DUCC agents the
     location of the installed ducc_ling. The default location is within an architecture dependent subdiretory of
     DUCC_HOME/admin.
     <!--l. 1296--><p class="noindent" >The arcitecture is derived from the JRE property <span 
class="cmti-10">os.arch</span>. During DUCC installation the <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_ling </span>utility is compiled
     for the architecture of the host where DUCC is installed. In heterogeneous clusters, the system administrator should
     run the utility <span 
class="cmti-10">build</span><span 
class="cmti-10">_duccling </span>once on a machine of each architecture to insure this utility gets correctly
     installed.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">$DUCC_HOME/admin/$os.arch/ducc_ling
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.process.stop.timeout</span> </dt><dd 
class="description">                                                                             <br 
class="newline" />This property specifies the time, in milliseconds, the agent should wait before forcibly terminating a job process (JP)
     after an attempted graceful shutdown. If the child process does not terminate in the specified time, it is forcibly
     terminated with kill -9.
     <!--l. 1311--><p class="noindent" >This type of stop can occur because of preemption or system shutdown.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">60000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.process.init.timeout</span> </dt><dd 
class="description">                                                                              <br 
class="newline" />This property specifies the time, in milliseconds, that the agent should wait for a job process (JP) to
     complete initialization. If initialization is not completed in this time the process is terminated and and
     InitializationTimout status is send to the job driver (JD) which decides whether to retry the process or terminate the
     job.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">7200000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.share.size.fudge.factor</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />
     <!--l. 1331--><p class="noindent" >The DUCC agent monitors the size of the resident memory of its spawned processes. If a process exceeds its declared
     memory size by any significant amount it is terminated and a ShareSizeExceeded message is sent. The Job Driver
     counts this towards the maximum errors for the job and will eventually terminate the job if excessive such errors
     occur.
     <!--l. 1336--><p class="noindent" >This property defines the percentage over the declared memory size that a process is allowed to grow to before being
                                                                                                
                                                                                                
     terminated.
     <!--l. 1339--><p class="noindent" >To disable this feature, set the value to -1.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">5
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.rogue.process.user.exclusion.filter</span> </dt><dd 
class="description">                                                                        <br 
class="newline" /><a 
 id="likesection.9"></a>
     <!--l. 1348--><p class="noindent" >The DUCC Agents scan nodes for processes that should not be running; for example, a job may have left a &#8217;rogue&#8217;
     process alive when it exits, or a user may log in to a node unexpectedly. These processes are reported to the
     administrators via the webserver for possible action.
     <!--l. 1353--><p class="noindent" >This configuration parameter enumerates userids which are ignored by the rogue-process scan.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">root,posstfix,ntp,nobody,daemon,100
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.rogue.process.exclusion.filter</span> </dt><dd 
class="description">                                                                              <br 
class="newline" /><a 
 id="likesection.10"></a> The DUCC Agents scan nodes for processes that should not be running; for example, a job may have left a &#8217;rogue&#8217;
     process alive when it exits, or a user may log in to a node unexpectedly. These processes are reported to the
     administrators via the webserver for possible action.
     <!--l. 1367--><p class="noindent" >This configuration parameter enumerates processes by name which are ignored by the rogue process
     detector.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">sshd:,-bash,-sh,/bin/sh,/bin/bash,grep,ps
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     <!--l. 1376--><p class="noindent" ><a 
 id="likesection.11"></a>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.cgroups.enable</span> </dt><dd 
class="description">                                                                                     <br 
class="newline" />Enable or disable CGroups support. If CGroups are not installed on a specific machine, this is ignored.
     <!--l. 1381--><p class="noindent" >With CGroups the RSS for a managed process (plus any children processes it may spawn) is limited to
     the allocated share size. Additional memory use goes to swap space. DUCC monitors and limits swap
     use to the same proportion of total swap space as allocated share size is to total RAM. If a process
     exceeds its allowed swap space it is terminated and a ShareSizeExceeded message is sent to the Job
     Driver.
     <!--l. 1387--><p class="noindent" >Nodes not using CGroups fall back to the ducc.agent.share.size.fudge.factor.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">true
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.launcher.cgroups.utils.dir</span> </dt><dd 
class="description">                                                                                   <br 
class="newline" /><a 
 id="likesection.12"></a> Location of CGroups programs, like cgexec. If CGroups are not installed on a specific machine, this is
     ignored.
     <!--l. 1399--><p class="noindent" >Depending on the OS, CGroups programs may be installed in different places. Provide a comma separated list of
     directories the agent should search to find the programs.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">/usr/bin
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     <!--l. 1409--><p class="noindent" ><a 
 id="likesection.13"></a>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.agent.exclusion.file</span> </dt><dd 
class="description">                                                                                                   <br 
class="newline" />This specifies the exclusion file to enable node based exclusion for various features. Currently only CGroup exclusion is
     supported.
     <!--l. 1414--><p class="noindent" >The exclusion file has one line per agent of the form:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-119">
     &#x003C;node&#x003E;=cgroups</div>
     <!--l. 1417--><p class="nopar" > If the keyword &#8220;cgrouops&#8221; is found, the node is excluded from CGroup support.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">Not configured.
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd></dl>
<!--l. 1430--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.8   </span> <a 
 id="x1-22100012.4.8"></a>Process Manager Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.pm.configuration.class</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the name of the pluggable java class used to implement the DUCC Process Manager.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.pm.config.ProcessManagerConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.request.endpoint</span> </dt><dd 
class="description">                                                                                                 <br 
class="newline" />This is the endpoint through which process manager receive state from the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.pm
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.request.endpoint.type</span> </dt><dd 
class="description">                                                                                          <br 
class="newline" />This is the JMS endpoint type used for state messages sent by the Orchestrator.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">queue
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.state.update.endpoint</span> </dt><dd 
class="description">                                                                                          <br 
class="newline" />This is the endpoint through which process manager sends its heartbeat. The main receiver is the Web Server for it&#8217;s
     daemon status page.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.pm.state
                                                                                                
                                                                                                
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.state.update.endpoint.type</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" />This is the JMS endpoint type used for process manager heartbeats. The primary receiver is the Web Server for its
     daemon status page.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">topic
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.pm.state.publish.rate</span> </dt><dd 
class="description">                                                                                                <br 
class="newline" />The interval in milliseconds between process manager heartbeat publications.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">25000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd></dl>
<!--l. 1483--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.4.9   </span> <a 
 id="x1-22200012.4.9"></a>Job Process Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.configuration.class</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />This is the name of the pluggable java class that implements the the UIMA-AS service shell for job processes
     (JPs).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.transport.configuration.jp.JobProcessConfiguration
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.endpoint</span> </dt><dd 
class="description">                                                                                                     <br 
class="newline" />This is the endpoint through which job processes (JPs) receive messages from the Agents.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">ducc.job.managed.service
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.endpoint.type</span> </dt><dd 
class="description">                                                                                               <br 
class="newline" />This is the JMS endpoint type used for messages sent to the JPs from the Agents.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">socket
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.endpoint.params</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />This configures the JP-to-Agent communication socket. It should be changed only by DUCC developers.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">transferExchange=true&amp;sync=false
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.saxon.jar.path</span> </dt><dd 
class="description">                                                                                              <br 
class="newline" />This configures the path the required Saxon jar.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">file:$DUCC_HOME/apache-uima/saxon/saxon8.jar
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.dd2spring.xsl.path</span> </dt><dd 
class="description">                                                                                         <br 
class="newline" />This configures the path the required dd2spring xsl definitions.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">$DUCC_HOME/apache-uima/bin/dd2spring.xsl
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.uima-as.flow-controller.specifier</span> </dt><dd 
class="description">                                                                                  <br 
class="newline" />This configures the pluggable class that implements the default flow controller used in the DUCC job processes
     (JPs).
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.FlowController
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.process.request.timeout</span> </dt><dd 
class="description">                                                                                             <br 
class="newline" />This is the maximum amount of time to wait for a response from a JD, in milliseconds. This value is used by a JP when
     sending requests to the JD.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">30000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.process.uima.as.container.class</span> </dt><dd 
class="description">                                                                                    <br 
class="newline" />Define process container class for DD jobs to instantiate and invoke via reflection. The container provides
     classpath isolation for user defined analytics. The container is instantiated with classes from a System
     classloader.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.user.jp.UimaASProcessContainer
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.process.uima.container.class</span> </dt><dd 
class="description">                                                                                       <br 
class="newline" />Define process container class for non-DD jobs to instantiate and invoke via reflection. The container provides
     classpath isolation for user defined analytics. The container is instantiated with classes from a System
     classloader.
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">org.apache.uima.ducc.user.jp.UimaProcessContainer
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Private</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">ducc.process.thread.sleep.time</span> </dt><dd 
class="description">                                                                                           <br 
class="newline" />Define the sleep time in milliseconds for JP to use when JD sends empty CAS. In this case the JD&#8217;s CR has processed
     its collection. The JP threads need to slow down sending requests
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">3000
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Tuning</dd></dl>
     </dd></dl>
<!--l. 1579--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.5   </span> <a 
 id="x1-22300012.5"></a>ducc.private.properties</h3>
<!--l. 1582--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.5.1   </span> <a 
 id="x1-22400012.5.1"></a>Web Server Properties</h4>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc.ws.port.ssl.pw</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />This is the password used to generate the Web Server&#8217;s keystore used for HTTPS requests. Usually this keystore is
     created at initial installation time using <a 
href="#x1-19600011.7">ducc_post_install.</a>
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">Default Value</span> </dt><dd 
class="description">quackquack
         </dd><dt class="description">
     <span 
class="cmbx-10">Type</span> </dt><dd 
class="description">Local</dd></dl>
     </dd></dl>
<!--l. 19--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.6   </span> <a 
 id="x1-22500012.6"></a>Resource Manager Configuration: Classes and Nodepools</h3>
<!--l. 22--><p class="noindent" >The class configuration file is used by the Resource Manager configures the rules used for job scheduling. See the <a 
href="#x1-27500013">Resource
Manager chapter</a> for a detailed description of the DUCC scheduler, scheduling classes, and how classes are used to configure
the scheduling process.
                                                                                                
                                                                                                
<!--l. 26--><p class="noindent" >The scheduler configuration file is specified in ducc.properties. The default name is ducc.classes and is specified by the
property <span 
class="cmti-10">ducc.rm.class.definitions</span>.
<!--l. 29--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.6.1   </span> <a 
 id="x1-22600012.6.1"></a>Nodepools</h4>
<!--l. 32--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-22700012.6.1"></a>Overview</h5>
<!--l. 33--><p class="noindent" >A <span 
class="cmti-10">nodepool </span>is a grouping of a subset of the physical nodes to allow differing scheduling policies to be applied to different
nodes in the system. Some typical nodepool groupings might include:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Group Intel and Power nodes separately so that users may submit jobs that run only in Intel architecture, or
     only Power, or &#8220;don&#8217;t care&#8221;.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Designate a group of nodes with large locally attached disks such that users can run jobs that require those
     disks.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Designate a specific set of nodes with specialized hardware such as high-speed network, such that jobs can be
     scheduled to run only on those nodes.</dd></dl>
<!--l. 45--><p class="noindent" >A Nodepool is a subset of some larger collection of nodes. Nodepools themselves may be further subdivided. Nodepools may
not overlap: every node belongs to exactly one nodepool. During system start-up the consistency of nodepool definition is
checked and the system will refuse to start if the configuration is incorrect.
<!--l. 50--><p class="noindent" >NOTE: The administrative command <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -c </span>may be used to verify and validate you class configration before
attemping to start DUCC. <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -cv </span>may be used to additionally &#8220;pretty-print&#8221; the ducc.classes configuration to the
console to revel class nesting and inheritance.
<!--l. 55--><p class="noindent" >For example, the diagram below is an abstract representation of all the nodes in a system. There are five nodepools
defined:
     <ul class="itemize1">
     <li class="itemize">Nodepool &#8220;NpAllOfThem&#8221; is subdivided into three pools, NP1, NP2, and NP3. All the nodes not contained in
     NP1, NP2, and NP3 belong to the pool called &#8220;NpAllOfThem&#8221;.
     </li>
     <li class="itemize">Nodepool NP1 is not further subdivided.
     </li>
     <li class="itemize">Nodepool NP2 is not further subdivided.
     </li>
     <li class="itemize">Nodepool NP3 is further subdivided to form NP4. All nodes within NP3 but not in NP4 are contained in NP3.
     </li>
     <li class="itemize">Nodepool NP4 is not further subdivided.</li></ul>
<!--l. 67--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-227004r1"></a>
                                                                                                
                                                                                                

<!--l. 69--><p class="noindent" ><img 
src="images/Nodepool1.jpg" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.1: </span><span  
class="content">Nodepool Example</span></div><!--tex4ht:label?: x1-227004r1 -->
                                                                                                
                                                                                                
<!--l. 72--><p class="noindent" ></div><hr class="endfigure">
<!--l. 74--><p class="noindent" >In the figure below the Nodepools are incorrectly defined for two reasons:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">NP1 and NP2 overlap.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">NP4 overlaps both nodepool &#8220;NpAllOfThem&#8221; and NP3.</dd></dl>
<!--l. 80--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-227007r2"></a>
                                                                                                
                                                                                                

<!--l. 82--><p class="noindent" ><img 
src="images/Nodepool2.jpg" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.2: </span><span  
class="content">Nodepools: Overlapping Pools are Incorrect</span></div><!--tex4ht:label?: x1-227007r2 -->
                                                                                                
                                                                                                
<!--l. 85--><p class="noindent" ></div><hr class="endfigure">
<!--l. 87--><p class="noindent" >Multiple &#8220;top-level&#8221; nodepools are allowed. A &#8220;top-level&#8221; nodepool has no containing pool. Multiple top-level pools logically
divide a cluster of machines into <span 
class="cmti-10">multiple independent clusters </span>from the standpoint of the scheduler. Work scheduled over one
pool in no way affects work scheduled over the other pool. The figure below shows an abstract nodepool configuration with
two top-level nodepools, &#8220;Top-NP1&#8221; and &#8220;Top-NP2&#8221;. <hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-227008r3"></a>
                                                                                                
                                                                                                

<!--l. 94--><p class="noindent" ><img 
src="images/Nodepool3.jpg" alt="PIC"  
>
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.3: </span><span  
class="content">Nodepools: Multiple top-level Nodepools</span></div><!--tex4ht:label?: x1-227008r3 -->
                                                                                                
                                                                                                
<!--l. 97--><p class="noindent" ></div><hr class="endfigure">
<h5 class="subsubsectionHead"><a 
 id="x1-22800012.6.1"></a>Scheduling considerations</h5>
<!--l. 100--><p class="noindent" >A primary goal of the scheduler is to insure that no resources are left idle if there is pending work that is able to use those
resources. Therefore, work scheduled to a class defined over a specific nodepool (say, NpAllOfThem), may be
scheduled on nodes in any of the nodepools contained within NpAllOfThem. If work defined over a subpool (such
as NP1) arrives, processes on nodes in NP1 that were scheduled for NpAllOfThem are considered <span 
class="cmti-10">squatters</span>
and are the most likely candidates for eviction. (Processes assigned to their proper nodepools are considered
<span 
class="cmti-10">residents </span>and are evicted only after all <span 
class="cmti-10">squatters </span>have been evicted.) The scheduler strives to avoid creating
<span 
class="cmti-10">squatters</span>.
<!--l. 110--><p class="noindent" >Because non-preemptable allocations can&#8217;t be preempted, work submitted to a class implementing one of the
non-preemptable policies (FIXED or RESERVE) are never allowed to &#8220;squat&#8221; in other nodepools and are only scheduled on
nodes in their proper nodepool.
<!--l. 115--><p class="noindent" >In the case of multiple top-level nodepools: these nodepools and their sub-pools form independent scheduling groups.
Specifically,
     <ul class="itemize1">
     <li class="itemize">Fair-share allocations over any nodepool in one top-level pool do NOT affect the fair-share allocations for jobs
     in any other top-level nodepool. Top-level nodepools define independently scheduled of resources within a single
     DUCC cluster.
     </li>
     <li class="itemize">Work submitted to classes under one top-level nodepool do NOT get expanded to nodes under another top-level
     nodepool, even is there is sufficient capacity.</li></ul>
<!--l. 126--><p class="noindent" >Most installations will want to assign the majority of nodes to a single top-level nodepool (or its subpools), using other
top-level pools for nodes that cannot be shared with other work.
<!--l. 130--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-22900012.6.1"></a>Configuration</h5>
<!--l. 132--><p class="noindent" >DUCC uses simple named stanzas containing key/value pairs to configure nodepools.
<!--l. 134--><p class="noindent" >At least one nodepool definition is required. This nodepool need not have any subpools or node definitions. The first top-level
nodepool is considered the &#8220;default&#8221; nodepool. Any node not named specifically in one of the node files which checks in with
DUCC is assigned to this first, <span 
class="cmti-10">default </span>nodepool.
<!--l. 139--><p class="noindent" >Thus, if only one nodepool is defined with no other attributes, all nodes are assigned to that pool.
<!--l. 142--><p class="noindent" >A nodepool definition consists of the token &#8220;Nodepool&#8221; followed by the name of the nodepool, followed by a
block delimited with &#8220;curly&#8221; braces <span 
class="cmsy-10">{ </span>and <span 
class="cmsy-10">}</span>. This block contains the attributes of the nodepool as key/value
pairs. Lineneds are ignored. A semicolon &#8220;;&#8221; may optionally be used to delimit key/value pairs for readability,
and an equals sign &#8220;=&#8221; may optionally be used to delimit keys from values, also just for readability. See the
<a 
href="#x1-229007r4">below</a>.
<!--l. 150--><p class="noindent" >The attributes of a Nodepool are:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">domain</span> </dt><dd 
class="description">This is valid only in the &#8220;default&#8221; (first) nodepool. Any node in any nodefile which does not have a domain,
     and any node which checks in to the Resource Manager without a domain name is assigned this domain name
     in order that the scheduler may deal entirely with full-qualified node names.
     <!--l. 157--><p class="noindent" >If no <span 
class="cmti-10">domain </span>is specified, DUCC will attempt to guess the domain based on the domain name returned on the
     node where the Resource Manager resides.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">nodefile</span> </dt><dd 
class="description">This is the name of a file containing the names of the nodes which are members of this nodepool.
     </dd><dt class="description">
<span 
class="cmbx-10">parent</span> </dt><dd 
class="description">This is used to indicate which nodepool is the logical parent. Any nodepool without a <span 
class="cmti-10">parent </span>is considered
     a top-level nodepool.</dd></dl>
<!--l. 167--><p class="noindent" >The following example defines six nodepools,
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">A top-level nodepool called &#8220;&#8211;default&#8211;&#8221;. All nodes not named in any nodefile are assigned to this nodepool.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">A top-level nodepool called &#8220;jobdriver&#8221;, consisting of the nodes named in the file <span 
class="cmti-10">jobdriver.nodes</span>.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">A subpool of &#8220;&#8211;default&#8211;&#8221; called &#8220;intel&#8221;, consisting of the nodes named in <span 
class="cmti-10">intel.nodes</span>.
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">A subpool of &#8220;&#8211;default&#8211;&#8221; called &#8220;power&#8221;, consisting of the nodes named in the file <span 
class="cmti-10">power.nodes</span>.
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">A subpool of &#8220;intel&#8221; called &#8220;nightly-test&#8221;, consisting of the nodes named in <span 
class="cmti-10">nightly-test.nodes</span>.
     </dd><dt class="enumerate-enumitem">
  6. </dt><dd 
class="enumerate-enumitem">And a subpool of &#8220;power&#8221; called &#8220;timing-p7&#8221;, consisting of the nodes named in <span 
class="cmti-10">timing-p7.nodes</span>.</dd></dl>
<!--l. 183--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-229007r4"></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-120">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;--default--&#x00A0;&#x00A0;{&#x00A0;domain&#x00A0;mydomain.net&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;jobdriver&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodefile&#x00A0;jobdriver.nodes&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;intel&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodefile&#x00A0;intel.nodes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;&#x00A0;parent&#x00A0;--default--&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;power&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodefile&#x00A0;power.nodes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;;&#x00A0;parent&#x00A0;--default--&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;nightly-test&#x00A0;{&#x00A0;nodefile&#x00A0;nightly-test.nodes&#x00A0;;&#x00A0;parent&#x00A0;intel&#x00A0;}
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;timing-p7&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodefile&#x00A0;timing-p7.nodes&#x00A0;&#x00A0;&#x00A0;&#x00A0;;&#x00A0;parent&#x00A0;power&#x00A0;}</div>
<!--l. 194--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.4: </span><span  
class="content">Sample Nodepool Configuration</span></div><!--tex4ht:label?: x1-229007r4 -->
                                                                                                
                                                                                                
<!--l. 198--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">12.6.2   </span> <a 
 id="x1-23000012.6.2"></a>Class Definitions</h4>
<!--l. 204--><p class="noindent" >Scheduler classes are defined in the same simple block language as nodepools.
<!--l. 207--><p class="noindent" >A simple inheritance (or &#8220;template&#8221;) scheme is supported for classes. Any class may be configured to &#8220;derive&#8221; from any other
class. In this case, the child class acquires all the attributes of the parent class, any of which may be selectively overridden.
Multiple inheritance is not supported but nested inheritance is; that is, class A may inherit from class B
which inherits from class C and so on. In this way, generalized templates for the site&#8217;s class structure may be
defined.
<!--l. 215--><p class="noindent" >The general form of a class definition consists of the keyword Class, followed by the name of the class, and then optionally by
the name of a &#8220;parent&#8221; class whose characteristics it inherits. Following the name (and optionally parent class name) are the
attributes of the class, also within a <span 
class="cmsy-10">{ </span>block <span 
class="cmsy-10">} </span>as for nodepools, and with lines and key/value pairs optionally delimited by &#8220;;&#8221;
and &#8220;=&#8221;, respectively. See the sample <a 
href="#x1-230001r5">below</a>.
<!--l. 222--><p class="noindent" >The attributes defined for classes are:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">abstract</span> </dt><dd 
class="description">If specified, this indicates this class is a template ONLY. It is used as a model for other classes. Values are
     &#8220;true&#8221; or &#8220;false&#8221;. The default is &#8220;false&#8221;. This class is never passed to the scheduler and may not be referenced
     by jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">debug</span> </dt><dd 
class="description">FAIR_SHARE only. This specifies the name of a class to substitute for jobs submitted for debug. For example, if
     class <span 
class="cmti-10">normal </span>specifies
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-121">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;debug&#x00A0;=&#x00A0;fixed</div>
     <!--l. 234--><p class="nopar" > then any job submitted to this class with debugging requested is actually scheduled in class <span 
class="cmti-10">fixed</span>. (For example, one
     probably does not want a debugging job scheduled as FAIR_SHARE and possibly preempted, preferring the
     non-preemptable class <span 
class="cmti-10">fixed</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">default</span> </dt><dd 
class="description">This specifies the class to be used as the default class for work submission if no class is explicitly given. Only one
     class of type FAIR_SHARE may contain this designation, in which case it names the default FAIR_SHARE class. Only
     one class of type FIXED_SHARE or RESERVE may contain this designation, in which case it names the default class
     to use for reservations (Note that either FIXED_SHARE or RESERVE scheduling policies are valid for
     reservations.)
     </dd><dt class="description">
<span 
class="cmbx-10">expand-by-doubling</span> </dt><dd 
class="description">FAIR_SHARE only. If &#8220;true&#8221;, and the <span 
class="cmti-10">initialization-cap </span>is set, then after any process has
     initialized, the job will expand to its maximum allowable shares by doubling in size each scheduling
     cycle.
     <!--l. 251--><p class="noindent" >If not specified, the global value set in <a 
href="#x1-21300012.4">ducc.properties</a> is used.
     </dd><dt class="description">
<span 
class="cmbx-10">initialization-cap</span> </dt><dd 
class="description">FAIR_SHARE only. If specified, this is the largest number of processes this job may be assigned until at
     least one process has successfully completed initialization.
     <!--l. 256--><p class="noindent" >If not specified, the global value set in <a 
href="#x1-21300012.4">ducc.properties</a> is used.
     </dd><dt class="description">
<span 
class="cmbx-10">max-processes</span> </dt><dd 
class="description">FAIR_SHARE and FIXED_SHARE only. This is the largest number of FIXED-SHARE, non-preemptable
     shares any single job may be assigned.
     <!--l. 261--><p class="noindent" >Omit this property, or set it to 0 to disable the cap.
     <!--l. 263--><p class="noindent" >g
     </dd><dt class="description">
<span 
class="cmbx-10">prediction-fudge</span> </dt><dd 
class="description">FAIR_SHARE only. When the scheduler is considering expanding the number of processes for a job
     it tries to determine if the job may complete before those processes are allocated and initialized. The
     <span 
class="cmti-10">prediction-fudge </span>adds some amount of time (in milliseconds) to the projected completion time. This allows
     installations to prevent jobs from expanding when they were otherwise going to end in a few minutes
     anyway.
     <!--l. 270--><p class="noindent" >If not specified, the global value set in <a 
href="#x1-21300012.4">ducc.properties</a> is used.
     </dd><dt class="description">
<span 
class="cmbx-10">nodepool</span> </dt><dd 
class="description">Jobs for this class are assigned to nodes in this nodepool. The value must be the name of one of the configured
     nodepools.
     </dd><dt class="description">
<span 
class="cmbx-10">policy</span> </dt><dd 
class="description">This is the scheduling policy, one of FAIR_SHARE, FIXED_SHARE, or RESERVE. This attribute is required (there
     is no default).
     </dd><dt class="description">
<span 
class="cmbx-10">priority</span> </dt><dd 
class="description">This is the scheduling priority for jobs in this class.
     </dd><dt class="description">
<span 
class="cmbx-10">weight</span> </dt><dd 
class="description">FAIR_SHARE only. This is the fair-share weight for jobs in this class.
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 284--><p class="noindent" >The following figure illustrates a representative class configuration for a large cluster, consisting of mixed Intel and Power
nodes. This class definition assumes the <a 
href="#x1-229007r4">nodepool configuration</a> shown above. FAIR_SHARE, FIXED_SHARE,
and RESERVE classes are defined over each machine architecture, Intel and Power, and over the combined
pool.
<!--l. 290--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-230001r5"></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-122">
#&#x00A0;---------------------&#x00A0;Fair&#x00A0;share&#x00A0;definitions&#x00A0;---------------
&#x00A0;<br />Class&#x00A0;fair-base&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;policy&#x00A0;=&#x00A0;FAIR_SHARE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nodepool&#x00A0;=&#x00A0;intel
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;priority&#x00A0;=&#x00A0;10
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;weight&#x00A0;=&#x00A0;100
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;abstract&#x00A0;=&#x00A0;true
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;debug&#x00A0;=&#x00A0;fixed
&#x00A0;<br />}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;nightly-test&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;100;&#x00A0;nodepool&#x00A0;nightly-test;&#x00A0;priority&#x00A0;=&#x00A0;7}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;background&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;20&#x00A0;}
&#x00A0;<br />Class&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;50&#x00A0;}
&#x00A0;<br />Class&#x00A0;normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;100;&#x00A0;default&#x00A0;=&#x00A0;true&#x00A0;}
&#x00A0;<br />Class&#x00A0;high&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;200&#x00A0;}
&#x00A0;<br />Class&#x00A0;weekly&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fair-base&#x00A0;&#x00A0;{&#x00A0;weight&#x00A0;=&#x00A0;400&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;background-p7&#x00A0;&#x00A0;background&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />Class&#x00A0;low-p7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />Class&#x00A0;normal-p7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />Class&#x00A0;high-p7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;high&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />Class&#x00A0;weekly-p7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;weekly&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;background-all&#x00A0;background&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;--default--&#x00A0;}
&#x00A0;<br />Class&#x00A0;low-all&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;--default--&#x00A0;}
&#x00A0;<br />Class&#x00A0;normal-all&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;--default--&#x00A0;}
&#x00A0;<br />Class&#x00A0;high-all&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;high&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;--default--&#x00A0;}
&#x00A0;<br />Class&#x00A0;weekly-all&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;weekly&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;--default--&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;---------------------&#x00A0;Fixed&#x00A0;share&#x00A0;definitions&#x00A0;---------------
&#x00A0;<br />Class&#x00A0;fixed-base&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;policy&#x00A0;=&#x00A0;FIXED_SHARE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nodepool&#x00A0;=&#x00A0;intel
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;priority&#x00A0;=&#x00A0;5
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;abstract&#x00A0;=&#x00A0;true
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;max-processes&#x00A0;=&#x00A0;10
&#x00A0;<br />}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;fixed&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;fixed-base&#x00A0;{&#x00A0;}
&#x00A0;<br />Class&#x00A0;fixed-p7&#x00A0;&#x00A0;fixed-base&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power;&#x00A0;&#x00A0;&#x00A0;&#x00A0;default&#x00A0;=&#x00A0;true;&#x00A0;}
&#x00A0;<br />Class&#x00A0;JobDriver&#x00A0;fixed-base&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;jobdriver;&#x00A0;priority&#x00A0;=&#x00A0;0&#x00A0;}
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;---------------------&#x00A0;Reserve&#x00A0;definitions&#x00A0;---------------
&#x00A0;<br />Class&#x00A0;reserve-base&#x00A0;{
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;policy&#x00A0;=&#x00A0;RESERVE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;nodepool&#x00A0;=&#x00A0;intel
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;priority&#x00A0;=&#x00A0;1
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;abstract&#x00A0;=&#x00A0;true
&#x00A0;<br />}
&#x00A0;<br />
&#x00A0;<br />Class&#x00A0;reserve&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;reserve-base&#x00A0;{&#x00A0;}
                                                                                                
                                                                                                
&#x00A0;<br />Class&#x00A0;reserve-p7&#x00A0;&#x00A0;reserve-base&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;power&#x00A0;}
&#x00A0;<br />Class&#x00A0;timing-p7&#x00A0;&#x00A0;&#x00A0;reserve-base&#x00A0;{&#x00A0;nodepool&#x00A0;=&#x00A0;timing-p7&#x00A0;}</div>
<!--l. 346--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.5: </span><span  
class="content">Sample Class Configuration</span></div><!--tex4ht:label?: x1-230001r5 -->
                                                                                                
                                                                                                
<!--l. 349--><p class="noindent" ></div><hr class="endfigure">
<h4 class="subsectionHead"><span class="titlemark">12.6.3   </span> <a 
 id="x1-23100012.6.3"></a>Validation</h4>
<!--l. 353--><p class="noindent" >The administrative command, <a 
href="#x1-24900012.9.3"><span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc</span></a> may be used to validate a configuration, with the <span 
class="cmti-10">-c </span>and <span 
class="cmti-10">v </span>options. This reads the
entire configuration and nodefiles, validates consistency of the definitions and insures the nodepools do not
overlap.
<!--l. 357--><p class="noindent" >The <a 
href="#x1-23700012.9.1"><span 
class="cmti-10">start</span><span 
class="cmti-10">_ducc</span></a> command always runs full validation, and if the configuration is found to be incorrect, the cluster is not
started.
<!--l. 360--><p class="noindent" >Configuration checking is done internally by the DUCC java utility <span 
class="cmti-10">org.apache.uima.ducc.commonNodeConfiguration</span>.
This utility contains a public API as described in the Javadoc. It may be invoked from the command line as
follows:
<!--l. 364--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-23200012.6.3"></a><span 
class="cmbx-10">Usage:</span></span>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-123">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;java&#x00A0;org.apache.uima.ducc.commonNodeConfiguration&#x00A0;[-p]&#x00A0;[-v&#x00A0;nodefile]&#x00A0;configfile</div>
<!--l. 367--><p class="nopar" >
<!--l. 369--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-23300012.6.3"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">-</span><span 
class="cmmi-10">p</span> </dt><dd 
class="description">Pretty-print  the  compiled  configuration  to  stdout.  This  illustrates  nodepool  nesting,  and  shows  the
     fully-completed scheduling classes after inheritance.
     </dd><dt class="description">
<span 
class="cmsy-10">-</span><span 
class="cmmi-10">v </span><span 
class="cmbx-10">nodefile</span> </dt><dd 
class="description">This should be the master nodelist used to start DUCC. This is assumed to be constructed to reflect
     the nodepool organization as <a 
href="#x1-23400012.7">described here</a>. If provided, the nodepools are validated and checked for overlaps.
     </dd><dt class="description">
<span 
class="cmbx-10">configfile</span> </dt><dd 
class="description">This is the name of the file containing the configuration.</dd></dl>
<!--l. 19--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">12.7   </span> <a 
 id="x1-23400012.7"></a>Ducc Node Definitions</h3>
<!--l. 21--><p class="noindent" >The DUCC node definitions are specified by default in the file <span 
class="cmti-10">ducc.nodes</span>.
<!--l. 23--><p class="noindent" >The DUCC node list is used to configure the nodes used to run jobs and assign reservations. When DUCC is started, the
nodelist is read an a DUCC Agent is started on every node in the list.
<!--l. 26--><p class="noindent" >The node list can be composed of multiple node lists to assist organization of the DUCC cluster. All the administrative
commands operate upon node lists. By carefully organized these lists it is possible to administer portions of a cluster
independently.
<!--l. 30--><p class="noindent" >In particular, it is highly recommended that the nodelists reflect the nodepool structure. In this way, the configuration used
to start DUCC is guaranteed to match the nodeppool definitions.
<!--l. 33--><p class="noindent" >Several types of records are permitted in nodelists:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Comments</span> </dt><dd 
class="description">A comment starts with the symbol &#8220;#&#8221;. All text on the line following this symbol is ignored.
     </dd><dt class="description">
<span 
class="cmbx-10">import</span> </dt><dd 
class="description">If a line starts with the symbol <span 
class="cmti-10">import</span>, the next symbol on that line is expected to be the name of another
     node list. This permits the DUCC cluster&#8217;s nodes to be configured in a structured manner.
     <!--l. 43--><p class="noindent" >For instance, the file <span 
class="cmti-10">ducc.nodes </span>might consist entirely of <span 
class="cmti-10">import </span>statements naming all of the nodepool files.
     </dd><dt class="description">
<span 
class="cmbx-10">domain</span> </dt><dd 
class="description">This must be the first line of the file. If specified, it should name the default domain to be used for all the
     nodes in this file, and the nodes named in imported files. If not specified, then during start-up, nodes without
     domain names are assigned domain names according to the global domain name specified in the <a 
href="#x1-22900012.6.1">Resource
     Manager configuration</a> file, and if none is specified there, the domain name on the host starting DUCC is used.
     </dd><dt class="description">
<span 
class="cmbx-10">nodename</span> </dt><dd 
class="description">This is a single token consisting of the name of a node on which an agent it to be started.
                                                                                                
                                                                                                
     </dd></dl>
<!--l. 56--><p class="noindent" >The example below shows a partial, hypothetical node configuration corresponding to the <a 
href="#x1-229007r4">nodepool configuration</a>
above.
<!--l. 59--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-234001r6"></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-124">
&#x003E;&#x00A0;cat&#x00A0;ducc.nodes
&#x00A0;<br />#&#x00A0;import&#x00A0;all&#x00A0;the&#x00A0;nodes&#x00A0;corresponding&#x00A0;to&#x00A0;my&#x00A0;nodepools
&#x00A0;<br />domain&#x00A0;my.domain
&#x00A0;<br />import&#x00A0;intel.nodes
&#x00A0;<br />import&#x00A0;power.nodes
&#x00A0;<br />import&#x00A0;jobdriver.nodes
&#x00A0;<br />import&#x00A0;nightly-test.nodes
&#x00A0;<br />import&#x00A0;timing-p7.nodes
&#x00A0;<br />
&#x00A0;<br />&#x003E;&#x00A0;cat&#x00A0;intel.nodes
&#x00A0;<br />#&#x00A0;import&#x00A0;the&#x00A0;intel&#x00A0;nodes,&#x00A0;by&#x00A0;frame
&#x00A0;<br />import&#x00A0;intel-frame1.nodes
&#x00A0;<br />import&#x00A0;intel-frame2.nodes
&#x00A0;<br />import&#x00A0;intel-frame3.nodes
&#x00A0;<br />
&#x00A0;<br />&#x003E;cat&#x00A0;intel-frame1.nodes
&#x00A0;<br />#import&#x00A0;the&#x00A0;specific&#x00A0;nodes&#x00A0;from&#x00A0;frame1
&#x00A0;<br />r1s1node1
&#x00A0;<br />r1s1node2
&#x00A0;<br />r1s1node3
&#x00A0;<br />r1s1node4</div>
<!--l. 83--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.6: </span><span  
class="content">Sample Node Configuration</span></div><!--tex4ht:label?: x1-234001r6 -->
                                                                                                
                                                                                                
<!--l. 87--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">12.8   </span> <a 
 id="x1-23500012.8"></a>Ducc User Definitions</h3>
<!--l. 21--><p class="noindent" >The DUCC user registry provides user-specific overrides of various constraints DUCC might impose.
<!--l. 24--><p class="noindent" >As of 2.0.0, the only constraint override is <a 
href="#x1-27900013.4">allotment</a> for non-preemptable requests.
<!--l. 27--><p class="noindent" >The syntax of the user registry is the same as that used in <span 
class="cmti-10">ducc.classes</span>, and in fact, the user registry may be embedded
directly in that file, rather than specified externally.
<!--l. 31--><p class="noindent" >The registry consists of multiple entries, one for affected user. Any user of the system NOT in the registry acquires the
system defaults.
<!--l. 34--><p class="noindent" >A user definition consists of the token &#8220;User&#8221; followed by the id of the user, followed by a block delimited with &#8220;curly&#8221; braces
<span 
class="cmsy-10">{ </span>and <span 
class="cmsy-10">}</span>. This block contains the attributes of the nodepool as key/value pairs. Lineneds are ignored. A semicolon &#8220;;&#8221; may
optionally be used to delimit key/value pairs for readability, and an equals sign &#8220;=&#8221; may optionally be used to delimit keys
from values, also just for readability.
<!--l. 41--><p class="noindent" >The attributes of a User entry are:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">max-allotment</span> </dt><dd 
class="description">This overrides the maximum allotment for non-preemptable requests as defined in <span 
class="cmti-10">ducc.properties</span>.
     The override may be used to either increase, or decrease the user&#8217;s allotment. The units are in gigabytes.</dd></dl>
<!--l. 48--><p class="noindent" >The example below shows overrides for three users:
     <ul class="itemize1">
     <li class="itemize">Bob is allowed a non-preemptable allotment of 4000GB.
     </li>
     <li class="itemize">May is allowed a non-preemptable allotment of 1000GB.
     </li>
     <li class="itemize">Antoinette is allowed a non-preemptable allotment of 720GB.</li></ul>
<!--l. 56--><p class="noindent" ><hr class="figure"><div class="figure" 
>
                                                                                                
                                                                                                
<a 
 id="x1-235001r7"></a>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-125">
#&#x00A0;---------------------&#x00A0;User&#x00A0;Registry&#x00A0;---------------------
&#x00A0;<br />User&#x00A0;bob&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;max-allotment&#x00A0;=&#x00A0;4000&#x00A0;}
&#x00A0;<br />User&#x00A0;mary&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;{&#x00A0;max-allotment&#x00A0;=&#x00A0;1000&#x00A0;}
&#x00A0;<br />User&#x00A0;antoinette&#x00A0;&#x00A0;{&#x00A0;max-allotment&#x00A0;=&#x00A0;720&#x00A0;&#x00A0;}</div>
<!--l. 62--><p class="nopar" >
<br /> <div class="caption" 
><span class="id">Figure&#x00A0;12.7: </span><span  
class="content">Sample User Registration</span></div><!--tex4ht:label?: x1-235001r7 -->
                                                                                                
                                                                                                
<!--l. 65--><p class="noindent" ></div><hr class="endfigure">
<h3 class="sectionHead"><span class="titlemark">12.9   </span> <a 
 id="x1-23600012.9"></a>Administrative Commands</h3>
<!--l. 22--><p class="noindent" >The administrative commands include a command to start DUCC, one to stop it, and one to verify the configuration and
query the state of the cluster.
<!--l. 25--><p class="noindent" >Note: The scripting that supports these functions runs (by default) in multi-threaded mode so large clusters can be started,
stopped, and queried quickly. If DUCC is running on an older system, the threading may not work right, in which case the
scripts detect this and run single-threaded. As well, all these commands support a &#8220;&#8211;nothreading&#8221; option to manually disable
the threading.
<!--l. 31--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.1   </span> <a 
 id="x1-23700012.9.1"></a>start_ducc</h4>
<!--l. 34--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-23800012.9.1"></a><span 
class="cmti-10">Description</span></h5>
<!--l. 35--><p class="noindent" >The command $DUCC_HOME/admin/start_ducc is used to start DUCC processes. If run with no parameters it takes the
following actions:
     <ul class="itemize1">
     <li class="itemize">Starts the management processes Resource Manager, Orchestrator, Process Manager, Services Manager, and
     Web Server on the local node (where start_ducc is executed.
     </li>
     <li class="itemize">Starts an agent process on every node named in the default node list.</li></ul>
<!--l. 43--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-23900012.9.1"></a><span 
class="cmti-10">Usage</span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">start</span><span 
class="cmbx-10">_ducc [options]</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />If no options are given, all DUCC processes are started, using the default node list, <span 
class="cmti-10">ducc.nodes</span>.
     </dd></dl>
<!--l. 52--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24000012.9.1"></a><span 
class="cmti-10">Options: </span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-n, &#8211;nodelist [nodefile]</span>  </dt><dd 
class="description">                                                                                                     <br 
class="newline" />Start agents on the nodes in the nodefile. Multiple nodefiles may be specified:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-126">
     start\_ducc&#x00A0;-n&#x00A0;foo.nodes&#x00A0;-n&#x00A0;bar.nodes&#x00A0;-n&#x00A0;baz.nodes</div>
     <!--l. 59--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmbx-10">-c, &#8211;component [component]</span>  </dt><dd 
class="description">                                                                                             <br 
class="newline" />Start a specific DUCC component, optionally on a specific node. If the component name is qualified with a nodename,
     the component is started on that node. To qualify a component name with a destination node, use the notation
     component@nodename. Multiple components may be specified:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-127">
     start\_ducc&#x00A0;-c&#x00A0;sm&#x00A0;-c&#x00A0;pm&#x00A0;-c&#x00A0;rm&#x00A0;-c&#x00A0;or@bj22&#x00A0;-c&#x00A0;agent@n1&#x00A0;-c&#x00A0;agent@n2</div>
     <!--l. 69--><p class="nopar" >
     <!--l. 71--><p class="noindent" >Components include:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">rm</span> </dt><dd 
class="description">The Resource Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">or</span> </dt><dd 
class="description">The Orchestrator
         </dd><dt class="description">
     <span 
class="cmbx-10">pm</span> </dt><dd 
class="description">The Process Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">sm</span> </dt><dd 
class="description">The Service Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">ws</span> </dt><dd 
class="description">The Web Server
         </dd><dt class="description">
     <span 
class="cmbx-10">agent</span> </dt><dd 
class="description">Node Agents</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;nothreading</span> </dt><dd 
class="description">If specified, the command does not run in multi-threaded mode even if it is supported on the local
     platform.
     </dd></dl>
<!--l. 86--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24100012.9.1"></a><span 
class="cmti-10">Notes: </span></h5>
<!--l. 87--><p class="noindent" >A different nodelist may be used to specify where Agents are started. As well multiple node lists may be specified, in which
case Agents are started on all the nodes in the multiple node lists.
<!--l. 91--><p class="noindent" >To start only agents, run start_ducc specifying a nodelist explicitly. When started like this, the management daemons are not
started unless explicitly requested.
<!--l. 94--><p class="noindent" >To start only management processes, run start_ducc with the -m or &#8211;management flags. When started like the the agents are
not started unless explicitly requested.
<!--l. 97--><p class="noindent" >To start a specific management process, run start_ducc with the -c component parameter, specify the component that should
be started.
<!--l. 100--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24200012.9.1"></a><span 
class="cmti-10">Examples: </span></h5>
<!--l. 102--><p class="noindent" >Start some nodes from two different nodelist. This doesn&#8217;t start any of the management processes but it does insure the
ActiveMQ Broker is available.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-128">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;start\_ducc&#x00A0;-n&#x00A0;foo.nodes&#x00A0;-n&#x00A0;bar.nodes</div>
<!--l. 106--><p class="nopar" >
<!--l. 108--><p class="noindent" >Start an agent on a specific node:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-129">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;start\_ducc&#x00A0;-c&#x00A0;agent@a.specific.node</div>
<!--l. 111--><p class="nopar" >
<!--l. 113--><p class="noindent" >Start the webserver on node &#8217;bingle&#8217;:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-130">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;start\_ducc&#x00A0;-c&#x00A0;ws@bingle</div>
<!--l. 116--><p class="nopar" >
<!--l. 118--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24300012.9.1"></a><span 
class="cmti-10">Debugging:</span></h5>
<!--l. 120--><p class="noindent" >Sometimes something will not start and it can be difficult to understand why. To diagnose, it is helpful to know that
<span 
class="cmti-10">start</span><span 
class="cmti-10">_ducc </span>is simply a wrapper around a lower-level bit of scripting that does the actual work. That lower-level code can be
invoked stand-alone, in which case console messages that <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc </span>will have suppressed are presented to the
console.
<!--l. 125--><p class="noindent" >The lower-level script is called <span 
class="cmti-10">ducc.py </span>and accepts the same <span 
class="cmti-10">-c component </span>flag as start_ducc. If some component will not
start, try running <span 
class="cmti-10">ducc.py -c component </span>directly. It will start in the foreground and usually the cause of the problem becomes
evident from the console.
<!--l. 130--><p class="noindent" >For example, suppose the Resource Manager will not start. Run the following:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-131">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;./ducc.py&#x00A0;-c&#x00A0;rm</div>
<!--l. 133--><p class="nopar" > and examine the output. Use <span 
class="cmti-10">CTL-C </span>to stop the component when done.
<!--l. 137--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.2   </span> <a 
 id="x1-24400012.9.2"></a>stop_ducc</h4>
<!--l. 140--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24500012.9.2"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 141--><p class="noindent" >Stop_ducc is used to stop DUCC processes. If run with no parameters it takes the following actions: <span 
class="cmcsc-10x-x-144">TODO: </span>Garbled by
maven or docbook, update this
<!--l. 145--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24600012.9.2"></a><span 
class="cmti-10">Usage:</span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">stop</span><span 
class="cmbx-10">_ducc [options]</span> </dt><dd 
class="description">                                                                                                         <br 
class="newline" />If no options are given, help text is presented. At least one option is required, to avoid accidental cluster
     shutdown.</dd></dl>
<!--l. 154--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24700012.9.2"></a>Options:</h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-a &#8211;all</span> </dt><dd 
class="description">                                                                                                                           <br 
class="newline" />Stop all the DUCC processes, including agents and management processes. This broadcasts a &#8221;shutdown&#8221;
     command to all DUCC processes. Shutdown is normally performed gracefully will all process including job
     processes given time to save state. All user processes, both jobs and services, are sent shutdown signals. Job
     and service processes which do not shutdown within a designated grace period are then forcibly terminated
     with kill -9.
     </dd><dt class="description">
<span 
class="cmbx-10">-n, &#8211;nodelist [nodefile</span> </dt><dd 
class="description">]                                                                                                                     <br 
class="newline" />Only the DUCC agents in the designated nodelists are shutdown. The processes are sent kill -INT signals which
     triggers the Java shutdown hooks and enables graceful shutdown. All user processes on the indicated nodes,
     both jobs and services, are sent &#8221;shutdown&#8221; signals and are given a minute to shutdown gracefully. Job and
     service processes which do not shutdown within a designated grace period are then forcibly terminated with
     kill -9.
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-132">
     stop\_ducc&#x00A0;-n&#x00A0;foo.nodes&#x00A0;-n&#x00A0;bar.nodes&#x00A0;-n&#x00A0;baz.nodes</div>
     <!--l. 174--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmbx-10">-c, &#8211;component [component</span> </dt><dd 
class="description">]                                                                                                            <br 
class="newline" />Stop a specific DUCC component.
     <!--l. 179--><p class="noindent" >This may be used to stop an errant management component and subsequently restart it (with start_ducc).
     <!--l. 182--><p class="noindent" >This may also be used to stop a specific agent and the job and services processes it is managing, without the need to
     specify a nodelist.
     <!--l. 185--><p class="noindent" >Examples:
     <!--l. 187--><p class="noindent" >Stop agents on nodes n1 and n2:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-133">
     stop_ducc&#x00A0;-c&#x00A0;agent@n1&#x00A0;-c&#x00A0;agent@n2</div>
     <!--l. 190--><p class="nopar" >
     <!--l. 192--><p class="noindent" >Stop and restart the rm:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-134">
     stop_ducc&#x00A0;-c&#x00A0;rm
     &#x00A0;<br />start_ducc&#x00A0;-c&#x00A0;rm</div>
     <!--l. 196--><p class="nopar" >
     <!--l. 198--><p class="noindent" >Components include:
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">rm</span> </dt><dd 
class="description">The Resource Manager.
         </dd><dt class="description">
     <span 
class="cmbx-10">or</span> </dt><dd 
class="description">The Orchestrator.
         </dd><dt class="description">
     <span 
class="cmbx-10">pm</span> </dt><dd 
class="description">The Process Manager.
         </dd><dt class="description">
     <span 
class="cmbx-10">sm</span> </dt><dd 
class="description">The Service Manager.
         </dd><dt class="description">
     <span 
class="cmbx-10">ws</span> </dt><dd 
class="description">The Web Server.
         </dd><dt class="description">
     <span 
class="cmbx-10">broker</span> </dt><dd 
class="description">The ActiveMQ broker (only if the broker is auto-managed).
         </dd><dt class="description">
     <span 
class="cmbx-10">agentnode</span> </dt><dd 
class="description">Node Agent on the specified node.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;nothreading</span> </dt><dd 
class="description">If specified, the command does not run in multi-threaded mode even if it is supported on the local
     platform.
     </dd></dl>
<!--l. 214--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-24800012.9.2"></a><span 
class="cmti-10">Notes:</span></h5>
<!--l. 215--><p class="noindent" >Sometimes problems in the network or elsewhere prevent the DUCC components from stopping properly. The <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc</span>
command, described in the following section, contains options to query the existance of DUCC processes in the cluster, to
forcibly (<span 
class="cmti-10">kill -9</span>) terminate them, and to more gracefully terminate them (<span 
class="cmti-10">kill -INT</span>).
<!--l. 222--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.3   </span> <a 
 id="x1-24900012.9.3"></a>check_ducc</h4>
<!--l. 224--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25000012.9.3"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 226--><p class="noindent" >Check_ducc is used to verify the integrity of the DUCC installation and to find and report on DUCC processes. It identifies
processes owned by ducc (management processes, agents, and job processes), and processes started by DUCC on behalf of
users.
                                                                                                
                                                                                                
<!--l. 230--><p class="noindent" >Check_ducc can also be used to clean up errant DUCC processes when stop_ducc is unable to do so. The difference is that
stop_ducc generally tries more gracefully stop processes. check_ducc is used as a last resort, or if a fast but graceless
shutdown is desired.
<!--l. 234--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25100012.9.3"></a><span 
class="cmti-10">Usage: </span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">check</span><span 
class="cmbx-10">_ducc [options]</span> </dt><dd 
class="description">If no options are given this is the equivalent of:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-135">
     check_ducc&#x00A0;-c&#x00A0;-n&#x00A0;../resources/ducc.nodes</div>
     <!--l. 241--><p class="nopar" >
     <!--l. 243--><p class="noindent" >This verifies the integrity of the DUCC installation and searches for all the processes owned by user <span 
class="cmti-10">ducc </span>and started by
     DUCC on all the nodes in ducc.nodes.</dd></dl>
<!--l. 247--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25200012.9.3"></a><span 
class="cmti-10">Options:</span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-n &#8211;nodelist [nodefile]</span> </dt><dd 
class="description">Only the nodes specified in the nodefile are searched. The option may be specified multiple times
     for multiple nodefiles. Note that the &#8221;local&#8221; node is always checked as well.
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-136">
     check_ducc&#x00A0;-n&#x00A0;nlist1&#x00A0;-n&#x00A0;nlist2</div>
     <!--l. 254--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmbx-10">-c &#8211;configuration</span> </dt><dd 
class="description">Verify the <a 
href="#x1-22500012.6">Resource Manager configuration</a>.
     </dd><dt class="description">
<span 
class="cmbx-10">-p &#8211;pids</span> </dt><dd 
class="description">Rewrite the PID file. The PID file contains the process ids of all known DUCC management and agent processes.
     The PID file is normally managed by start_ducc and stop_ducc and is stored in the file <span 
class="cmti-10">ducc.pids </span>in directory
     <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_runtime/state</span>.
     <!--l. 264--><p class="noindent" >Occasionally the PID file can become partially or fully corrupted; for example, if a DUCC process dies spontaneously.
     Use check_ducc -p to search the cluster for processes and refresh the PID file.
     </dd><dt class="description">
<span 
class="cmbx-10">-i, &#8211;int</span> </dt><dd 
class="description">                                                                                                                          <br 
class="newline" />Use this to send a shutdown signal (<span 
class="cmti-10">kill -INT</span>) to all the DUCC processes. The DUCC processes catch this signal, close
     their resources and exit. Some resources take some time to close, or in case of problems, are unable to close, in which
     case the DUCC processes will unconditionally exit.
     <!--l. 273--><p class="noindent" >Sometimes problems in the network or elsewhere prevent <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -i </span>from terminating the DUCC processes. In this
     case, use <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -k</span>, described below.
     </dd><dt class="description">
<span 
class="cmbx-10">-k, &#8211;kill</span> </dt><dd 
class="description">                                                                                                                         <br 
class="newline" />Use this to forcibly kill a component using kill -9. This should only be used if <span 
class="cmti-10">stop</span><span 
class="cmti-10">_ducc </span>or <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -i </span>does not
     work.
     </dd><dt class="description">
<span 
class="cmbx-10">-s, &#8211;single</span><span 
class="cmbx-10">_user</span> </dt><dd 
class="description">                                                                                                               <br 
class="newline" />Bypass the multi-user permission checks normally done on the ducc_ling utility.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;nothreading</span> </dt><dd 
class="description">If specified, the command does not run in multi-threaded mode even if it is supported on the local
     platform.
     </dd><dt class="description">
<span 
class="cmbx-10">-v, &#8211;verboase</span> </dt><dd 
class="description">                                                                                                                 <br 
class="newline" />When specified with <span 
class="cmti-10">-c </span>to check the configuration, this emits a formatted version of the node list showing the full
     structure of the scheduling classes.
     </dd></dl>
<!--l. 293--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.4   </span> <a 
 id="x1-25300012.9.4"></a>rm_reconfigure</h4>
<!--l. 296--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25400012.9.4"></a><span 
class="cmti-10">Description:</span></h5>
                                                                                                
                                                                                                
<!--l. 297--><p class="noindent" >Rm_reconfigure is used to force the Resource Manager (RM) to reread all its configuration files and reconfigure itself
accordingly, without the need to fully stop and restart RM. This is generally much faster than RM restart and avoids losing
most state messages from the other DUCC processes.
<!--l. 302--><p class="noindent" >The <span 
class="cmti-10">rm</span><span 
class="cmti-10">_reconfigure </span>command first performs a <a 
href="#x1-21200012.3">properties merge.</a>
<!--l. 305--><p class="noindent" >RM then validates the new configuration, and if no errors are found, saves certain information such as current
node online-offline status. It then rereads the following configuration files and rebuilds its internal structures
accordingly:
     <ul class="itemize1">
     <li class="itemize">ducc.properties (after merging default.ducc.properties and site.ducc.properties,
     </li>
     <li class="itemize">ducc.classes,
     </li>
     <li class="itemize">log4j.xml.</li></ul>
<!--l. 314--><p class="noindent" >The saved configuration is then restored into the newly configured structures. On receipt of the next Orchestrator state, the
RM fully rebuilds its state from the current DUCC load and scheduling restarts.
<!--l. 318--><p class="noindent" >Depending on the nature of the new configuration, the current load may be adjusted; for example, if the weight of a
fair-share class is changed, preemptions or extra allocations may be performed.
<!--l. 322--><p class="noindent" >If the new configuration is not consistent with the current load, a number of more drastic adjustments will be
performed:
     <ul class="itemize1">
     <li class="itemize">If a fair-share class is deleted, all existing jobs for that class are preempted and a <span 
class="cmti-10">refusal </span>message is sent to the
     Orchestrator for each affected job.
     </li>
     <li class="itemize">If a fair-share class is redefined over a different nodepool such that existing work are no longer legally scheduled,
     any shares allocated over inappropriate hosts are <span 
class="cmti-10">preempted</span>. As soon as the preemptions are acknowledged, the
     RM will reschedule the shares over the differently-configured resources.
     </li>
     <li class="itemize">If a non-preemptable class is deleted or reconfigured so existing non-preempt able work is no longer allocated correctly,
     the following will occur:
         <ul class="itemize2">
         <li class="itemize">If the shares are for services, they are deallocated and a <span 
class="cmti-10">refusal </span>is sent to the Orchestrator. The Service
         Manager will observe this and restart the processes, causing them to be reallocated over the changed
         configuration.
         </li>
         <li class="itemize">Otherwise, the RM leaves the allocation in place, but places the hosts on an internal <span 
class="cmti-10">blacklist</span>, preventing
         subsequent scheduling to those hosts. Once the (now) incorrectly placed shares are freed (e.g. by canceling
         a reservation or exit of a managed reservation), the hosts are again white listed and made available for
         scheduling.</li></ul>
     </li></ul>
<!--l. 345--><p class="noindent" >In short, the RM makes every effort to avoid disturbing existing allocations, and blacklists hosts that are
no longer consistently configured for the current load, until such time as the allocations on those hosts are
released.
<!--l. 349--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25500012.9.4"></a><span 
class="cmti-10">Usage:</span></h5>
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">rm</span><span 
class="cmbx-10">_reconfigure</span> </dt><dd 
class="description">                                                                                                               <br 
class="newline" />This command has no options.</dd></dl>
<!--l. 359--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.5   </span> <a 
 id="x1-25600012.9.5"></a>rm_qload</h4>
<!--l. 362--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25700012.9.5"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 363--><p class="noindent" >Rm_qload is used to query the Resource Manager&#8217;s scheduling tables to determine the current demand and capacity of the
system, as the RM sees it. The primary purpose is to provide information to adjunct resource managers (such as a &#8220;cloud&#8221;)
to determine the current needs, or lack thereof, of the system. The administrative command is implemented as a Python
script that interacts with the underlying Java &#8220;RmQueryLoadReply&#8221; API and is provided mostly as an example of how
scripting can be used to interact with the RM.
<!--l. 371--><p class="noindent" >After displaying the current scheduling quantum, the response is provided in two sections:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Information showing the current demand and usage of resource classes, and
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Information showing the current nodepool usage.</dd></dl>
<!--l. 377--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25800012.9.5"></a><span 
class="cmti-10">Class section</span></h5>
<!--l. 378--><p class="noindent" >Three lines are emitted per class:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The name of the class and its scheduling policy,
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">A line showing the <span 
class="cmti-10">demand</span>, or <span 
class="cmti-10">request </span>by quantum, on the class, and
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">A line showing the <span 
class="cmti-10">usage</span>, or <span 
class="cmti-10">award</span>, by quantum on the class.</dd></dl>
<!--l. 385--><p class="noindent" >The numbers shown for <span 
class="cmti-10">request </span>and <span 
class="cmti-10">award </span>show the number of processes, by memory, in terms of scheduling quantum, for
each class. For example, assuming the scheduling quantum is 15GB, the following shows:
     <ul class="itemize1">
     <li class="itemize">Five processes of quantum 2 (15-30GB) are requested, but only two have been awarded,
     </li>
     <li class="itemize">Three processes of quantum 3 (31-45GB) are requested and all have been awarded,
     </li>
     <li class="itemize">Four processes of quantum 4 (46-60GB) are requested, and two have been awarded.</li></ul>
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-137">
Class&#x00A0;normal&#x00A0;policy&#x00A0;FAIR_SHARE
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;requested&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;5&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;awarded&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0</div>
<!--l. 397--><p class="nopar" >
<!--l. 399--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-25900012.9.5"></a><span 
class="cmti-10">Nodepool section</span></h5>
<!--l. 400--><p class="noindent" >Six lines are displayed for each nodepool:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The name of the nodepool,
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">A summary showing the number hosts in the pool which are online, dead (unresponsive), and varied-off, the
     total quantum shares available to the nodepool, and the total unscheduled or <span 
class="cmti-10">free </span>shares.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The number of hosts known to the nodepool, by quantum, similar to the class listings above,
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">The nubmer of online hosts, by quantum,
     </dd><dt class="enumerate-enumitem">
  5. </dt><dd 
class="enumerate-enumitem">The number of completely free hosts by quantum (no work currently scheduled), and
     </dd><dt class="enumerate-enumitem">
  6. </dt><dd 
class="enumerate-enumitem">The number of <span 
class="cmti-10">virtual </span>hosts, by quantum. A <span 
class="cmti-10">virtual host </span>is created when a host is partially scheduled. For
     example, if a 32G processes is scheduled on a 64G host, this creates one free 32G <span 
class="cmti-10">virtual host</span>.</dd></dl>
<!--l. 413--><p class="noindent" >To determine the number of processes, by quantum, that can be scheduled, one must <span 
class="cmti-10">sum </span>the &#8220;free&#8221; and &#8220;virtual&#8221;
columns.
<!--l. 416--><p class="noindent" >For example, (assuming a 15GB quantum), the following listing shows that nodepool &#8220;power&#8221; contains fourteen
hosts with at least 45GB each (3 quanta). Two of these hosts have something scheduled on them (the &#8220;free
machines&#8221; line), leaving unused space of one 15G quantum on one host, and one 30GB quantum on another
host.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-138">
Nodepool&#x00A0;power
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;online&#x00A0;14&#x00A0;dead&#x00A0;0&#x00A0;offline&#x00A0;0&#x00A0;total-shares&#x00A0;42&#x00A0;free-shares&#x00A0;42
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;all&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;machines:&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;14&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;online&#x00A0;&#x00A0;machines:&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;free&#x00A0;&#x00A0;&#x00A0;&#x00A0;machines:&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;12&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;virtual&#x00A0;machines:&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;0</div>
<!--l. 429--><p class="nopar" >
<!--l. 431--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26000012.9.5"></a><span 
class="cmti-10">Usage:</span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">rm</span><span 
class="cmbx-10">_qload</span> </dt><dd 
class="description">                                                                                                                      <br 
class="newline" />This command has no options.</dd></dl>
<!--l. 438--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.6   </span> <a 
 id="x1-26100012.9.6"></a>rm_qoccupancy</h4>
<!--l. 441--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26200012.9.6"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 442--><p class="noindent" >Rm_qoccupancy provides a list of all known hosts to the RM, and for each host, the following information:
     <ul class="itemize1">
     <li class="itemize">The name of the host,
     </li>
     <li class="itemize">Whether the host has any blacklists processes on it,
     </li>
     <li class="itemize">Whether the host is currently onlline (responsive),
     </li>
     <li class="itemize">The status of the host; whether the host is schedulable (<span 
class="cmti-10">up </span>or <span 
class="cmti-10">down</span>. A responsive host becomes unschedulable
     (<span 
class="cmti-10">down</span>) if it is varied-off,
     </li>
     <li class="itemize">The nodepool the host is a member of,
     </li>
     <li class="itemize">The reported memory size of the host,
     </li>
     <li class="itemize">The <span 
class="cmti-10">order </span>of the host. The <span 
class="cmti-10">order </span>is defined to be the maximum number of quantum shares supported by the
     host,
                                                                                                
                                                                                                
     </li>
     <li class="itemize">The number of unscheduled quantum shares on the host, and
     </li>
     <li class="itemize">If work is scheduled on the host, information relevent to that scheduled processes (or reservation).</li></ul>
<!--l. 457--><p class="noindent" >If work is scheduled on a host, the work summary is keyed thus:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">J</span> </dt><dd 
class="description">The Orchestrator-assigned job id of the work,
     </dd><dt class="description">
<span 
class="cmbx-10">S</span> </dt><dd 
class="description">The RM-assigned share id of the work,
     </dd><dt class="description">
<span 
class="cmbx-10">O</span> </dt><dd 
class="description">The <span 
class="cmti-10">order </span>of the allocation; that is, the number of quantum shares the allocation occupies,
     </dd><dt class="description">
<span 
class="cmbx-10">II</span> </dt><dd 
class="description">The <span 
class="cmti-10">initialization investment</span>; the number of milliseconds the allocated work spent in its initialization phase, if
     any (usually only UIMA-AS processes display this),
     </dd><dt class="description">
<span 
class="cmbx-10">IR</span> </dt><dd 
class="description">The <span 
class="cmti-10">runtime investment</span>; the number of milliseconds spent processing the current CASs, if this is a UIMA-AS
     processes. Note that this number can change dramatically, as it is the sum of time spent only by the current
     CASs. When a CAS completes, it no longer contributes to the investment of the process. The RM uses this
     information to determine the best candidate for eviction, if needed ot maintain fair-share.
     </dd><dt class="description">
<span 
class="cmbx-10">E</span> </dt><dd 
class="description">Whether the RM has preempted (evicted) the process but it has not yet exited,
     </dd><dt class="description">
<span 
class="cmbx-10">P</span> </dt><dd 
class="description">Whether the RM has purged the process (evicted, because the host is non-responsive), but it has not been
     confirmed evicted,
     </dd><dt class="description">
<span 
class="cmbx-10">F</span> </dt><dd 
class="description">Whether the process is <span 
class="cmti-10">fixed</span>; that is, non-preemptbable,
     </dd><dt class="description">
<span 
class="cmbx-10">I</span> </dt><dd 
class="description">Whether the initialization phase is completed (usually only UIMA-AS processes).</dd></dl>
<!--l. 475--><p class="noindent" >The following example shows seven hosts, one with a preemptable share in the <span 
class="cmti-10">&#8211;default&#8211; </span>nodepool (on bluej290-5), and one
with a non-preemptable share in the <span 
class="cmti-10">jobdriver </span>nodepool.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-139">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Node&#x00A0;Blacklisted&#x00A0;Online&#x00A0;Status&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Memory&#x00A0;Order&#x00A0;&#x00A0;&#x00A0;Free
&#x00A0;<br />&#x00A0;&#x00A0;bluej290-5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--default--&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;J[&#x00A0;&#x00A0;&#x00A0;&#x00A0;6006]&#x00A0;S[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;189]&#x00A0;O[2]&#x00A0;II[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0]&#x00A0;IR[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0]&#x00A0;E[False]&#x00A0;P[False]&#x00A0;F[False]&#x00A0;I[False]
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;bluej290-6&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--default--&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;&#x00A0;bluej290-7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;--default--&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;bluej291-26&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;nightly-test&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;bluej291-27&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;nightly-test&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;bluej293-60&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;intel&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2
&#x00A0;<br />&#x00A0;bluej537-73&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;False&#x00A0;&#x00A0;&#x00A0;True&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;up&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;jobdriver&#x00A0;&#x00A0;&#x00A0;32505856&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;J[&#x00A0;&#x00A0;&#x00A0;&#x00A0;5973]&#x00A0;S[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1]&#x00A0;O[1]&#x00A0;II[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0]&#x00A0;IR[&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0]&#x00A0;E[False]&#x00A0;P[False]&#x00A0;F[&#x00A0;True]&#x00A0;I[False]
&#x00A0;<br />
&#x00A0;<br /></div>
<!--l. 491--><p class="nopar" >
<!--l. 494--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26300012.9.6"></a><span 
class="cmti-10">Usage:</span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">rm</span><span 
class="cmbx-10">_qoccupancy</span> </dt><dd 
class="description">                                                                                                              <br 
class="newline" />This command has no options.</dd></dl>
<!--l. 503--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.7   </span> <a 
 id="x1-26400012.9.7"></a>vary_off</h4>
<!--l. 505--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26500012.9.7"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 507--><p class="noindent" >Vary_off is used to remove a host from scheduling and to evict the work that is running on it. This allows for graceful
clearance of a host so the host can be take offline for maintenance, or any other purpose (such as sharing the host with other
applications.) The DUCC agent is NOT stoppped; use <a 
href="#x1-24400012.9.2">stop_ducc</a> to stop the agent. Reservations are not canceled by
<span 
class="cmti-10">vary</span><span 
class="cmti-10">_off</span>.
<!--l. 514--><p class="noindent" >Only the userid that started DUCC may issue <span 
class="cmti-10">vary</span><span 
class="cmti-10">_off</span>; attempts from other userids are rejected.
<!--l. 517--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26600012.9.7"></a><span 
class="cmti-10">Usage: </span></h5>
                                                                                                
                                                                                                
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">vary</span><span 
class="cmbx-10">_off list-of-hosts</span> </dt><dd 
class="description">The <span 
class="cmti-10">list-of-nodes </span>is a space delimited list of host to be removed from scheduling in the DUCC
     cluster.</dd></dl>
<!--l. 525--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.8   </span> <a 
 id="x1-26700012.9.8"></a>vary_on</h4>
<!--l. 527--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26800012.9.8"></a><span 
class="cmti-10">Description:</span></h5>
<!--l. 529--><p class="noindent" >Vary_on is used to restore a host to scheduling by DUCC. If the agent is still alive the host becomes immediately available.
The agent is not started by <span 
class="cmti-10">vary</span><span 
class="cmti-10">_on</span>; use use <a 
href="#x1-23700012.9.1">start_ducc</a> to start the agent if needed.
<!--l. 534--><p class="noindent" >Only the userid that started DUCC may issue <span 
class="cmti-10">vary</span><span 
class="cmti-10">_on</span>; attempts from other userids are rejected.
<!--l. 537--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-26900012.9.8"></a><span 
class="cmti-10">Usage: </span></h5>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">vary</span><span 
class="cmbx-10">_on list-of-hosts</span> </dt><dd 
class="description">The <span 
class="cmti-10">list-of-nodes </span>is a space delimited list of host to be restored for scheduling in the DUCC
     cluster.</dd></dl>
<!--l. 546--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">12.9.9   </span> <a 
 id="x1-27000012.9.9"></a>ducc_properties_manager</h4>
<!--l. 549--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-27100012.9.9"></a><span 
class="cmbx-10">Description:</span></span>
This CLI is used to manually merge or difference two properties files.
<!--l. 552--><p class="noindent" >Normally, the DUCC scripts <span 
class="cmti-10">start</span><span 
class="cmti-10">_ducc, check</span><span 
class="cmti-10">_ducc,</span>, and <span 
class="cmti-10">rm</span><span 
class="cmti-10">_configure </span>automatically merge the file <span 
class="cmti-10">default.ducc.properties</span>
and <span 
class="cmti-10">site.ducc.properties </span>when invoked.
<!--l. 555--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-27200012.9.9"></a><span 
class="cmbx-10">Usage:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_props</span><span 
class="cmbx-10">_manager &#8211;merge file1 &#8211;with file2 &#8211;to file3</span> </dt><dd 
class="description">Merge two properties files into one. Properties added
     to, or changed in, the second file are used to override those in the first file, with the result written to the third
     file.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">ducc</span><span 
class="cmbx-10">_props</span><span 
class="cmbx-10">_manager &#8211;delta file1 &#8211;with file2 &#8211;to file3</span> </dt><dd 
class="description">Compare two properties files and write the differences
     into a third file. The first file is considered a &#8220;master&#8221; file. Properties with different values in the second file,
     or which do not occur in the first file, are written into the third file.</dd></dl>
<!--l. 566--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-27300012.9.9"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">merge file1</span> </dt><dd 
class="description">In this form, the two files specified in the <span 
class="cmsy-10">--</span><span 
class="cmti-10">with </span>and <span 
class="cmsy-10">--</span><span 
class="cmti-10">to </span>fields are merged, with the results
     placed in <span 
class="cmsy-10">--</span>file3. Overrides are flagged with a change tag and the date of the merge.
     <!--l. 572--><p class="noindent" ><span 
class="cmti-10">file1 </span>is considered the &#8220;master&#8221; properties file and is usually the unmodified file provided with the DUCC
     distribution, <span 
class="cmti-10">default.ducc.properties</span>.
     <!--l. 575--><p class="noindent" ><span 
class="cmti-10">file2  </span>is  considered  a  set  of  override  or  additional  properties  and  is  usually  the  site  local  properties  file,
     <span 
class="cmti-10">site.ducc.properties.</span>
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">delta file1</span> </dt><dd 
class="description">In this form, the two files specified in the <span 
class="cmsy-10">--</span><span 
class="cmti-10">with </span>and <span 
class="cmsy-10">--</span><span 
class="cmti-10">to </span>fields are compared, with differences
     placed in <span 
class="cmsy-10">--</span>file3.
     <!--l. 582--><p class="noindent" ><span 
class="cmti-10">file1 </span>is considered the &#8220;master&#8221; properties file and is usually the unmodified file provided with the DUCC
     distribution, <span 
class="cmti-10">default.ducc.properties</span>.
     <!--l. 585--><p class="noindent" ><span 
class="cmti-10">file2 </span>is considered the &#8220;external&#8221; properties file and is usually the properties file from an older version of DUCC.
     <!--l. 588--><p class="noindent" >Differences are placed in <span 
class="cmsy-10">--</span><span 
class="cmti-10">file3 </span>which may be a viable first cut at a new <span 
class="cmti-10">site.ducc.properties.</span>
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">with file2</span> </dt><dd 
class="description">This specifies the properties file to merge with the master, or to difference with the master properties
     file.
     </dd><dt class="description">
<span 
class="cmsy-10">--</span><span 
class="cmbx-10">to file3</span> </dt><dd 
class="description">This specifies the file to which the results of the merge or delta are written.</dd></dl>
<!--l. 596--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-27400012.9.9"></a><span 
class="cmbx-10">Notes:</span></span>
None.
<!--l. 22--><p class="noindent" ><a name='DUCC_RM'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;13</span><br /><a 
 id="x1-27500013"></a>Resource Management</h2>
<h3 class="sectionHead"><span class="titlemark">13.1   </span> <a 
 id="x1-27600013.1"></a>Overview</h3>
<!--l. 28--><p class="noindent" >The DUCC Resource Manager is responsible for allocating cluster resources among the various requests for work in the
system. DUCC recognizes several categories of work:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Managed Jobs</span> </dt><dd 
class="description">Managed jobs are Java applications implemented in the UIMA framework and are scaled out by
     DUCC as some number of discrete processes. Processes which compose managed jobs are always restartable
     and usually preemptable. Preemption occurs as a consequence of enforcing fair-share scheduling policies.
     </dd><dt class="description">
<span 
class="cmbx-10">Services</span> </dt><dd 
class="description">Services are long-running processes which perform some (common) function on behalf of jobs or other
     services. Services are scaled out as a set of, from the RM point of view, unrelated non-preemptable processes.
     </dd><dt class="description">
<span 
class="cmbx-10">Reservations</span> </dt><dd 
class="description">A reservation provides non-preemptable, persistent, dedicated use of a full machine or some part of
     a machine to a specific user.
     </dd><dt class="description">
<span 
class="cmbx-10">Arbitrary Processes</span> </dt><dd 
class="description">An <span 
class="cmti-10">arbitrary process </span>or <span 
class="cmti-10">managed reservation </span>is any process at all, which may or may not
     have anything to do with UIMA. These processes are typically used to run non-UIMA tasks such as application
     builds, large Eclipse workspaces for debugging, etc. These processes are usually scheduled as non-preemptable
     allocations, occupying either a dedicated machine or some portion of a machine.
     </dd></dl>
<!--l. 56--><p class="noindent" >To apportion the cumulative memory resource among requests the Resource Manager defines some minimum unit of memory
and allocates machines such that a &#8221;fair&#8221; number of &#8221;memory units&#8221; are awarded to every user of the system. This minimum
quantity is called a share quantum, or simply, a share. The scheduling goal is to award an equitable number of
memory shares to every user of the system. The memory shares in a system are divided equally among all the
users who have work in the system. Once an allocation is assigned to a user, that user&#8217;s jobs are then also
assigned an equal number of shares, out of the user&#8217;s allocation. Finally, the Resource Manager maps the
share allotments to physical resources. To map a share allotment to physical resources, the Resource Manager
considers the amount of memory that each job declares it requires for each process. That per-process memory
requirement is translated into the minimum number of collocated quantum shares required for the process to
run.
<!--l. 68--><p class="noindent" >To compute the memory requirements for a job, the declared memory is rounded up to the nearest multiple of the share
quantum. The total number of quantum shares for the job is calculated, and then divided by the number of quantum
shares declared for the job to arrive at the number of processes to allocate. The output of each scheduling
cycle is always in terms of processes, where each process is allowed to occupy some number of shares. The
DUCC agents implement a mechanism to ensure that no user&#8217;s job processes exceed their allocated memory
assignments.
<!--l. 75--><p class="noindent" >For example, suppose the share quantum is 15GB. A job that declares it requires 14GB per process is assigned one quantum
share per process. If that job is assigned 20 shares, it will be allocated 20 processes across the cluster. A job that declares
28GB per process would be assigned two quanta per process. If that job is assigned 20 shares, it is allocated 10 processes
across the cluster. Both jobs occupy the same amount of memory; they consume the same level of system resources. The
second job does so in half as many processes.
<!--l. 83--><p class="noindent" >Some work may be deemed to be more &#8221;important&#8221; than other work. To accommodate this, the RM implements a weighted
fair-share scheduler. During the fair share calculations, jobs with higher weights are assigned more shares proportional to
their weights; jobs with lower weights are assigned proportionally fewer shares. Jobs with equal weights are assigned an equal
number of shares.
<!--l. 89--><p class="noindent" >The abstraction used to organized jobs by fair-share weight is the job class or simply <span 
class="cmti-10">class</span>. All job submissions must included
                                                                                                
                                                                                                
a declared job class; if none is declared, a default class is chosen by DUCC. As jobs enter the system they are grouped
with other jobs of the same class weight. The class abstraction and its attributes are described in <a 
href="#x1-28400013.7">subsequent
sections</a>.
<!--l. 95--><p class="noindent" >The scheduler executes in three primary phases:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The How-Much phase: every job is assigned some number of quantum shares, which is converted to the number
     of processes of the declared size.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">The What-Of phase: physical machines are found which can accommodate the number of processes allocated by
     the How-Much phase. Jobs are mapped to physical machines such that the total declared per-process amount
     of memory for all jobs scheduled to a machine do not exceed the physical memory on the machine.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Defragmentation. If the what-of phase cannot allocate space according to the output of the how-much phase,
     the system is said to be <span 
class="cmti-10">fragmented. </span>The RM scans for &#8220;rich&#8221; jobs and will attempt to preempt some small
     number of processes sufficient to guarantee every job gets at least one process allocation. (Note that sometimes
     this is not possible, in which case unscheduled work remaims pending until such time as space is freed-up.)
     </dd></dl>
<!--l. 120--><p class="noindent" >The How-Much phase is itself subdivided into three phases:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Class counts:Apply weighed fair-share to all the job classes that have jobs assigned to them. This apportions
     all shares in the system among all the classes according to their weights. This phase takes into account all users
     and all jobs in the system.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">User counts: For each class, collect all the users with jobs submitted to that class, and apply fair-share (with
     equal weights) to equally divide all the class shares among the users.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">Job counts: For each user, collect all jobs assigned to that user and equally divide all the user&#8217;s shares among
     the jobs. This apportions all shares given to this user for each class among the user&#8217;s jobs in that class.</dd></dl>
<!--l. 138--><p class="noindent" >All non-preemptable allocations are restricted to one allocation per request. If space is available, the request succeeds
immediately. If space can be made for the request through preemptions, the preemptions are scheduled and the
reservation is deferred until space is available. If space cannot be found by means of preemption, the reservation
remains pending until it either succeeds (by cancelation of other non-preemptive work, by adding resources to
the system, or by increasing the user&#8217;s non-preemptive allotment), or until it is canceled by the user or an
administrator.
<!--l. 146--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.2   </span> <a 
 id="x1-27700013.2"></a>Preemption vs Eviction</h3>
<!--l. 147--><p class="noindent" >The RM makes a subtle distinction between <span 
class="cmti-10">preemption </span>and <span 
class="cmti-10">eviction</span>.
<!--l. 149--><p class="noindent" ><span 
class="cmti-10">Preemption </span>occurs only as a result of fair-share calculations or defragmentation. Preemption is the process of deallocating
shares from jobs beloing to users whose current allocation exceeds their fair-share, and conversely, only processes belonging to
fair-share jobs can be preempted. This is generally dynamic: more jobs in the system result in a smaller fair-share for any
given user, and fewer jobs result in a higher fair-share allocation.
<!--l. 158--><p class="noindent" ><span 
class="cmti-10">Eviction </span>occurs only as a result of system-detected errors, changes in node configuration, or changes in class configuration.
Eviction may affect both preemptable work and some types of non-preemptable work.
                                                                                                
                                                                                                
<!--l. 163--><p class="noindent" >Work that is non-preemptable, but restartable can be evicted. Such work consists of service processes (which are
automatically resubmitted by the Service Manager), and managed reservations, which can be resubmitted by the
user.
<!--l. 167--><p class="noindent" >Unmanaged reservations are never evicted for any reason. If something occurs that would result in the reservation being
(fatally) misplaced, the node is marked unschedulable and remains as such until the condition is corrected or the reservation
is canceled. Once the condition is repaired (either the reservaiton is canceled, or the problem is corrected), the node becomes
schedulable again.
<!--l. 173--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.3   </span> <a 
 id="x1-27800013.3"></a>Scheduling Policies</h3>
<!--l. 175--><p class="noindent" >The Resource Manager implements three scheduling policies. Scheduling policies are associated with <a 
href="#x1-28400013.7"><span 
class="cmti-10">classes</span></a>.
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">FAIR</span><span 
class="cmbx-10">_SHARE</span> </dt><dd 
class="description">This is weighted-fair-share. All processes scheduled under fair-share are always <span 
class="cmti-10">preemptable</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">FIXED</span><span 
class="cmbx-10">_SHARE</span> </dt><dd 
class="description">The FIXED_SHARE policy is used to allocate non-preemptable shares. The shares might be
     <span 
class="cmti-10">evicted </span>as described above, but they are never <span 
class="cmti-10">preempted</span>. Fixed share alloations are restricted to one allocation
     per request and may be subject to <a 
href="#x1-27900013.4">allotment caps</a>.
     <!--l. 186--><p class="noindent" >FIXED_SHARE allocations have several uses:
         <ul class="itemize1">
         <li class="itemize">Unmaged reservations. In this case DUCC starts no work in the share(s); the user must log in (or run
         something via ssh), and then manually release the reservation to free the resources. This is often used for
         testing and debugging.
         </li>
         <li class="itemize">Services. If a service is registered to run in a FIXED_SHARE allocation, DUCC allocates the resources,
         starts and manages the service, and releases the resource if the service is stopped or unregistered.
         </li>
         <li class="itemize">UIMA  jobs.  A  &#8220;normal&#8221;  UIMA  job  may  be  submitted  to  a  FIXED_SHARE  class.  In  this  case,  the
         processes are never preempted, allowing constant and predictable execution of the job. The resources are
         automatically released when the job exits.
         </li>
         <li class="itemize">Managed reservations. The <a 
href="#x1-720003.12"><span 
class="cmti-10">viaducc</span></a> utility is provided as a convenience for running managed reservations.</li></ul>
     </dd><dt class="description">
<span 
class="cmbx-10">RESERVE</span> </dt><dd 
class="description">The RESERVE policy is used to allocate a full, dedicated machine. The allocation may be <span 
class="cmti-10">evicted </span>but it
     is never <span 
class="cmti-10">preempted</span>. It is restricted to a single machine per request. The memory size specified in the
     reservation must match machine size exactly, within the limits of rounding to the next highest multiple of
     the quantum. DUCC will not &#8220;promote&#8221; a reservation request to a larger machine than is asked for. A
     reservation that does not adequately match any machine remains pending until resources are made
     available or it is canceled by the user or an administrator. Reservations may be subject to <a 
href="#x1-27900013.4">allotment
     caps</a>.
     </dd></dl>
<!--l. 215--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.4   </span> <a 
 id="x1-27900013.4"></a>Allotment</h3>
                                                                                                
                                                                                                
<!--l. 218--><p class="noindent" >Allotment is a new concept introduced with DUCC 2.0.0 to prevent non-preemptable requests from dominating a cluster.
This replaces the DUCC version 1 class policies of max-processes and max-machines.
<!--l. 222--><p class="noindent" >It is possible to associate a maximum share allotment with any non-preemptable class. Allotment is assigned per user and is
global across all non-preemptable classes. It is configured <a 
href="#x1-21300012.4">ducc.properties</a> with <span 
class="cmti-10">ducc.rm.global</span><span 
class="cmti-10">_allotment</span>.
<!--l. 226--><p class="noindent" >A simple user registry provides per-user overrides of the global allotment as needed. The registry may be included in the class
definition file (specified in ducc.properties under ducc.rm.class.definitions), or in a separate file, specified in ducc.properties as
<span 
class="cmti-10">ducc.rm.user.registry</span>.
<!--l. 232--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.5   </span> <a 
 id="x1-28000013.5"></a>Priority vs Weight</h3>
<!--l. 234--><p class="noindent" >It is possible that the various policies may interfere with each other. It is also possible that the fair share weights are not
sufficient to guarantee sufficient resources are allocated to high importance jobs. Class-based priorities are used to resolve
these conflicts.
<!--l. 238--><p class="noindent" >Simply: priority is used to specify the order of evaluation of the job classes. Weight is used to proportionally allocate the
number of shares to all classes of the same priority under the weighted fair-share policies.
<!--l. 243--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-28100013.5"></a><span 
class="cmbx-10">Priority.</span></span>
When a scheduling cycle starts, the scheduling classes are ordered from &#8221;best&#8221; to &#8221;worst&#8221; priority. The scheduler then
attempts to allocate ALL of the system&#8217;s resources to the &#8221;best&#8221; priority class. If any resources are left, the scheduler
proceeds to schedule classes in the next best priority, and so on, until either all the resources are exhausted or there is no
more work to schedule.
<!--l. 251--><p class="noindent" >It is possible to have multiple job classes of the same priority. What this means is that resources are allocated for
the set of job classes from the same set of resources at the same time, usually under weighted fair-share. (It
would be unusual to have multiple non-preemptable classes at the same priority. If this is configured, the
class requests are filled arbitrarily with no attempt to divide the resources fairly or equitably). Resources for
higher priority classes will have already been allocated, resources for lower priority classes may never become
available.
<!--l. 259--><p class="noindent" >To constrain high priority jobs from completely monopolizing the system, fair-share weights are used for FAIR_SHARE
classes, and allotment is used for non-preemptable classes.
<!--l. 263--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-28200013.5"></a><span 
class="cmbx-10">Weight.</span></span>
Weight is used to determine the relative importance of jobs in a set of job classes of the same priority when doing fair-share
allocation. All job classes of the same priority are assigned shares from the full set of available resources according to their
weights using weighted fair-share. Weights are used only for fair-share allocation.
<!--l. 268--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.6   </span> <a 
 id="x1-28300013.6"></a>Node Pools</h3>
<!--l. 269--><p class="noindent" >It may be desired or necessary to constrain certain types of resource allocations to a specific subset of the resources. Some
nodes may have special hardware, or perhaps it is desired to prevent certain types of jobs from being scheduled on some
specific set of machines. Nodepools are designed to provide this function.
                                                                                                
                                                                                                
<!--l. 274--><p class="noindent" >Nodepools impose hierarchical partitioning on the set of available machines. A nodepool is a subset of the full
set of machines in the cluster. Nodepools may not overlap. A nodepool may itself contain non-overlapping
subpools.
<!--l. 278--><p class="noindent" >Job classes are associated with nodepools. The scheduler treates preemptable work and non-preemptable work differently
with regards to nodepools:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Preemptable work.</span> </dt><dd 
class="description">The scheduler will attempt to allocate preemptable work in the nodepool associated with the
     work&#8217;s class. If this nodepool becomes exhausted, and there are subpools, the scheduler proceeds to try to
     allocate resources within the subpools, recursively, until either all work is scheduled or there is no more work
     to schedule. (Allocations made within subpools are referred to as &#8220;squatters&#8221;; aloocations made in the directly
     associated nodepool are referred to as &#8220;residents&#8221;.)
     <!--l. 288--><p class="noindent" >During eviction, the scheduler attempts to evict squatters first and only evicts residents once all the squatters
     are gone.
     </dd><dt class="description">
<span 
class="cmbx-10">Non-Preemptable work.</span> </dt><dd 
class="description">Non-preemptable work can only be allocated directly in the nodepool associated with
     the work&#8217;s class. Such work can never become a squatter. The reason is that non-preemptbable squatters cannot
     be evicted, and so could dominate pools intended for other work.</dd></dl>
<!--l. 297--><p class="noindent" >More information on nodepools and their configuration can be <a 
href="#x1-22600012.6.1">found here</a>.
<!--l. 299--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">13.7   </span> <a 
 id="x1-28400013.7"></a>Scheduling Classes</h3>
<!--l. 301--><p class="noindent" >The primary abstraction to control and configure the scheduler is the <span 
class="cmti-10">class</span>. A class is simply a set of rules used to
parametrize how resources are assigned to work requests. Every request that enters the system is associated with a single
class.
<!--l. 305--><p class="noindent" >The scheduling class defines the following rules:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Priority</span> </dt><dd 
class="description">This is the order of evaluation and assignment of resources to this class. See the discussion of priority vs
     Weight for details.
     </dd><dt class="description">
<span 
class="cmbx-10">Weight</span> </dt><dd 
class="description">This is used for the weighted fair-share calculations.
     </dd><dt class="description">
<span 
class="cmbx-10">Scheduling Policy</span> </dt><dd 
class="description">This defines the policy, fair share, fixed share, or reserve used to schedule the jobs in this class.
     </dd><dt class="description">
<span 
class="cmbx-10">Nodepool</span> </dt><dd 
class="description">A  class  may  be  associated  with  exactly  one  nodepool.  Fair-share  jobs  submitted  to  the  class  are
     assigned only resources which lie in that nodepool, or in any of the subpools defined within that nodepool.
     Non-preemptable requests must always be fulfilled from the nodepool assigned to the class; subpools are exempt
     from non-preemptable requests submitted to higher-level nodepools.
     </dd><dt class="description">
<span 
class="cmbx-10">Prediction</span> </dt><dd 
class="description">For the type of work that DUCC is designed to run, new processes typically take a great deal of time
     initializing. It is not unusual to experience 30 minutes or more of initialization before work items start to be
     processed.
     <!--l. 326--><p class="noindent" >When a job is expanding (i.e. the number of assigned processes is allowed to dynamically increase), it may be
     that the job will complete before the new processes can be assigned and the analytics within them complete
     initialization. In this situation it is wasteful to allow the job to expand, even if its fair-share is greater than the
                                                                                                
                                                                                                
     number of processes it currently has assigned.
     <!--l. 332--><p class="noindent" >By enabling prediction, the scheduler will consider the average initialization time for processes in this job,
     current rate of work completion, and predict the number of processes needed to complete the job in the optimal
     amount of time. If this number is less than the job&#8217;s fair, share, the actual allocation is capped by the predicted
     needs.
     </dd><dt class="description">
<span 
class="cmbx-10">Prediction Fudge</span> </dt><dd 
class="description">When doing prediction, it may be desired to look some time into the future past initialization
     times to predict if the job will end soon after it is expanded. The prediction fudge specifies a time past the
     expected initialization time that is used to predict the number of future shares needed. This avoids wasteful
     preemption of work to make space for other work that will be completing very soon anyway.
     </dd><dt class="description">
<span 
class="cmbx-10">Initialization cap</span> </dt><dd 
class="description">Because of the long initialization time of processes in most DUCC jobs, process failure during
     the initialization phase can be very expensive in terms of wasted resources. If a process is going to fail because
     of bugs, missing services, or any other reason, it is best to catch it early.
     <!--l. 348--><p class="noindent" >The initialization cap is used to limit the number of processes assigned to a job until it is known that at least
     one process has successfully passed from initialization to running. As soon as this occurs the scheduler will
     proceed to assign the job its full fair-share of resources.
     </dd><dt class="description">
<span 
class="cmbx-10">Expand By Doubling</span> </dt><dd 
class="description">Even after initialization has succeeded, it may be desired to throttle the rate of expansion
     of a job into new processes.
     <!--l. 355--><p class="noindent" >When expand-by-doubling is enabled, the scheduler allocates either twice the number of resources a job currently
     has, or its fair-share of resources, whichever is smallest.
     <!--l. 358--><p class="noindent" >If expand-by-doubling is disabled, jobs are allocated their full fair-share immediately.
     </dd></dl>
<!--l. 362--><p class="noindent" >More information on nodepools and their configuration can be <a 
href="#x1-23000012.6.2">found here</a>.
<!--l. 22--><p class="noindent" ><a name='DUCC_RM'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;14</span><br /><a 
 id="x1-28500014"></a>Service Management</h2> The only administrative task relating to Service Management is registering global pingers, as
described in <a 
href="#x1-980005.6.5"><span 
class="cmti-10">Service Pingers section</span></a> of this document.
<!--l. 30--><p class="noindent" >A globally-registered service pinger is a properties file that contains only service registraton options pertaining to pingers.
This file must be placed in DUCC&#8217;s <span 
class="cmti-10">runtime</span>/resources/service_monitors directory. It may be given any name but &#8220;best
practices&#8221; would suggest it be named the same as the <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_class</span>. Services then use this pinger by specifying its
filename in their <span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_class </span>option.
<!--l. 37--><p class="noindent" >Globally-registered pingers may be run internally as threads within the SM, or externally as processes. To specify that a
pinger be run internally, add the property
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-140">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal&#x00A0;=&#x00A0;true</div>
<!--l. 42--><p class="nopar" > to the registration file. To specify that it run externall, add the property
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-141">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;internal&#x00A0;=&#x00A0;false</div>
<!--l. 46--><p class="nopar" > to the registration file.
<!--l. 49--><p class="noindent" >The &#8220;internal&#8221; option is flagged as in illegal option when specified in service registrations and all pingers not specified as
&#8220;internal&#8221; are run as <span 
class="cmti-10">external </span>processes managed by the SM.
<!--l. 53--><p class="noindent" >Best practices dictate that the filename of an <span 
class="cmti-10">external </span>pinger contain the postfix <span 
class="cmti-10">.external </span>to clearly identify it as
external.
<!--l. 56--><p class="noindent" >As an example, the default UIMA-AS pinger is supplied in the global registery under the two names:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-142">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;org.apache.uima.ducc.cli.UimaAsPing
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;org.apache.uima.ducc.cli.UimaAsPing.external</div>
<!--l. 61--><p class="nopar" >
<!--l. 63--><p class="noindent" >Note that users may override any of the properties in globally-registered <span 
class="cmti-10">external </span>pingers, but only the
<span 
class="cmti-10">service</span><span 
class="cmti-10">_ping</span><span 
class="cmti-10">_arguments </span>of an <span 
class="cmti-10">internal </span>pinger to protect its integrity by speicfy that argument in their own service
registrations.
<!--l. 22--><p class="noindent" ><a name='DUCC\protect \unhbox \voidb@x {\unhbox \voidb@x \special {t4ht@95}x}SIM'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;15</span><br /><a 
 id="x1-28600015"></a>Simulation and System Testing</h2> This chapter describes the large-scale testing and cluster-simulation tools supplied
with DUCC. This is of use mostly to contributors and developers of DUCC itself.
<!--l. 30--><p class="noindent" >DUCC is shipped with support for simulating large clusters of arbitrarily configured nodes. A simple control file describes
some number of simulated nodes of arbitrary memory sizes. DUCC&#8217;s design allows multiples of these to be spawned on a
single node, or on a small set of nodes with multiple simulated nodes apiece. The standard testing configuration used for
most of the development of DUCC consisted of four physical 32-GB machines running 52 simulated nodes of varying memory
sizes from 32 to 128-GB each.
<!--l. 39--><p class="noindent" >To simulate job loads, a simple UIMA-AS job that sleeps for some easily configured length of time was constructed. Another
control file is used to generate <a 
href="#x1-270003.5">job specifications</a> requesting randomly-chosen job parameters such as memory requirements,
service dependencies, scheduling classes, and so on.
<!--l. 44--><p class="noindent" >The test suite contains a simple UIMA Analysis Engine called <span 
class="cmtt-10">FixedSleepAE</span>, and a simple Collection Reader called
<span 
class="cmtt-10">FixedSleepCR</span>. The CR reads a set of sleep times, creates CASs, and ships them to the AEs via DUCC&#8217;s Job Driver. The
CAS contains the time to sleep and various parameters regarding error injection.
<!--l. 51--><p class="noindent" >The AE receives a CAS, performs error injection if requested, and sleeps the indicated period of time, simulating actual
computation but requiring very few physical resources. Hence, many of these may be run simultaneously on relatively modest
hardware.
<!--l. 56--><p class="noindent" >Developers may construct arbitrary jobs by creating a file with sleep times designed to exercise what ever is necessary. DUCC
ships with the three primary job collections (test suites) used during initial development. The suites are based on
actual workloads and have shown to be very robust for proving the correctness of the DUCC code under
stress.
<!--l. 63--><p class="noindent" >The cluster simulator has been also been run on a 4GB iMac with 8 simulated Agents, an 8GB MacBook with the same
configuration, a 32GB iMac with up to 40 simulated Agents. It has also been scaled up to run on 8 45GB Intel nodes running
Linux, simulating 20TB of memory.
<!--l. 67--><p class="noindent" >The rest of this chapter describes the mechanics of using these tools.
<h3 class="sectionHead"><span class="titlemark">15.1   </span> <a 
 id="x1-28700015.1"></a>Cluster Simulation</h3>
<!--l. 71--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.1.1   </span> <a 
 id="x1-28800015.1.1"></a>Overview</h4>
<!--l. 72--><p class="noindent" >Cluster-based tools such as DUCC are very hard to test and debug because all interesting problems occur only when the
system is under stress. Acquisition of a cluster of sufficient size to expose the interesting problems is usually not
practical.
<!--l. 77--><p class="noindent" >DUCC&#8217;s design divorces all the DUCC processes from specific IP addresses or node names. ActiveMQ is used as a nameserver
and packet router so that all messages can be delivered by name, irrespective of the physical hardware the destination process
may reside upon.
<!--l. 83--><p class="noindent" >A DUCC system is comprised of three types of processes (daemons):
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The DUCC management daemons:
         <ul class="itemize1">
         <li class="itemize">The Orchestrator (OR). This is the primary point of entry to the system and is responsible for managing
         the life cycle of all work in the system.
         </li>
         <li class="itemize">The Process Manager (PM). This is responsible for managing message flow to and from the DUCC Agents.
                                                                                                
                                                                                                
         </li>
         <li class="itemize">The <a 
href="#x1-27500013">Resource Manager</a> (RM). This is responsible for apportioning system resources among submitted
         work (jobs, reservations, services).
         </li>
         <li class="itemize">The <a 
href="#x1-800005">Service Manager</a> (SM). This is responsible for keeping services active and available as needed.
         </li>
         <li class="itemize">The Web Server (WS). This process listens to all the state messages in the system to provide a coherent
         view of DUCC to the outside world.</li></ul>
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">The DUCC Node Agents, or simply, Agents. There is one Agent running on every physical node.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The ActiveMQ Broker. All message flow in the system is directed through the ActiveMQ broker, with the exception of
     the CLI, (which uses HTTP).</dd></dl>
<!--l. 108--><p class="noindent" >Normally, the DUCC Agents report the name, IP address, and physical memory of the node they actually do
reside upon. This is simply for convenience. It is possible to parametrize the DUCC Agents to report any
arbitrary name and address to the DUCC. DUCC components that need to know about Node Agents establish
subscriptions to the Agent publications with ActiveMQ and build up their internal structures from the node
identities in the Agent publications. Processes which normally establish agent listeners are are the RM, PM, and
WS.
<!--l. 117--><p class="noindent" >It is also possible to parametrize a DUCC agent to cause it to report any arbitrary memory size. Thus, an agent running on a
2GB machine can be started so that it reports 32GB of memory. This parametrization is specifically for testing, of
course.
<!--l. 122--><p class="noindent" >The ability to parametrize agent identities and memory sizes is what enables cluster simulation. A control file is used by
start-up scripting to spawn multiple agents per node, each with unique identities.
<!--l. 126--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.1.2   </span> <a 
 id="x1-28900015.1.2"></a>Node Configuration</h4>
<!--l. 128--><p class="noindent" >A Java properties file is used to configure simulated nodes. There are three types o entries in this file:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">nodes</span> </dt><dd 
class="description">This single entry provides the blank-delimited names of the physical nodes participating in the simulated
     cluster.
     </dd><dt class="description">
<span 
class="cmbx-10">memory</span> </dt><dd 
class="description">This single line consists of a blank-delimited set of numbers. Each number corresponds to some memory
     size, in GB, to be simulated.
     </dd><dt class="description">
<span 
class="cmbx-10">node descriptions</span> </dt><dd 
class="description">There are one or more of these. The format of each line is
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-143">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;[nodename].[memory]&#x00A0;=&#x00A0;[count]</div>
     <!--l. 140--><p class="nopar" > where
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">nodename</span> </dt><dd 
class="description">is the name of one of the nodes in the <span 
class="cmti-10">nodes </span>line mentioned above.
         </dd><dt class="description">
     <span 
class="cmbx-10">memory</span> </dt><dd 
class="description">is one of the memory sizes given in the <span 
class="cmti-10">memory </span>line mentioned above.
         </dd><dt class="description">
     <span 
class="cmbx-10">count</span> </dt><dd 
class="description">is the number of simulated agents in the indicated node, with the indicated memory, to be simulated.</dd></dl>
     </dd></dl>
<!--l. 152--><p class="noindent" >For example, the following simulated cluster configuration defines twenty (20) simulated nodes, all to be run on the single
physical machine called <span 
class="cmti-10">agentn</span>. The simulated nodes contain a mix of 31GB, 47GB, and 79GB memory sizes. There are 7
31GB nodes, 7 47GB nodes, and 6 79GB nodes.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-144">
#&#x00A0;names&#x00A0;of&#x00A0;nodes&#x00A0;in&#x00A0;the&#x00A0;test&#x00A0;cluster
&#x00A0;<br />nodes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;agentn
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;set&#x00A0;of&#x00A0;memory&#x00A0;sizes&#x00A0;to&#x00A0;configure
&#x00A0;<br />memory&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;31&#x00A0;47&#x00A0;79
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;how&#x00A0;to&#x00A0;configure&#x00A0;memories:&#x00A0;node.memsize&#x00A0;=&#x00A0;count
&#x00A0;<br />agentn.31&#x00A0;=&#x00A0;7
&#x00A0;<br />agentn.47&#x00A0;=&#x00A0;7
&#x00A0;<br />agentn.79&#x00A0;=&#x00A0;6</div>
<!--l. 167--><p class="nopar" >
<!--l. 169--><p class="noindent" >The nodenames generated by this means are the name of the physical node where the agent is spawned, and a numeric id
appended, for example,
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-145">
&#x00A0;&#x00A0;agentn-1
&#x00A0;<br />&#x00A0;&#x00A0;agentn-2
&#x00A0;<br />&#x00A0;&#x00A0;agentn-3
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;etc.</div>
<!--l. 176--><p class="nopar" >
<!--l. 178--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.1.3   </span> <a 
 id="x1-29000015.1.3"></a>Setting up Test Mode</h4>
<!--l. 180--><p class="noindent" >During simulation and testing it is desirable and usually required that DUCC run in unprivileged mode, with all processes
belonging to a single userid. Unfortunately, this does not exercise any of the multi-user code paths, especially in the Resource
Manager.
<!--l. 185--><p class="noindent" >To accommodate this, DUCC can be configured to run in &#8220;test mode&#8221;, such that work is submitted under &#8220;simulated&#8221;
userid which DUCC treats as discrete IDs. All actual work is executed under the ownership of the tester
however.
<!--l. 189--><p class="noindent" >To establish test mode:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Ensure that <span 
class="cmti-10">ducc.properties </span>is configured to point to a non-privileged version of <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_ling</span>. Specifically, configure this
     line in <span 
class="cmti-10">ducc.properties</span>
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-146">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc.agent.launcher.ducc_spawn_path=/home/ducctest/duccling.dir/amd64/ducc_ling</div>
     <!--l. 195--><p class="nopar" > in this example a version of <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_ling </span>known to not have elevated privileges it configured.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Configure test mode in <span 
class="cmti-10">ducc.properties</span>:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-147">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;ducc.runmode=Test</div>
     <!--l. 201--><p class="nopar" > IMPORTANT: Do not start DUCC with <span 
class="cmti-10">ducc.runmode=Test </span>if <span 
class="cmti-10">ducc</span><span 
class="cmti-10">_ling </span>has elevated privileges. Test mode bypasses
     the authentication and authorization checks that are normally used and the system would run completely
     open.</dd></dl>
<!--l. 207--><p class="noindent" >In test mode, jobs may specify what simulated userid is to be used. Most of DUCC does not pay any attention to the
user so this works fine, and the parts that do care about the user are bypassed when <span 
class="cmti-10">ducc.runmode=Test </span>is
configured.
<!--l. 211--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.1.4   </span> <a 
 id="x1-29100015.1.4"></a>Starting a Simulated Cluster</h4>
<!--l. 212--><p class="noindent" >DUCC provides a start-up script in the directory <span 
class="cmtt-10">$DUCC</span><span 
class="cmtt-10">_HOME/examples/systemtest </span>called <span 
class="cmtt-10">start</span><span 
class="cmtt-10">_sim</span>.
<!--l. 215--><p class="noindent" >WARNING: Cluster simulation is intended for DUCC testing, including error injection. It is similar to flying a
high-performance fighter jet. It is intentionally twitchy. Very little checking is done and processes may be started multiple
time regardless of whether is sane to do this.
<!--l. 220--><p class="noindent" >To start a simulated cluster, use the <span 
class="cmti-10">start</span><span 
class="cmti-10">_sim </span>script:
<!--l. 222--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29200015.1.4"></a><span 
class="cmbx-10">Description:</span></span>
The <span 
class="cmti-10">start</span><span 
class="cmti-10">_sim </span>script is used to start a simulated cluster.
<!--l. 225--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29300015.1.4"></a><span 
class="cmbx-10">Usage:</span></span>
<span 
class="cmti-10">start</span><span 
class="cmti-10">_sim </span>options
<!--l. 228--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29400015.1.4"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-n, &#8211;nodelist [nodelist]</span> </dt><dd 
class="description">where the nodelist is a cluster description as described above.
     </dd><dt class="description">
<span 
class="cmbx-10">-c &#8211;components [component list]</span> </dt><dd 
class="description">. The component list is a blank-delimited list of components including <span 
class="cmti-10">or, rm,</span>
     <span 
class="cmti-10">sm, pm, ws, broker </span>to start an individual component, or <span 
class="cmti-10">all </span>to start all of the components. NOTE: It is usually
     an error to start any of these components more than once. However <span 
class="cmti-10">start</span><span 
class="cmti-10">_sim </span>allows it, to permit error injection.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;nothreading</span> </dt><dd 
class="description">If specified, the command does not run in multi-threaded mode even if it is supported on the local
     platform.
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 242--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.1.5   </span> <a 
 id="x1-29500015.1.5"></a>Stopping a Simulated Cluster</h4>
<!--l. 244--><p class="noindent" >There are two mechanisms for stopping a simulated cluster:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem"><span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -k </span>This looks for all DUCC processes on the nodes in $DUCC_HOME/resources/ducc.nodes and
     issues <span 
class="cmti-10">kill -9 </span>to each process. It then removes the Orchestrator lock file. This is the most violent and surest
     way to stop a simulated DUCC cluster. In order for this to work, be sure to include the names of all physical
     nodes used in the simulated cluster in the DUCC configuration file <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/ducc.nodes. </span>It
     is described in the <a 
href="#x1-24900012.9.3">administration section</a> of the book.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem"><span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>With no arguments, this attempts to stop all the simulated agents and the management daemons
     using <span 
class="cmti-10">kill -INT</span>. It is possible to stop individual agents or management nodes by specifying their component
     IDs. The kill signals <span 
class="cmti-10">-KILL, -STOP </span>and <span 
class="cmti-10">-CONT </span>are all supported. This allows error injection as well as a more
     orderly shutdown than <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -k</span>.</dd></dl>
<!--l. 263--><p class="noindent" >Note that <a 
href="#x1-24900012.9.3"><span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc</span></a> is found in <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/admin</span>. The <span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>script is found in <span 
class="cmti-10">duccruntime/examples/systemtest</span>.
<!--l. 268--><p class="noindent" >The <span 
class="cmti-10">start</span><span 
class="cmti-10">_sim </span>script creates a file called <span 
class="cmti-10">sim.pids </span>containing the physical node name, Unix process ID (PID), and component
ID (ws, sm, or, pm, rm) of each started DUCC component. In the case of agents, each agent is assigned a
number as a unique id. These ids are used with <span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>to affect specific processes. If the cluster is stopped
without using <span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim</span>, or if it simply crashes, this PID file will get out of date. Fly more carefully next
time!
<!--l. 276--><p class="noindent" ><span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>works as follows:
<!--l. 277--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29600015.1.5"></a><span 
class="cmbx-10">Description</span></span>
The <span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>script is used to stop some or all of a simulated cluster.
<!--l. 280--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29700015.1.5"></a><span 
class="cmbx-10">Usage:</span></span>
<span 
class="cmti-10">stop</span><span 
class="cmti-10">_sim </span>[options]
<!--l. 283--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-29800015.1.5"></a><span 
class="cmbx-10">Options:</span></span>
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-c, &#8211;component [component name]</span> </dt><dd 
class="description">where the name is one of <span 
class="cmti-10">rm, sm, pm, or. ws,</span>. <span 
class="cmti-10">Kill -INT </span>is used to enable
     orderly shutdown unless overridden with -k, -p, or -r as described below.
     </dd><dt class="description">
<span 
class="cmbx-10">-i, &#8211;instance [instance-id]</span> </dt><dd 
class="description">where the instance-id is one of the agent ids in &#8220;sim.pids&#8221;. <span 
class="cmti-10">Kill -INT </span>is used to enable
     orderly shutdown unless overridden with -k, -p, or -r as described below.
     </dd><dt class="description">
<span 
class="cmbx-10">-k, &#8211;kill</span> </dt><dd 
class="description">Use <span 
class="cmti-10">kill -9 </span>to kill the process.
     </dd><dt class="description">
<span 
class="cmbx-10">-p, &#8211;pause</span> </dt><dd 
class="description">Signal the process with <span 
class="cmti-10">SIGSTOP</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">-r, &#8211;resume</span> </dt><dd 
class="description">Signal the process with <span 
class="cmti-10">SIGCONT</span>.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;nothreading</span> </dt><dd 
class="description">If specified, the command does not run in multi-threaded mode even if it is supported on the local
     platform.
     </dd></dl>
<!--l. 299--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">15.2   </span> <a 
 id="x1-29900015.2"></a>Job Simulation</h3>
<!--l. 301--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.1   </span> <a 
 id="x1-30000015.2.1"></a>Overview</h4>
<!--l. 302--><p class="noindent" >&#8220;Real&#8221; jobs are highly memory and CPU intensive. For testing and simulation purposes, the jobs need not use
anywhere close to their declared memory, and need not consume any CPU at all. The FixedSleepAE is a UIMA
analytic that is given a time, in milliseconds, and all it does is sleep for that period of time and then exit.
By running many of these in a simulated cluster it is possible to get all the DUCC administrative processes
to behave as if there is a real load on the system when in fact all the nodes and jobs are taking minimal
resources.
<!--l. 311--><p class="noindent" >The FixedSleepAE is delivered CASs by the FixedSleepCR. This CR reads a standard Java properties file, using the property
&#8220;elapsed&#8221; to derive the set of sleep times. On each call to the CR&#8217;s &#8220;getNext()&#8221; method, the next integer from
&#8220;elapsed&#8221; is fetched, packaged into a CAS, and shipped to ActiveMQ where it is picked up by the next available
FixedSleepAE.
<!--l. 317--><p class="noindent" >The test driver is given a control file with the names of all the jobs to be submitted in the current run, and the elapsed time
to wait between submission of each job. Each job name corresponds to a file that is not an actual DUCC
specification, but rather the description of a DUCC specification. Each description is a simple Java properties
file.
<!--l. 323--><p class="noindent" >To submit a job, the test driver reads the next job description file derive the number of threads, the simulated user, the
desired (simulated) memory for the job, (possibly) the service ID, and the scheduling class for the job. From these it
constructs a DUCC <a 
href="#x1-270003.5">job specification</a> and submits it to DUCC.
<!--l. 329--><p class="noindent" >Scripting is used to read the job meta-descriptors and generate a control file that submits the job set with a large set of
variations. The same scripting reads each meta-descriptor and modifies it according to the specific parameters of the run,
adjust things such as scheduling class, memory size, etc.
<!--l. 334--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.2   </span> <a 
 id="x1-30100015.2.2"></a>Job meta-descriptors</h4>
<!--l. 335--><p class="noindent" >For each simulated job in a run, a meta-descriptor must be constructed. These may be constructed &#8220;by hand&#8221;, or via local
scripting, for example from log analysis. (The packaged meta-descriptors are generated from logs of actual
workloads.)
<!--l. 339--><p class="noindent" >A meta-descriptor must contain the following properties:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">tod</span> </dt><dd 
class="description">This specifies a virtual &#8220;time of day of submission&#8221;, starting from time 0, specified in units of milliseconds, when
     the job is to be submitted. During job generation, this may be used to enforce precise timing of submission of
     the jobs.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">elapsed</span> </dt><dd 
class="description">This is a blank-delimited set of numbers. Each number represents the elapsed time, in milliseconds, for a single
     work item. There must be one time for each work item. These numbers are placed into CASs by the job&#8217;s Job Driver
     and delivered to each Job Process. For example, if this job is to consist of 5 work items of 1, 2, 3, 4 and 5 seconds each,
     specify
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-148">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;elapsed&#x00A0;=&#x00A0;1000&#x00A0;2000&#x00A0;3000&#x00A0;4000&#x00A0;5000</div>
     <!--l. 351--><p class="nopar" >
     </dd><dt class="description">
<span 
class="cmbx-10">threads</span> </dt><dd 
class="description">This is the number of threads per Job Process. It is translated to the <span 
class="cmti-10">process</span><span 
class="cmti-10">_thread</span><span 
class="cmti-10">_count </span>parameter in the job
     specification.
     </dd><dt class="description">
<span 
class="cmbx-10">user</span> </dt><dd 
class="description">This is the name of the user who owns the job. It may be any string at all. If DUCC is started in <span 
class="cmti-10">test </span>mode, this will be
     shown as the owner of the job in the webserver and the logs.
     </dd><dt class="description">
<span 
class="cmbx-10">memory</span> </dt><dd 
class="description">This is the amount of memory to be requested for the job, translating to the job specification&#8217;s
     <span 
class="cmti-10">process</span><span 
class="cmti-10">_memory</span><span 
class="cmti-10">_size </span>parameter.
     </dd><dt class="description">
<span 
class="cmbx-10">class</span> </dt><dd 
class="description">This is the scheduling class for the job.
<span 
class="cmbx-10">machines</span> This is the maximum number of processes to be allocated for the job, corresponding to the <span 
class="cmti-10">process</span><span 
class="cmti-10">_deployments</span><span 
class="cmti-10">_max</span>
     parameter.
     </dd></dl>
<!--l. 368--><p class="noindent" >For example:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-149">
tod&#x00A0;=&#x00A0;0
&#x00A0;<br />elapsed&#x00A0;=&#x00A0;253677&#x00A0;344843&#x00A0;349342&#x00A0;392883&#x00A0;276264&#x00A0;560153&#x00A0;162850&#x00A0;744822&#x00A0;431210&#x00A0;91188&#x00A0;840262&#x00A0;843378
&#x00A0;<br />threads&#x00A0;=&#x00A0;4
&#x00A0;<br />user&#x00A0;=&#x00A0;Rodrigo
&#x00A0;<br />memory&#x00A0;=&#x00A0;20
&#x00A0;<br />class&#x00A0;=&#x00A0;normal
&#x00A0;<br />machines&#x00A0;=&#x00A0;11</div>
<!--l. 377--><p class="nopar" >
<!--l. 379--><p class="noindent" >All the job meta-descriptors for a run must be placed into a single directory.
<!--l. 382--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.3   </span> <a 
 id="x1-30200015.2.3"></a><span 
class="cmti-10">Prepare </span>Descriptors</h4>
<!--l. 384--><p class="noindent" >A <span 
class="cmti-10">prepare descriptor </span>is also a standard Java properties file. This defines where the set of meta descriptors resides, where to
place the modified meta-files, how to assign scheduling classes to the jobs, how to apportion memory sizes, how to apportion
services, how long the total run should last, and how to compress sleep times.
<!--l. 390--><p class="noindent" >All parts of the run are randomized, but the randomization can be made deterministic between runs by specifying a seed to
the random number generator.
<!--l. 393--><p class="noindent" >Properties include
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">random.seed</span> </dt><dd 
class="description">This is the random-number generator seed to be used for creating the run.
     </dd><dt class="description">
<span 
class="cmbx-10">src.dir</span> </dt><dd 
class="description">This is the directory containing the input-set of meta-specification files.
     </dd><dt class="description">
<span 
class="cmbx-10">dest.dir</span> </dt><dd 
class="description">This is the directory that will contain the updated meta-specification files.
     </dd><dt class="description">
<span 
class="cmbx-10">scheduling.classes</span> </dt><dd 
class="description">This is a blank-delimited list of the scheduling classes to be randomly assigned to the jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">scheduling.classes.[name]</span> </dt><dd 
class="description">Here, <span 
class="cmti-10">name </span>is the name of one of the scheduling classes listed above. The value is a
     weight, to be used to affect the distribution of scheduling classes among the jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">job.memory</span> </dt><dd 
class="description">This is a blank-delimited list of memory sizes to be randomly assigned to each job.
     </dd><dt class="description">
<span 
class="cmbx-10">job.memory.[men]</span> </dt><dd 
class="description">] Here, <span 
class="cmti-10">mem </span>is one of the memory sizes specified above. The value is a weight, used to affect
     the distribution of memory sizes among the jobs.
     </dd><dt class="description">
<span 
class="cmbx-10">job.services</span> </dt><dd 
class="description">This is a blank-delimited list of a service id, where the id is one of the services specified in the
     <span 
class="cmti-10">services.boot </span>control file.
     </dd><dt class="description">
<span 
class="cmbx-10">job.services.[id]</span> </dt><dd 
class="description">Here <span 
class="cmti-10">id </span>is one of the ids specified in the job.services line above. The value is a weight, used to
     affect the distribution of services among the jobs.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">submission.spread</span> </dt><dd 
class="description">This is the time, in seconds the set of job submissions is to be spread across. The jobs are
     submitted at random times such that the total time between submitting the first job and the last job is
     approximately this number.
     </dd><dt class="description">
<span 
class="cmbx-10">compression</span> </dt><dd 
class="description">For each sleep time in the job, divide the actual value by this number. This allows testers to use the
     actual elapsed time from real jobs, and compress the total run time so it fits approximately into the submission
     spread.
     <!--l. 426--><p class="noindent" >For example, if a collection of jobs was originally run over 24 hours, but you want to run a simulation with
     approximately the same type of submission that last only 15 minutes, specify a submission spread of 900 (15
     minutes) and a compression of 96.</dd></dl>
<!--l. 432--><p class="noindent" >Here is a sample run configuration file:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-150">
#&#x00A0;control&#x00A0;file&#x00A0;to&#x00A0;create&#x00A0;a&#x00A0;random-like&#x00A0;submission&#x00A0;of&#x00A0;jobs&#x00A0;for&#x00A0;batch&#x00A0;submission
&#x00A0;<br />#&#x00A0;This&#x00A0;represents&#x00A0;jobs&#x00A0;submitted&#x00A0;over&#x00A0;approximately&#x00A0;36&#x00A0;hours&#x00A0;real&#x00A0;time
&#x00A0;<br />#&#x00A0;Compression&#x00A0;of&#x00A0;96&#x00A0;and&#x00A0;spread&#x00A0;920&#x00A0;gives&#x00A0;a&#x00A0;good&#x00A0;15-20&#x00A0;minute&#x00A0;test&#x00A0;on&#x00A0;test&#x00A0;system&#x00A0;with
&#x00A0;<br />#&#x00A0;136&#x00A0;15GB&#x00A0;shares
&#x00A0;<br />
&#x00A0;<br />random.seed&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;a&#x00A0;number,&#x00A0;for&#x00A0;determinate&#x00A0;randoms
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;or&#x00A0;TOD,&#x00A0;and&#x00A0;the&#x00A0;seed&#x00A0;will&#x00A0;use
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;current&#x00A0;time&#x00A0;of&#x00A0;day
&#x00A0;<br />
&#x00A0;<br />src.dir&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;jobs.in&#x00A0;&#x00A0;&#x00A0;#&#x00A0;where&#x00A0;the&#x00A0;jobs&#x00A0;are
&#x00A0;<br />dest.dir&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;jobs&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;where&#x00A0;to&#x00A0;put&#x00A0;prepared&#x00A0;jobs
&#x00A0;<br />
&#x00A0;<br />scheduling.classes&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;classes
&#x00A0;<br />scheduling.classes.normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;100
&#x00A0;<br />
&#x00A0;<br />job.memory&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;28&#x00A0;37&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;memorys&#x00A0;to&#x00A0;assign
&#x00A0;<br />job.memory.28&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;50
&#x00A0;<br />job.memory.37&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;50
&#x00A0;<br />
&#x00A0;<br />job.services&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;0&#x00A0;1&#x00A0;2&#x00A0;3&#x00A0;4&#x00A0;5&#x00A0;6&#x00A0;7
&#x00A0;<br />job.services.0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.5&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.6&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />job.services.7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;25
&#x00A0;<br />
&#x00A0;<br />submission.spread&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;920&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;number&#x00A0;of&#x00A0;*seconds*&#x00A0;to&#x00A0;try&#x00A0;to&#x00A0;spread&#x00A0;submission&#x00A0;over
&#x00A0;<br />
&#x00A0;<br />compression&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;=&#x00A0;96&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;#&#x00A0;comporession&#x00A0;for&#x00A0;timings</div>
<!--l. 466--><p class="nopar" >
<!--l. 468--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.4   </span> <a 
 id="x1-30300015.2.4"></a>Services</h4>
<!--l. 470--><p class="noindent" >It is possible to run the FixedSleepAE as a UIMA-AS service, with each job specifying a dependency on the service, and the
indicated service doing the actual sleeping on behalf of the job.
<!--l. 474--><p class="noindent" >These variants on services are supported:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Registered services, started by reference,
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Registered services, started by the simulator,</dd></dl>
<!--l. 480--><p class="noindent" >To use these simulated services, configure a &#8220;service boot&#8221; file and reference the services from the job generation config
file.
                                                                                                
                                                                                                
<!--l. 483--><p class="noindent" >Properties required in the service boot file include:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">register</span> </dt><dd 
class="description">This specifies registered services. The value is a blank delimited list of pseudo IDs for the registered services.
     </dd><dt class="description">
<span 
class="cmbx-10">start</span> </dt><dd 
class="description">This specifies which of the registered services to automatically start. The value is some subset of the pseudo
     IDS specified under <span 
class="cmti-10">register</span>
     </dd><dt class="description">
<span 
class="cmbx-10">instances</span><span 
class="cmbx-10">_[id]</span> </dt><dd 
class="description">Here <span 
class="cmti-10">id </span>is one of the IDs specified for <span 
class="cmti-10">submit, register, </span>or <span 
class="cmti-10">standalone</span>. The value is the number of
     instances of that specific service to set up.</dd></dl>
<!--l. 494--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-30400015.2.4"></a><span 
class="cmbx-10">Service pseudo IDs</span></span>
DUCC is packaged with 10 pre-configured services that use the FixedSleepAE. All of these services behave identically, the
only difference is their endpoints, which allows the simulated runs to activate and use multiple independent services. Because
the endpoints are in the various UIMA XML service descriptors, it is necessary to use exactly these IDs when
generating a test run. Thus, the only valid pseudo-ids for service configuration are <span 
class="cmti-10">0, 1, 2, 3, 4, 5, 6, 7, 8,</span>
<span 
class="cmti-10">9</span>.
<!--l. 502--><p class="noindent" >These <span 
class="cmti-10">service ids </span>are used on the job configuration file to establish a weighted distribution of service use among the
jobs.
<!--l. 505--><p class="noindent" >Here is a sample service configuration file:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-151">
#&#x00A0;register&#x00A0;these&#x00A0;services,&#x00A0;2&#x00A0;instances&#x00A0;each
&#x00A0;<br />register&#x00A0;0&#x00A0;1&#x00A0;2&#x00A0;3
&#x00A0;<br />instances_0&#x00A0;2
&#x00A0;<br />instances_1&#x00A0;2
&#x00A0;<br />instances_2&#x00A0;2
&#x00A0;<br />instances_3&#x00A0;2
&#x00A0;<br />
&#x00A0;<br />#&#x00A0;start&#x00A0;these&#x00A0;registered&#x00A0;services
&#x00A0;<br />start&#x00A0;2&#x00A0;3</div>
<!--l. 516--><p class="nopar" >
<!--l. 518--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.5   </span> <a 
 id="x1-30500015.2.5"></a>Generating a Job Set</h4>
<!--l. 520--><p class="noindent" >The <span 
class="cmti-10">prepare </span>script, found in $DUCC_HOME/examples/systemtest is used to generate a test run from the control files
described above. To use it, execute
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-152">
prepare&#x00A0;[config-file]</div>
<!--l. 525--><p class="nopar" > where <span 
class="cmti-10">config file </span>is the <a 
href="#x1-30200015.2.3">run description</a> file described above.
<!--l. 529--><p class="noindent" >This script reads the meta-specification in the <span 
class="cmti-10">jobs.in </span>directive of the config-file, generates a set of meta-specification files into
the <span 
class="cmti-10">jobs.out </span>directory, and creates a control file, <span 
class="cmti-10">job.ctl</span>. The <span 
class="cmti-10">job.ctl </span>file is used by the simulation driver to submit all the
jobs.
<!--l. 535--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">15.2.6   </span> <a 
 id="x1-30600015.2.6"></a>Running the Test Driver</h4>
<!--l. 536--><p class="noindent" >A test run is driven from the script <span 
class="cmti-10">runducc </span>which resides in the directory <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/examples/systemtest</span>. This script
supports a large number of options intended to inject errors and otherwise perturb a run.
<!--l. 541--><p class="noindent" >To use the test driver, first create a job collection as described above. This will generate a file called <span 
class="cmti-10">job.ctl </span>in the test
directory containing the <span 
class="cmti-10">prepare </span>file.
<!--l. 545--><p class="noindent" >Then execute:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-153">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;runducc&#x00A0;-d&#x00A0;jobdir&#x00A0;-b&#x00A0;batchfile&#x00A0;options...</div>
<!--l. 548--><p class="nopar" > where the various parameters and options include:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">-d jobdir</span> </dt><dd 
class="description">The jobdir is the directory containing the <span 
class="cmti-10">prepare </span>file and the <span 
class="cmti-10">job.ctl </span>file as describe in the previous
     section.
     </dd><dt class="description">
<span 
class="cmbx-10">-b batchfile</span> </dt><dd 
class="description">The batchfile is usually <span 
class="cmti-10">job.ctl </span>as generated by the prepare script. (This file may be hand-edited to
     create custom runs outside of the <span 
class="cmti-10">prepare </span>script.)
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;AE</span> </dt><dd 
class="description">This specifies to run all jobs as CR and AE. This is the default and need not be specified.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;DD</span> </dt><dd 
class="description">This specifies to run all jobs as CR and DD. The jobs are generated as DD-style jobs, as opposed to AE.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;SE cfg</span> </dt><dd 
class="description">This specifies to run all jobs using services, as generated by the <span 
class="cmti-10">prepare </span>script. The parameter is the <a 
href="#x1-30300015.2.4">service
     config file</a> as described above. When specified, the driver starts the services as configured, pauses a bit to let
     them start up, and generated every job with a dependency on one of the services.
     </dd><dt class="description">
<span 
class="cmbx-10">-i time-in-sec</span> </dt><dd 
class="description">If specified, this forces each AE to spend a minimum of the indicated time in it&#8217;s initialization method
     (also a sleep). If not specified, the default is 10 seconds. The actual time is controlled by the <span 
class="cmti-10">-r </span>(range) option.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;init</span><span 
class="cmbx-10">_fail</span><span 
class="cmbx-10">_cap count</span> </dt><dd 
class="description">This sets the job property <span 
class="cmti-10">process</span><span 
class="cmti-10">_initialization</span><span 
class="cmti-10">_failures</span><span 
class="cmti-10">_cap </span>to the the indicated value, to
     control the number of initialization failures to be tolerated before terminating the job.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;int</span><span 
class="cmbx-10">_timeout seconds</span> </dt><dd 
class="description">This sets the job property <span 
class="cmti-10">process</span><span 
class="cmti-10">_initialization</span><span 
class="cmti-10">_time</span><span 
class="cmti-10">_max </span>to the indicated value, to control
     the time allowed in initialization before failure is reported.
     </dd><dt class="description">
<span 
class="cmbx-10">-r time-in-sec</span> </dt><dd 
class="description">This specifies the top range for initialization. The service will spend the time specified in <span 
class="cmti-10">-i</span>, PLUS
     a random value from 1 to the time specified in <span 
class="cmti-10">-r </span>in its initialization phase.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;IB</span> </dt><dd 
class="description">The Job Process will leak memory in it&#8217;s initialization phase until it is killed, hopefully by DUCC, but possibly
     by the operating system. <span 
class="cmti-10">Use with care.</span>.
     </dd><dt class="description">
<span 
class="cmbx-10">&#8211;PB</span> </dt><dd 
class="description">The job Process will leak memory in it&#8217;s processing phase until it is killed, hopefully by DUCC, but possibly
     by the operation system. <span 
class="cmti-10">Use with care.</span>
     </dd><dt class="description">
<span 
class="cmbx-10">-m size-in-gb</span> </dt><dd 
class="description">Memory override. Use this value for all jobs, overriding the value in the generated meta-specification
     file.
     </dd><dt class="description">
<span 
class="cmbx-10">-n max-Number-of-processes</span> </dt><dd 
class="description">Max machine override. If specified, this overrides the configured process max from
     the job control file. Specify the max as 0 and no maximum will be submitted with the job, causing the scheduler
     to try to allocated the largest possible number of processes to the job.
     </dd><dt class="description">
<span 
class="cmbx-10">-p time-in-seconds</span> </dt><dd 
class="description">If specified the job property <span 
class="cmti-10">process</span><span 
class="cmti-10">_per</span><span 
class="cmti-10">_item</span><span 
class="cmti-10">_time</span><span 
class="cmti-10">_max</span>, which sets a timeout on work items,
     is set to the indicated time.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">-w, &#8211;watch</span> </dt><dd 
class="description">Submit every job with the <span 
class="cmti-10">wait</span><span 
class="cmti-10">_for</span><span 
class="cmti-10">_completion </span>flag. This runs the driver in multi-threaded mode, with
     each thread monitoring the progress of a job.
     </dd><dt class="description">
<span 
class="cmbx-10">-x rate</span> </dt><dd 
class="description">This specifies an expected error rate for execution phase in a job process, from 0-100 (a percentage). When
     specified, each job process uses a random number generator to determine the probability that is would crash,
     if if that probability is within the specified rate, it generates a random exception.
     </dd><dt class="description">
<span 
class="cmbx-10">-y rate</span> </dt><dd 
class="description">This specifies an expected error rate for initialization phase in a job process, from 0-100 (a percentage).
     When specified, each job process uses a random number generator to determine the probability that is would
     crash, if if that probability is within the specified rate, it generates a random exception.</dd></dl>
<!--l. 599--><p class="noindent" >For an expected error-free run, only the -b and -d options are needed.
<!--l. 602--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">15.3   </span> <a 
 id="x1-30700015.3"></a>Pre-Packaged Tests</h3>
<!--l. 603--><p class="noindent" >Three test suites are provided using the mechanisms described in the previous section:
     <ul class="itemize1">
     <li class="itemize">A 15-minute run comprising approximately 30 jobs. This includes configuration for single-class submission,
     mixed class submission, and one configured to maximize resource fragmentation.
     </li>
     <li class="itemize">A 30-minute run comprising approximately 33 jobs. This includes a single configuration.
     </li>
     <li class="itemize">a 24-hour run comprising approximately 260 jobs. This also includes configurations for single-class submission,
     mixed  classes,  and  fragmentation.  <span 
class="cmti-10">Note: this run has been reconfigured to run in 12 hours, and has been</span>
     <span 
class="cmti-10">successfully been configured to complete in 6 hours. This can create a significant load on the DUCC processes.</span></li></ul>
<!--l. 616--><p class="noindent" >The configurations are found in the $DUCC_HOME/examples/systemtest directory and are in sub directories
called,
     <ul class="itemize1">
     <li class="itemize">mega-15-min
     </li>
     <li class="itemize">mega-30-min
     </li>
     <li class="itemize">mega-24-hour</li></ul>
<!--l. 624--><p class="noindent" >To run these tests:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Create a node configuration. A sample configuration to generate 52 simulated nodes, and which assumes the
     physical machines for the simulation are called <span 
class="cmti-10">sys290, sys291, sys292, sys293 </span>and <span 
class="cmti-10">sys534 </span>is supplied in
     $DUCC_HOME/examples/systemtest. Change the node names to the names of real machines, making any other
     adjustments needed.
  2. Update your <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/ducc.nodes </span>so that all the real node names specified int the simulated node file
     are included.
  3. Update your <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/ducc.properties </span>so the <span 
class="cmti-10">ducc.head </span>is specified as the <span 
class="cmti-10">real, physical </span>machine where
     you will start the simulated cluster.
                                                                                                
                                                                                                
  4. Be sure the <span 
class="cmti-10">job driver </span>nodepool, if configured in <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/ducc.classes</span>, specifies the name of
     one of the simulated nodes. When first running these tests it is usually best that the job driver NOT
     be configured on a specific node in <span 
class="cmti-10">ducc.classes </span>as it can be confusing to get this right on simulated
     clusters.
     <!--l. 647--><p class="noindent" >Specifically, in <span 
class="cmti-10">ducc.classes</span>, configure the <span 
class="cmti-10">JobDriver </span>class thus:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-154">
     &#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Class&#x00A0;JobDriver&#x00A0;fixed-base&#x00A0;{&#x00A0;}</div>
     <!--l. 651--><p class="nopar" > This allows DUCC to schedule the job driver on any node in the simulated cluster.
  5. Generate the job set. For example, to generate the job set for the 15-minute run,
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-155">
     &#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$DUCC_HOME/examples/systemtest
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;./prepare&#x00A0;mega-15-min/jobs.prepare</div>
     <!--l. 660--><p class="nopar" >
  6. Start the simulated cluster (Assuming your simulated node file is called <span 
class="cmti-10">52.simulated.nodes</span>:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-156">
     &#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$DUCC_HOME/examples/systemtest
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;./start_sim&#x00A0;-c&#x00A0;all&#x00A0;-n&#x00A0;52.simulated.nodes</div>
     <!--l. 666--><p class="nopar" >
  7. Use the webserver (or for advanced users, log files), to ensure everything came up and the job driver node has been
     assigned.
  8. Start the run:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-157">
     &#x00A0;&#x00A0;&#x00A0;cd&#x00A0;$DUCC_HOME/examples/systemtest
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;./runducc&#x00A0;-d&#x00A0;mega-15-min&#x00A0;-b&#x00A0;job.ctl</div>
     <!--l. 673--><p class="nopar" >
<!--l. 22--><p class="noindent" ><a name='DUCC\protect \unhbox \voidb@x {\unhbox \voidb@x \special {t4ht@95}x}WEB'></a>
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;16</span><br /><a 
 id="x1-30800016"></a>DUCC Web Server Customization</h2>
<!--l. 26--><p class="noindent" >This chapter describes how to take advantage of DUCC Web Server plug-in capabilities in order to add local
modifications.
<!--l. 29--><p class="noindent" >Prerequisites:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Apache UIMA-DUCC source code
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Ability to install DUCC (e.g. administrator)</dd></dl>
<!--l. 36--><p class="noindent" >Why would you want to do this? Perhaps you have some related information that your DUCC Web Server could display to
the user community. There are considerations for both the server and client sides.
<!--l. 40--><p class="noindent" >The following discussion is related to the downloaded DUCC source code, specifically the project <span 
class="cmti-10">uima-ducc-web</span>.
<h3 class="sectionHead"><span class="titlemark">16.1   </span> <a 
 id="x1-30900016.1"></a>Server Side</h3>
<!--l. 45--><p class="noindent" >In package <span 
class="cmti-10">org.apache.uima.ducc.ws </span>you will find <span 
class="cmti-10">DuccPlugins.java </span>which you can modify or extend.
<!--l. 48--><p class="noindent" >During Web Server boot time, there are hooks to:
<!--l. 51--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">process each Job, Reservation, and Service restored from history
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">add additional <span 
class="cmti-10">http </span>request handlers</dd></dl>
<!--l. 55--><p class="noindent" >During Web Server run time, there are hooks to:
<!--l. 58--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">process each Orchestrator publication</dd></dl>
<!--l. 61--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">16.2   </span> <a 
 id="x1-31000016.2"></a>Client Side</h3>
<!--l. 63--><p class="noindent" >In folder <span 
class="cmti-10">/src/main/webapp/root/js/ </span>you will find <span 
class="cmti-10">ducc.local.js </span>which you can modify.
<!--l. 66--><p class="noindent" >During browser page load, there are hooks to:
<!--l. 69--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">perform additional initialization based on page type</dd></dl>
<!--l. 72--><p class="noindent" >During browser page update, there are hooks to:
<!--l. 75--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">perform additional update based on page type</dd></dl>
                                                                                                
                                                                                                
<!--l. 78--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">16.3   </span> <a 
 id="x1-31100016.3"></a>Build and Install</h3>
<!--l. 80--><p class="noindent" >Build a new <span 
class="cmti-10">uima-ducc-web-[version].jar </span>comprising the revised <span 
class="cmti-10">DuccPlugins.class </span>and any additional dependent classes.
Replace the vanilla <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/lib/uima-ducc/uima-ducc-web-[version].jar </span>with the one containing your
modifications.
<!--l. 85--><p class="noindent" >Copy your new ducc.local.js to the installed Web Server&#8217;s <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/webserver/root/js </span>directory.
<!--l. 88--><p class="noindent" >Start (or re-start) your Web Server.
<!--l. 90--><p class="noindent" >You may have to flush you browser&#8217;s cache to pick up the new <span 
class="cmti-10">ducc.local.js</span>.
                                                                                                
                                                                                                
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;17</span><br /><a 
 id="x1-31200017"></a>Understanding the DUCC logs</h2>
<h3 class="sectionHead"><span class="titlemark">17.1   </span> <a 
 id="x1-31300017.1"></a>Overview</h3>
<!--l. 22--><p class="noindent" >This chapter provides an overview of the DUCC process logs and how to interpret the entries therein.
<!--l. 25--><p class="noindent" >Each of the DUCC &#8220;head node&#8221; processes writes a detailed log of its operation to the directory $DUCC_HOME/logs. The
logs are managed by Apache log4j. All logs are managed by a single log4j configuration file
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-158">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;$DUCC_HOME/resources/log4j.xml</div>
<!--l. 30--><p class="nopar" >
<!--l. 32--><p class="noindent" >The DUCC logger is configured to check for updates to the log4j.xml configuration file and automatically
update without the need to restart any of the DUCC processes. The update may take up to 60 seconds to take
effect.
<!--l. 36--><p class="noindent" >The DUCC logger is loaded and configured through the log4j API such that other log4j configuration files that might be in
the classpath are ignored. This also means that log4j configuration files in the user&#8217;s classpath will not interfere with DUCC&#8217;s
logger.
<!--l. 41--><p class="noindent" >The logs are set to roll after reaching a given size and the number of generations is limited to prevent overrunning disk space.
In general the log level is set to provide sufficient diagnostic output to resolve most issues.
<!--l. 45--><p class="noindent" >Each DUCC component writes its own log as defined in the following table:
<div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-1"  
class="td11">Component        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-2"  
class="td11">Log Name              </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-1"  
class="td11">Resource Manager</td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-2"  
class="td11">rm.log                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-1"  
class="td11">Service Manager  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-2"  
class="td11">sm.log                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-1"  
class="td11">Orchestrator        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-2"  
class="td11">or.log                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-1"  
class="td11">Process Manager  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-2"  
class="td11">pm.log                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-1"  
class="td11">Web Server         </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-2"  
class="td11">ws.log                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-1"  
class="td11">Agent                </td><td  style="white-space:nowrap; text-align:left;" id="TBL-3-7-2"  
class="td11"><span 
class="cmti-10">[hostname].agent.log </span></td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-8-1"  
class="td11">               </td>
</tr></table></div>
<!--l. 66--><p class="noindent" >Because there may be many agents, the agent log is prefixed with the name of the host for each running
agent.
<!--l. 69--><p class="noindent" >The log4j file may be customized for each installation to change the format or content of the log files, according to the rules
defined by log4j itself.
<!--l. 72--><p class="noindent" >The general format of a log message is as follows:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-159">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;Timestamp&#x00A0;&#x00A0;&#x00A0;LOGLEVEL&#x00A0;&#x00A0;COMPONENT.sourceFileName&#x00A0;method-name&#x00A0;J[Jobid-or-NA]&#x00A0;T[TID]&#x00A0;text</div>
<!--l. 75--><p class="nopar" > where
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Timestamp</span> </dt><dd 
class="description">is the time of the occurrence. By default, the timestamp uses millisecond granularity.
     </dd><dt class="description">
<span 
class="cmbx-10">LOGLEVEL</span> </dt><dd 
class="description">This is one of the log4j debug levels, INFO, ERROR, DEBUG, etc.
     </dd><dt class="description">
<span 
class="cmbx-10">COMPONENT</span> </dt><dd 
class="description">This identifies the DUCC component emitting the message. The components include
         <dl class="description"><dt class="description">
     <span 
class="cmbx-10">SM</span> </dt><dd 
class="description">Service Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">RM</span> </dt><dd 
class="description">Resource Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">PM</span> </dt><dd 
class="description">Process Manager
         </dd><dt class="description">
     <span 
class="cmbx-10">OR</span> </dt><dd 
class="description">Orchestrator
         </dd><dt class="description">
     <span 
class="cmbx-10">WS</span> </dt><dd 
class="description">Web Server
         </dd><dt class="description">
     <span 
class="cmbx-10">Agent</span> </dt><dd 
class="description">Agent
         </dd><dt class="description">
     <span 
class="cmbx-10">JD</span> </dt><dd 
class="description">Job Driver. These logs are written to the log directory specified in each job submission.
         </dd><dt class="description">
     <span 
class="cmbx-10">JobProcessComponent</span> </dt><dd 
class="description">Job process, also known as JP. These logs are written to the log directory specifid
         in each job submission.</dd></dl>
     </dd><dt class="description">
<span 
class="cmbx-10">sourceFileName</span> </dt><dd 
class="description">This is the name of the Java source file from which the message is emitted.
     </dd><dt class="description">
<span 
class="cmbx-10">method-name</span> </dt><dd 
class="description">This is the name of the method in <span 
class="cmti-10">sourceFileName </span>which emitted the message.
     </dd><dt class="description">
<span 
class="cmbx-10">J[Workid-or-NA]</span> </dt><dd 
class="description">This is the DUCC assigned id of the work being processed, when relevant. If the message is not
     associated with work, this field shows &#8220;N/A&#8221;. Some logs (such as JP and JD logs) pertain ONLY to a specific job and
     do not contain this field.
     </dd><dt class="description">
<span 
class="cmbx-10">T[TID]</span> </dt><dd 
class="description">This is the ID of the thread emitting the message. Some logs (such as RM) do not use this field so it is
     omitted.
     </dd><dt class="description">
<span 
class="cmbx-10">text</span> </dt><dd 
class="description">This is the component-specific text content of the message. Key messages are described in detail in subsequent
     sections.
     </dd></dl>
                                                                                                
                                                                                                
<!--l. 105--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">17.2   </span> <a 
 id="x1-31400017.2"></a>Resource Manager Log (rm.log)</h3>
<!--l. 107--><p class="noindent" >The RM log is designed to show all phases of resource scheduling. Much of the flow of a job can be observed in this log alone.
The following specific information is available and is explained in more detail below:
     <ul class="itemize1">
     <li class="itemize">Bootstrap configuration
     </li>
     <li class="itemize">Node arrival and missed heartbeats
     </li>
     <li class="itemize">Node occupancy
     </li>
     <li class="itemize">Job arrival and status updates
     </li>
     <li class="itemize">Calculation of job caps
     </li>
     <li class="itemize">How-much - fair share
     </li>
     <li class="itemize">What-of - host assignment and preemption
     </li>
     <li class="itemize">Defragmentation
     </li>
     <li class="itemize">Internal schedule
     </li>
     <li class="itemize">Published schedule</li></ul>
<!--l. 123--><p class="noindent" >Most useful messages are emitted under log level INFO but a wealth of details can be seen by incresing the log level to
DEBUG or TRACE. To do so, edit the file <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/log4j.xml </span>and change the <span 
class="cmti-10">priority </span>value to <span 
class="cmti-10">debug </span>(or
<span 
class="cmti-10">trace</span>) in the stanza similar to that shown here. Within about a minute the logger will pick up the change and increase its log
level.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-160">
&#x00A0;&#x00A0;&#x00A0;&#x003C;category&#x00A0;name="org.apache.uima.ducc.sm"&#x00A0;additivity="true"&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;priority&#x00A0;value="debug"/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;appender-ref&#x00A0;ref="smlog"&#x00A0;/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x003C;/category&#x003E;</div>
<!--l. 135--><p class="nopar" >
<!--l. 137--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.1   </span> <a 
 id="x1-31500017.2.1"></a>Bootstrap Configuration</h4>
<!--l. 138--><p class="noindent" >The RM summarizes its entire configuration when it starts up and prints it to the log to provide context for subsequent data
and as verification that the RM is configured in the way it was thought to be. All the following are found in the bootstrap
section and are mostly self-explanatory:
     <ul class="itemize1">
     <li class="itemize">A pretty-print of the class configuration. This is the same as produced by the <span 
class="cmti-10">check</span><span 
class="cmti-10">_ducc -c -v </span>command.
     </li>
     <li class="itemize">A summary of all classes, one per line. This is a more concise display and is similar to the DUCC Classes page
     in the web server.
     </li>
     <li class="itemize">A listing of all RM configuration parameters and the environment including things such as the version of Java,
     the operating system, etc.
     </li>
     <li class="itemize">Nodepool occupancy. As host names are parsed from the <span 
class="cmti-10">ducc.nodes </span>files, the RM log shows exactly which
     nodepool each node is added to.</li></ul>
<!--l. 154--><p class="noindent" >The RM logs can wrap quickly under high load in which case this information is lost.
<!--l. 156--><p class="noindent" >The following represent key RM logs lines to search for if it is desired to examine or verify its initialization. (Part of the
leaders on these messages are removed here to shorten the lines for publication.)
<!--l. 160--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-31600017.2.1"></a><span 
class="cmbx-10">Initial RM start</span></span>
The first logged line of any RM start will contain the string <span 
class="cmti-10">Starting component: resourceManager</span>:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-161">
RM.ResourceManagerComponent-&#x00A0;N/A&#x00A0;boot&#x00A0;&#x00A0;...&#x00A0;Starting&#x00A0;Component:&#x00A0;&#x00A0;resourceManager</div>
<!--l. 164--><p class="nopar" >
<!--l. 166--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-31700017.2.1"></a><span 
class="cmbx-10">RM Node and Class Configuration</span></span>
The first configuration lines show the reading and validation of the node and class configuration. Look for the string
<span 
class="cmti-10">printNodepool </span>to find these lines:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-162">
RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;Nodepool&#x00A0;--default--
&#x00A0;<br />RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Search&#x00A0;Order:&#x00A0;100
&#x00A0;<br />RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Node&#x00A0;File:&#x00A0;None
&#x00A0;<br />RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;None&#x003E;
&#x00A0;<br />RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Classes:&#x00A0;background&#x00A0;low&#x00A0;normal&#x00A0;high&#x00A0;normal-all&#x00A0;nightly-test&#x00A0;reserve
&#x00A0;<br />RM.Config-&#x00A0;N/A&#x00A0;printNodepool&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Subpools:&#x00A0;jobdriver&#x00A0;power&#x00A0;intel
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...</div>
<!--l. 177--><p class="nopar" >
<!--l. 179--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-31800017.2.1"></a><span 
class="cmbx-10">RM Scheduling Configuration</span></span>
Next the RM reads configures its scheduling parameters and emits the information. It also emits information about its
environment: the ActiveMQ broker, JVM information, OS information, DUCC version, etc. To fine this search for the string
<span 
class="cmti-10">init Scheduler</span>.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-163">
&#x00A0;init&#x00A0;&#x00A0;Scheduler&#x00A0;running&#x00A0;with&#x00A0;share&#x00A0;quantum&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;15&#x00A0;&#x00A0;GB
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;reserved&#x00A0;DRAM&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;0&#x00A0;&#x00A0;GB
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DRAM&#x00A0;override&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;0&#x00A0;&#x00A0;GB
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;scheduler&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;org.apache.uima.ducc.rm.scheduler.NodepoolScheduler
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...&#x00A0;(more&#x00A0;lines)&#x00A0;...
&#x00A0;<br />
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC&#x00A0;home&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/home/challngr/ducc_runtime
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ActiveMQ&#x00A0;URL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;tcp://bluej537:61617?jms.useCompression=true
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JVM&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;Oracle&#x00A0;Corporation&#x00A0;1.7.0_45
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JAVA_HOME&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/users1/challngr/jdk1.7.0_45/jre
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JVM&#x00A0;Path&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/users/challngr/jdk1.7.0_45/bin/java
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JMX&#x00A0;URL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;service:jmx:rmi:///jndi/rmi://bluej537:2099/jmxrmi
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OS&#x00A0;Architecture&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;amd64
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OS&#x00A0;Name&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;Linux
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC&#x00A0;Version&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;2.0.0-beta
&#x00A0;<br />&#x00A0;init&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;RM&#x00A0;Version&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;2.0.0</div>
<!--l. 200--><p class="nopar" >
<!--l. 202--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-31900017.2.1"></a><span 
class="cmbx-10">RM Begins to Schedule</span></span>
The next lines will show the nodes checking in and which nodepools they are assigned to. When the scheduler is ready to
accept Orchestrator requests you will see assignment of the JobDriver reservation. At this point RM is fully operational. The
confirmation of JobDriver assignment is similar to this:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-164">
Reserved:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ID&#x00A0;&#x00A0;&#x00A0;&#x00A0;JobName&#x00A0;&#x00A0;&#x00A0;&#x00A0;User&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Class&#x00A0;Shares&#x00A0;Order&#x00A0;QShares&#x00A0;NTh&#x00A0;Memory&#x00A0;nQuest&#x00A0;Ques&#x00A0;Rem&#x00A0;InitWait&#x00A0;Max&#x00A0;P/Nst
&#x00A0;<br />R______7434&#x00A0;Job_Drive&#x00A0;&#x00A0;&#x00A0;System&#x00A0;&#x00A0;JobDriver&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1</div>
<!--l. 210--><p class="nopar" >
<!--l. 212--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.2   </span> <a 
 id="x1-32000017.2.2"></a>Node Arrival and Missed Heartbeats</h4>
<!--l. 213--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-32100017.2.2"></a>Node Arrival</h5>
<!--l. 214--><p class="noindent" >As each node &#8220;checks in&#8221; with the RM a line is printed with details about the node. Some fields are redundant but are
produced by different components processing the node arrival and thus serve as confirmation that all parts are operating
correctly.
<!--l. 218--><p class="noindent" >A node arrival entry is of the form:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-165">
LOGHEADER&#x00A0;Nodepool:&#x00A0;power&#x00A0;Host&#x00A0;added:&#x00A0;power&#x00A0;:&#x00A0;&#x00A0;bluej290-18&#x00A0;&#x00A0;&#x00A0;shares&#x00A0;&#x00A0;3&#x00A0;total&#x00A0;&#x00A0;&#x00A0;&#x00A0;9:&#x00A0;&#x00A0;&#x00A0;48128&#x00A0;&#x003C;none&#x003E;</div>
<!--l. 221--><p class="nopar" > where the fields mean (if the field isn&#8217;t described here, the value is not relevant to node arrival):
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">LOGHEADER</span> </dt><dd 
class="description">is the log entry header as described above.
     </dd><dt class="description">
<span 
class="cmbx-10">Nodepool:power</span> </dt><dd 
class="description">The node is added to the &#8220;power&#8221; nodepool
     </dd><dt class="description">
<span 
class="cmbx-10">bluej290-18</span> </dt><dd 
class="description">This is the name of the node
     </dd><dt class="description">
<span 
class="cmbx-10">shares 3</span> </dt><dd 
class="description">The number of full shares supported on this machine.
     </dd><dt class="description">
<span 
class="cmbx-10">total 9</span> </dt><dd 
class="description">This is the total shares in the system after this node arrives.
     </dd><dt class="description">
<span 
class="cmbx-10">48128</span> </dt><dd 
class="description">This is the memory, in KB, on that host.</dd></dl>
<!--l. 232--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x1-32200017.2.2"></a>Missed Heartbeats</h5>
<!--l. 233--><p class="noindent" >The DUCC Agents send out regular &#8220;heartbeat&#8221; messages with current node statistics. These messages are used by RM to
determine if a node has failed. If a heartbeat does not arrive at the specified time this is noted in the log as a <span 
class="cmti-10">missing</span>
<span 
class="cmti-10">heartbeat</span>. If a specific (configurable) number of consecutive heartbeats is missed, the RM marks the node offline and instructs
the DUCC Orchestrator to purge the shares so they can be rescheduled.
<!--l. 239--><p class="noindent" >A missed heartbeat log entry is of the form
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-166">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;[LOGHEADER]&#x00A0;"***&#x00A0;Missed&#x00A0;heartbeat&#x00A0;***"&#x00A0;NODENAME&#x00A0;count[NN]</div>
<!--l. 242--><p class="nopar" > where the fields mean:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">LOGHEADER</span> </dt><dd 
class="description">is the log entry header as described above.
     </dd><dt class="description">
<span 
class="cmbx-10">*** Missed heartbeat ***</span> </dt><dd 
class="description">Indicates this is a missing heartbeat message.
     </dd><dt class="description">
<span 
class="cmbx-10">NODENAME</span> </dt><dd 
class="description">This is the name of the (possibly) errant host.
     </dd><dt class="description">
<span 
class="cmbx-10">count[N</span> </dt><dd 
class="description">] This is the number of CONSECUTIVE missing heartbeats.</dd></dl>
<!--l. 251--><p class="noindent" >Note that it is not unusual to miss the occasional heartbeat or two due to general network or system load. As soon as a
heartbeat is received the count is reset to 0.
<!--l. 254--><p class="noindent" >If the number of missing heartbeats exceeds the value <span 
class="cmti-10">ducc.rm.node.stability </span>configured in <span 
class="cmti-10">ducc.properties </span>the node is marked
offline and this message is emitted:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-167">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;HEADER&#x00A0;"***&#x00A0;!&#x00A0;Notification&#x00A0;of&#x00A0;node&#x00A0;death:"&#x00A0;NODENAME</div>
<!--l. 258--><p class="nopar" >
<!--l. 260--><p class="noindent" >If the node recovers and rejoins, the NodeArrives message as described above is emitted.
<!--l. 262--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.3   </span> <a 
 id="x1-32300017.2.3"></a>Node Occupancy</h4>
<!--l. 263--><p class="noindent" ><span 
class="cmti-10">Node occupancy </span>describes, for each node, the capacity of the node, the work assigned to that node, and the number of open
shares on that node. The RM writes the node occupancy to its log before assignment of every new schedule. The occupancy
can be found under the log header line:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-168">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;[LOGHEADER]&#x00A0;Machine&#x00A0;occupancy&#x00A0;before&#x00A0;schedule</div>
<!--l. 268--><p class="nopar" >
<!--l. 270--><p class="noindent" >NOTE: The current node occupancy can be queried interactively with the <a 
href="#x1-26100012.9.6">rm_occupancy</a> command:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-169">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC_HOME/admin/rm_qoccupancy</div>
<!--l. 274--><p class="nopar" >
<!--l. 276--><p class="noindent" >Sample node occupancy as displayed in the log follows. The header is included in the log.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-170">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Name&#x00A0;Order&#x00A0;Active&#x00A0;Shares&#x00A0;Unused&#x00A0;Shares&#x00A0;Memory&#x00A0;(MB)&#x00A0;Jobs
&#x00A0;<br />---------------&#x00A0;-----&#x00A0;-------------&#x00A0;-------------&#x00A0;-----------&#x00A0;------&#x00A0;...
&#x00A0;<br />&#x00A0;f1n2.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;206710&#x00A0;206715&#x00A0;207878&#x00A0;206719&#x00A0;207900
&#x00A0;<br />&#x00A0;f1n4.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;&#x003C;none&#x003E;[16]
&#x00A0;<br />&#x00A0;f7n2.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;&#x003C;none&#x003E;[16]
&#x00A0;<br />f9n10.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;&#x003C;none&#x003E;[16]
&#x00A0;<br />&#x00A0;f6n1.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;&#x003C;none&#x003E;[16]
&#x00A0;<br />&#x00A0;f7n1.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;13&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;203408&#x00A0;[13]
&#x00A0;<br />&#x00A0;f7n3.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;206716&#x00A0;207904&#x00A0;206720&#x00A0;206717&#x00A0;206718
&#x00A0;<br />f4n10.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;15&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;209155&#x00A0;208975&#x00A0;209153&#x00A0;209155&#x00A0;[1]
&#x00A0;<br />&#x00A0;f7n5.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;208960
&#x00A0;<br />&#x00A0;f1n3.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;205608&#x00A0;206695&#x00A0;207906&#x00A0;206693&#x00A0;206693
&#x00A0;<br />&#x00A0;f1n1.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;13&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;208913&#x00A0;[13]
&#x00A0;<br />f6n10.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;3&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;13&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;208977&#x00A0;[13]
&#x00A0;<br />&#x00A0;f6n7.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;&#x003C;none&#x003E;&#x00A0;[16]
&#x00A0;<br />&#x00A0;f7n6.bluej.net&#x00A0;&#x00A0;&#x00A0;&#x00A0;16&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;15&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;1&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;255459&#x00A0;209155&#x00A0;209151&#x00A0;206701&#x00A0;209155&#x00A0;[1]</div>
<!--l. 294--><p class="nopar" >
<!--l. 296--><p class="noindent" >The meaning of each column is:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Name</span> </dt><dd 
class="description">The host name.
     </dd><dt class="description">
<span 
class="cmbx-10">Order</span> </dt><dd 
class="description">This is the share order of the node. The number represents the number of quantum shares that can be
     scheduled on this node. (Recall that an actual process may and usually does occupy multiple quantum shares.)
     </dd><dt class="description">
<span 
class="cmbx-10">Active Shares</span> </dt><dd 
class="description">This is the number of quantum shares on the node which are scheduled for work.
     </dd><dt class="description">
<span 
class="cmbx-10">Unused Shares</span> </dt><dd 
class="description">This is the number of quantum shares available for new work.
     </dd><dt class="description">
<span 
class="cmbx-10">Memory</span> </dt><dd 
class="description">This is the real memory capacity of the node, as reported by the node&#8217;s Agent process.
     </dd><dt class="description">
<span 
class="cmbx-10">Jobs</span> </dt><dd 
class="description">Each entry here is the DUCC-assigned id of a job with process assigned to this node. Each entry corresponds
     to one process. If an ID appears more than once the job has more than one process assigned to the node; see
     for example, the node <span 
class="cmbx-10">f1n3.bluej.net </span>with multiple entries for job <span 
class="cmti-10">206693</span>.
     <!--l. 312--><p class="noindent" >When no work is assigned to the node, the string <span 
class="cmmi-10">&#x003C;</span><span 
class="cmbx-10">none</span><span 
class="cmmi-10">&#x003E; </span>is displayed.
     <!--l. 314--><p class="noindent" >When there is a number in brackets, e.g. <span 
class="cmbx-10">[13] </span>for node <span 
class="cmbx-10">f7n1.bluej.net</span>, the number represents the number of
     quantum shares available to be scheduled on the node.</dd></dl>
<!--l. 318--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.4   </span> <a 
 id="x1-32400017.2.4"></a>Job Arrival and Status Updates</h4>
                                                                                                
                                                                                                
<!--l. 320--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-32500017.2.4"></a><span 
class="cmbx-10">Orchestrator State Arrival</span></span>
On a regular basis the Orchestrator publishes the full state of work which may require resources. This is the prime input to
the RM&#8217;s scheduler and must arrive on a regular basis. Every arrival of an Orchestrator publication is flagged in the log as
follows. If these aren&#8217;t observed every <a 
href="#x1-21800012.4.5">Orchestrator publish interval</a> something is wrong; most likely the Orchestrator or the
ActiveMQ broker has a problem.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-171">
RM.ResourceManagerComponent-&#x00A0;N/A&#x00A0;onJobManagerStateUpdate&#x00A0;&#x00A0;-------&#x003E;&#x00A0;OR&#x00A0;state&#x00A0;arrives</div>
<!--l. 333--><p class="nopar" >
<!--l. 335--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-32600017.2.4"></a><span 
class="cmbx-10">Job State</span></span>
Immediately after the OR state arrival is logged the state of all work needing scheduling is logged. These are always
tracked by the <span 
class="cmti-10">JobManagerConverter </span>module in the RM and is logged similar to the following. It shows the
state of each bit of work of interest, and if that state has changed since the last publication, what that state
is.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-172">
&#x00A0;&#x00A0;&#x00A0;...
&#x00A0;<br />RM.JobManagerConverter-&#x00A0;7433&#x00A0;eventArrives&#x00A0;&#x00A0;Received&#x00A0;non-schedulable&#x00A0;job,&#x00A0;state&#x00A0;=&#x00A0;&#x00A0;Completed
&#x00A0;<br />RM.JobManagerConverter-&#x00A0;7434&#x00A0;eventArrives&#x00A0;&#x00A0;[SPR]&#x00A0;State:&#x00A0;&#x00A0;WaitingForResources&#x00A0;-&#x003E;&#x00A0;Assigned
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;...</div>
<!--l. 345--><p class="nopar" >
<!--l. 347--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.5   </span> <a 
 id="x1-32700017.2.5"></a>Calculation Of Job Caps</h4>
<!--l. 348--><p class="noindent" >Prior to every schedule, and immediately after receipt of the Orchestrator state, the RM examines every piece of work and
calculates the maximum level of resources the job can physically use at the moment. This handles the <span 
class="cmti-10">expand-by-doubling</span>
function, the <span 
class="cmti-10">prediction </span>function, and accounts for the amount of work left relative to the resources the work already
possesses.
<!--l. 354--><p class="noindent" >The curious or intrepid can see the code that implements this in <span 
class="cmti-10">RmJob.java </span>method <span 
class="cmti-10">initJobCap()</span>.
<!--l. 357--><p class="noindent" >The calculation is done in two steps:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Calculate the projected cap. This uses the prediction logic and amount of work remaining to calculate the
     <span 
class="cmti-10">largest </span>number of resources the job can use, if the system had unlimited resources. This is an upper bound on
     the actual resources assigned to the job.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Adjust the cap down using expand-by-doubling and the initialization state of the work. The result of this step
     is always a <span 
class="cmti-10">smaller or equal </span>number as the projected cap.</dd></dl>
<!--l. 368--><p class="noindent" >The goal of this step is to calculate the largest number of resource the job can actually use at the moment. The
FAIR_SHARE calculations may further revise this down, but will never revise it up.
<!--l. 372--><p class="noindent" >If there is no data yet on the initialization state of work, the rejected cap cannot be calculated and a line such as the
following is emitted:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-173">
RM.RmJob&#x00A0;-&#x00A0;7483&#x00A0;getPrjCap&#x00A0;&#x00A0;Hilaria&#x00A0;Cannot&#x00A0;predict&#x00A0;cap:&#x00A0;init_wait&#x00A0;true&#x00A0;||&#x00A0;time_per_item&#x00A0;0.0</div>
<!--l. 376--><p class="nopar" >
<!--l. 378--><p class="noindent" >If the job has completed initialization the projected cap is calculated based on the average initialization time of all the job
processes and the current rate of work-item completion. A line such as this is emitted:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-174">
RM.RmJob-&#x00A0;7483&#x00A0;Hilaria&#x00A0;O&#x00A0;2&#x00A0;T&#x00A0;58626&#x00A0;NTh&#x00A0;28&#x00A0;TI&#x00A0;18626&#x00A0;TR&#x00A0;12469.0&#x00A0;R&#x00A0;2.2456e-03&#x00A0;QR&#x00A0;1868&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;P&#x00A0;132&#x00A0;F&#x00A0;1736&#x00A0;&#x00A0;ST&#x00A0;1433260775524&#x00A0;return&#x00A0;434</div>
<!--l. 384--><p class="nopar" > In this particular line:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">7483</span> </dt><dd 
class="description">is the job id
     </dd><dt class="description">
<span 
class="cmbx-10">Hilaria</span> </dt><dd 
class="description">is the job&#8217;s owner (userid)
     </dd><dt class="description">
<span 
class="cmbx-10">O 2</span> </dt><dd 
class="description">this says this is an <span 
class="cmti-10">order 2 </span>job: each process will occupy two quantum shares.
     </dd><dt class="description">
<span 
class="cmbx-10">T 58626</span> </dt><dd 
class="description">is the smallest number of milliseconds until a new process for this job can be made runnable, based on
     the average initialization time for processes in this job, the Orchestrator publish rate, and the <a 
href="#x1-21900012.4.6"><span 
class="cmti-10">RM prediction</span>
     <span 
class="cmti-10">fudge.</span></a>
     </dd><dt class="description">
<span 
class="cmbx-10">Nth</span> </dt><dd 
class="description">This is the number of threads currently executing for this job. It is calculated as the (number of currently
     allocated processes) * (the number of threads per process).
     </dd><dt class="description">
<span 
class="cmbx-10">TI</span> </dt><dd 
class="description">This is the average initialization time in milliseconds for processes in this job.
     </dd><dt class="description">
<span 
class="cmbx-10">TR</span> </dt><dd 
class="description">This is the average execution time in milliseconds for work items in this job.
     </dd><dt class="description">
<span 
class="cmbx-10">R</span> </dt><dd 
class="description">This is the current rate at which the job is completing work items, calculated as (Nth / TR).
     </dd><dt class="description">
<span 
class="cmbx-10">QR</span> </dt><dd 
class="description">The is the number of work items (questions) remaining to be executed.
     </dd><dt class="description">
<span 
class="cmbx-10">P</span> </dt><dd 
class="description">This is the projected number of questions that can be completed in the time from &#8220;now&#8221; until a new process can
     be started and initialized (in this case 58626 milliseconds from now, see above), with the currently allocated
     resources, calculated as (T * R).
     </dd><dt class="description">
<span 
class="cmbx-10">F</span> </dt><dd 
class="description">This is the number of questions that will remain unanswered at the end of the target (T) period, calculated as
     (QR - P).
     </dd><dt class="description">
<span 
class="cmbx-10">ST</span> </dt><dd 
class="description">This is the time the job was submitted.
     </dd><dt class="description">
<span 
class="cmbx-10">return</span> </dt><dd 
class="description">This is the projected cap, the largest number of processes this job can physically use, calculated as (F /
     threads-per-process).
     <!--l. 412--><p class="noindent" >If the returned projected cap is 0, it is adjusted up to the number of processes currently allocated.</dd></dl>
<!--l. 416--><p class="noindent" >Once the projected cap is calculated a final check is made to avoid several problems:
     <ul class="itemize1">
     <li class="itemize">Preemption of processes that contain active work but are not using all their threads. This occurs when a job is
     &#8220;winding down&#8221; and may have more processes than it technically needs, but all processes still are performing
     work.
                                                                                                
                                                                                                
     </li>
     <li class="itemize">The job may have declared a maximum number of processes to allocate, which is less than the number it could
     otherwise be awarded.
     </li>
     <li class="itemize">If prediction is being used, revise the estimate down to the smaller of the projected cap and the resources
     currently allocated.
     </li>
     <li class="itemize">If initialization caps are being applied and no process in the job has successfully initialized, revise the estimate
     down to the initialization cap.
     </li>
     <li class="itemize">If expand-by-doubling is being used, potentially revise the estimate down to no more than double the currently
     allocated processes.</li></ul>
<!--l. 431--><p class="noindent" >The final cap is emitted in a line such as:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-175">
RM.RmJob-&#x00A0;7483&#x00A0;initJobCap&#x00A0;Hilaria&#x00A0;O&#x00A0;2&#x00A0;Base&#x00A0;cap:&#x00A0;7&#x00A0;Expected&#x00A0;future&#x00A0;cap:&#x00A0;434&#x00A0;potential&#x00A0;cap&#x00A0;7&#x00A0;actual&#x00A0;cap&#x00A0;7</div>
<!--l. 434--><p class="nopar" > In this line:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">7483</span> </dt><dd 
class="description">is the job id.
     </dd><dt class="description">
<span 
class="cmbx-10">Hilaria</span> </dt><dd 
class="description">is the job&#8217;s user name.
     </dd><dt class="description">
<span 
class="cmbx-10">O 2</span> </dt><dd 
class="description">indicates this job uses two quantum shares per processes.
     </dd><dt class="description">
<span 
class="cmbx-10">Base cap:</span> </dt><dd 
class="description">This is an upper-bound on the number of processes that can be used in a perfect world. It is calculated
     by dividing the number of questions by the number of threads per process. It is then revised down by the
     declared max-processes in the job. In the example above, the job declared max-processes of 7.
     </dd><dt class="description">
<span 
class="cmbx-10">Expected future cap</span> </dt><dd 
class="description">This is the projected cap, described above.
     </dd><dt class="description">
<span 
class="cmbx-10">Potential cap</span> </dt><dd 
class="description">This is the base cap, possibly revised downward by the future cap, if it is projected that fewer
     processes are would be useful.
     </dd><dt class="description">
<span 
class="cmbx-10">Actual cap</span> </dt><dd 
class="description">This is the assigned maximum processes to be scheduled for this job, possibly adjusted based on the
     initialization status of the job and the expand-by-doubling policy.</dd></dl>
<!--l. 455--><p class="noindent" >The <span 
class="cmti-10">actual cap </span>is the one used to calculate the job&#8217;s FAIR_SHARE and is always the the largest number of processes
usable in a perfect world. Note that the FAIR_SHARE calculation may result in further reduction of this
number.
<!--l. 460--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.6   </span> <a 
 id="x1-32800017.2.6"></a>The &#8220;how much&#8221; calculations</h4>
<!--l. 461--><p class="noindent" >The RM log includes a section that details the fair-share calculations. The details of this are rather involved and out-of-scope
for this section. Interested parties are welcome to read the scheduler source, in the file <span 
class="cmti-10">NodePoolScheduler.java</span>, methods
<span 
class="cmti-10">countClassShares, countJobShares, countUserShares</span>, and <span 
class="cmti-10">apportion</span><span 
class="cmti-10">_qshares</span>.
<!--l. 466--><p class="noindent" >The logs reveal the inputs to each of the methods above. The overall logic is as follows and can be followed in the
logs.
     <ul class="itemize1">
     <li class="itemize">All job classes of equal priority are bundled together and handed to the <span 
class="cmti-10">countClassShares </span>method. This method assigns
     some number of shares to each class based on the weighted fair-share logic, using the configured class weights. The start
     of this can be seen under log lines similar to this:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-176">
     INFO&#x00A0;RM.NodepoolScheduler-&#x00A0;N/A&#x00A0;apportion_qshares&#x00A0;&#x00A0;countClassShares&#x00A0;RmCounter&#x00A0;Start</div>
     <!--l. 476--><p class="nopar" >
     </li>
     <li class="itemize">All users for each class are passed to the <span 
class="cmti-10">countUserShares </span>method and then assigned some number of shares from the
     pool of shares assigned to the class, again using the fair-share computations, but with equal weighs. The start of this
     can be seen under log lines similar to this:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-177">
     INFO&#x00A0;RM.NodepoolScheduler-&#x00A0;N/A&#x00A0;apportion_qshares&#x00A0;&#x00A0;countJobShares&#x00A0;RmCounter&#x00A0;Start</div>
     <!--l. 485--><p class="nopar" >
     </li>
     <li class="itemize">All jobs for each user are passed to the <span 
class="cmti-10">countJobShares </span>method and assigned some number of shares from the pool
     assigned to the user, using the fair-share calculator with equal weights. The start of this can be seen under log lines
     similar to this:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-178">
     INFO&#x00A0;RM.NodepoolScheduler-&#x00A0;N/A&#x00A0;apportion_qshares&#x00A0;&#x00A0;countUserShares&#x00A0;RmCounter&#x00A0;Start</div>
     <!--l. 493--><p class="nopar" >
     </li>
     <li class="itemize">The method <span 
class="cmti-10">apportion</span><span 
class="cmti-10">_qshares </span>is the common fair-share calculator, used by the three routines above.</li></ul>
<!--l. 499--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.7   </span> <a 
 id="x1-32900017.2.7"></a>The &#8220;what of&#8221; calculations</h4>
<!--l. 500--><p class="noindent" >These calculations are also too involved to discuss in detail for this section.
<!--l. 502--><p class="noindent" >Interested parties may look in <span 
class="cmti-10">NodePoolScheduler.java</span>, method <span 
class="cmti-10">whatOfFairShare</span>, and <span 
class="cmti-10">NodePool.java </span>method
<span 
class="cmti-10">traverseNodepoolsForExpansion </span>to see details.
<!--l. 506--><p class="noindent" >The logs track the general flow through the methods above and generally contain enough information to diagnose problems
should they arise.
<!--l. 509--><p class="noindent" >The key log message here, other than those sketching logic flow, shows the assignment of specific processes to jobs as seen
below.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-179">
RM.NodePool-&#x00A0;7483&#x00A0;connectShare&#x00A0;&#x00A0;share&#x00A0;bluej290-12.461&#x00A0;order&#x00A0;2&#x00A0;machine&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bluej290-12&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;false&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;0&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;31744&#x00A0;&#x003C;none&#x003E;</div>
<!--l. 515--><p class="nopar" > This shows job <span 
class="cmti-10">7483 </span>being assigned a process on host <span 
class="cmti-10">bluej290-12 </span>as RM share id <span 
class="cmti-10">461</span>, which consists of <span 
class="cmti-10">2 quantum shares</span>
(order 2). Host bluej290-12 is a 32GB machine with <span 
class="cmti-10">31744 </span>KB of usable, schedulable memory.
<!--l. 520--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.8   </span> <a 
 id="x1-33000017.2.8"></a>Defragmentation</h4>
<!--l. 521--><p class="noindent" >The RM considers the system&#8217;s memory pool to be fragmented if the counted resources from the the &#8220;how much&#8221; phase of
scheduling cannot be fully mapped to real physical resources in the &#8220;what of&#8221; phase. In short, the &#8220;how much&#8221; phase
assumes an ideal, unfragmented virtual cluster. The &#8220;what of&#8221; phase may be unable to make the necessary
physical assignments without excessive preemption of jobs that are legitimately at or below their fair share
allocations.
<!--l. 528--><p class="noindent" >Intuitively, the &#8220;how much&#8221; phase guarantees that if you could do unlimited shuffling around of the allocated resources,
everything would &#8220;fit&#8221;. The system is considered fragmented if such shuffling is actually needed. The defragmentation
processes attempts that shuffling, under the constraint of interrupting the smallest amount of productive work
possible.
<!--l. 534--><p class="noindent" >One scheduling goal, however, is to attempt to guarantee every job gets at least some minimal number of it&#8217;s fairly-counted
processes. This minimal number is called the <a 
href="#x1-21900012.4.6">defragmentation threshold.</a> and is configured in ducc.properties. This threshold
is used to rigorously define &#8220;smallest amount of productive work&#8221; as used in the previous paragraph. The defragmentation
threshold is used in two ways:
<!--l. 544--><p class="noindent" >
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">Attempt to get every work request resources allocated at least up to the level of the defragmentation threshold.
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">Never  steal  resources  beyond  the  defragmentation  threshold  during  the  &#8220;take  from  the  rich&#8221;  phase  of
     defragmentation, described below.</dd></dl>
<!--l. 549--><p class="noindent" >To accomplish this, a final stage, &#8220;defragmentation&#8221;, is performed before publishing the new schedule to the Orchestrator for
deployment.
<!--l. 553--><p class="noindent" >Defragmentation consists of several steps. The details are again involved, but an understanding of the logic will make
following the log relatively straightforward.
     <ul class="itemize1">
     <li class="itemize">Examine every job and determine whether it was assigned all the processes from the &#8220;how much&#8221; phase. If not,
     it is marked as POTENTIALLY NEEDY.
     <!--l. 561--><p class="noindent" >This step is logged with the tag <span 
class="cmti-10">detectFragmentation</span>.
     </li>
     <li class="itemize">Examine every POTENTIALLY NEEDY job to determine if there are sufficient preemptions pending such that
     the &#8220;how much&#8221; phase will be able to complete as soon as the preemptions complete. If not, the job is marked
     ACTUALLY NEEDY.
     <!--l. 568--><p class="noindent" >This step is also logged with the tag <span 
class="cmti-10">detectFragmentation</span>.
     </li>
     <li class="itemize">For every job marked ACTUALLY NEEDY, examine all jobs in the system already assigned shares to determine
     which ones can donate some resources to the ACTUALLY NEEDY jobs. These are typically jobs with more
                                                                                                
                                                                                                
     processes than their FAIR SHARE, but which, in a perfect, unfragmented layout, would be allocated more
     resources. These jobs are called <span 
class="cmti-10">rich </span>jobs.
     <!--l. 577--><p class="noindent" >This step is logged with the tags <span 
class="cmti-10">insureFullEviction </span>and <span 
class="cmti-10">doFinalEvictions</span>.
     </li>
     <li class="itemize">Attempt to match allocations from &#8220;rich&#8221; jobs with jobs that are ACTUALLY NEEDY. If the ACTUALLY
     NEEDY job is able to use one of the &#8220;rich job&#8221; allocations, the allocation is scheduled for preemption. (Note
     there are many reasons that a rich job may not have appropriate resources to donate: mismatched nodepool,
     physical host too small, not preemptable, etc.).
     <!--l. 587--><p class="noindent" >This step is logged with the tag <span 
class="cmti-10">takeFromTheRich</span>. If this step has any successes, the log will also show lines
     with the tags <span 
class="cmti-10">clearShare </span>and <span 
class="cmti-10">shrinkByOne </span>as the resources are scheduled for reuse.
     </li>
     <li class="itemize">The needy job is placed in a list of jobs which are given the highest priority for assignment of new processes,
     at the start of each subsequent scheduling cycle, until such time as they are no longer needy.
     <!--l. 597--><p class="noindent" >This step is logged with the tag <span 
class="cmti-10">Expand needy</span>.</li></ul>
<!--l. 600--><p class="noindent" >Those who wish to see the details of defragmentation can find them in <span 
class="cmti-10">NodepoolScheduler.java</span>, starting with the method
<span 
class="cmti-10">detectFragmentation </span>and tracing the flows from there.
<!--l. 604--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.2.9   </span> <a 
 id="x1-33100017.2.9"></a>Published Schedule</h4>
<!--l. 606--><p class="noindent" >The schedule gets printed to the log twice on every scheduling cycle. The first form is a pretty-printed summary of all known
jobs, showing which ones are getting more resources, <span 
class="cmti-10">expanding</span>, those which are losing resources, <span 
class="cmti-10">shrinking</span>, and those which
are not changing, <span 
class="cmti-10">stable.</span>
<!--l. 611--><p class="noindent" >The second form is a <span 
class="cmti-10">toString() </span>of the structure sent to the Orchestrator, showing the exact resources currently assigned,
added, or lost this cycle.
<!--l. 614--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33200017.2.9"></a><span 
class="cmbx-10">The pretty-printed schedule</span></span>
This entry is divided into five sections. Each section contains one line for each relevant job, with largely self-explanatory
headers. An example follows ( wrapped here so it fits within a printed page):
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-180">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ID&#x00A0;JobName&#x00A0;&#x00A0;User&#x00A0;&#x00A0;Class&#x00A0;&#x00A0;Shares&#x00A0;Order&#x00A0;QShares&#x00A0;NTh&#x00A0;Memory&#x00A0;nQuest&#x00A0;Ques&#x00A0;Rem&#x00A0;InitWait&#x00A0;Max&#x00A0;P/Nst
&#x00A0;<br />J____7485&#x00A0;mega-2&#x00A0;&#x00A0;&#x00A0;bob&#x00A0;&#x00A0;&#x00A0;low&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;14&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;24&#x00A0;&#x00A0;11510&#x00A0;&#x00A0;&#x00A0;&#x00A0;11495&#x00A0;&#x00A0;&#x00A0;&#x00A0;false&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7
&#x00A0;<br />J____7486&#x00A0;mega-1&#x00A0;&#x00A0;&#x00A0;mary&#x00A0;&#x00A0;normal&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;93&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;2&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;186&#x00A0;&#x00A0;&#x00A0;4&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;28&#x00A0;&#x00A0;14768&#x00A0;&#x00A0;&#x00A0;&#x00A0;14764&#x00A0;&#x00A0;&#x00A0;&#x00A0;false&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;93
&#x00A0;<br /></div>
<!--l. 623--><p class="nopar" > Here,
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">ID</span> </dt><dd 
class="description">is the unique DUCC ID of the work, prefixed with an indication of what kind of work it is: Job (J), a Service
     (S), a Reservation (R), or Managed Reservation (M).
     </dd><dt class="description">
<span 
class="cmbx-10">JobName</span> </dt><dd 
class="description">is the user-supplied name / description of the job.
     </dd><dt class="description">
<span 
class="cmbx-10">User</span> </dt><dd 
class="description">is the owner of the work.
     </dd><dt class="description">
<span 
class="cmbx-10">Class</span> </dt><dd 
class="description">is the scheduling class used to schedule the work.
     </dd><dt class="description">
<span 
class="cmbx-10">Shares</span> </dt><dd 
class="description">is  the  number  of  allocations  awarded,  which  might  be  processes,  or  simply  reserved  space.  It  is  a
     human-readable convenience, calculated as (Order * QShares).
     </dd><dt class="description">
<span 
class="cmbx-10">Order</span> </dt><dd 
class="description">is the number of share quanta per allocation.
     </dd><dt class="description">
<span 
class="cmbx-10">QShares</span> </dt><dd 
class="description">is the total quantum shares awarded to the work.
     </dd><dt class="description">
<span 
class="cmbx-10">Nth</span> </dt><dd 
class="description">is the declared number of threads per process.
     </dd><dt class="description">
<span 
class="cmbx-10">Memory</span> </dt><dd 
class="description">is the amount of memory in GB for each allocation.
     </dd><dt class="description">
<span 
class="cmbx-10">nQuest</span> </dt><dd 
class="description">is the number of work items (questions) for the job, where relevant.
     </dd><dt class="description">
<span 
class="cmbx-10">Ques Rem</span> </dt><dd 
class="description">is the number of work items not yet completed.
     </dd><dt class="description">
<span 
class="cmbx-10">InitWait</span> </dt><dd 
class="description">is either <span 
class="cmti-10">true </span>or <span 
class="cmti-10">false</span>, indicating whether at least one process has successfully completed initialization.
     </dd><dt class="description">
<span 
class="cmbx-10">Max P/Nst</span> </dt><dd 
class="description">is the job-declared maximum processes / instances for the job.</dd></dl>
<!--l. 645--><p class="noindent" >The five subsections of this log section are:
     <dl class="description"><dt class="description">
<span 
class="cmbx-10">Expanded</span> </dt><dd 
class="description">This is the list of all work that is receiving more resources this cycle.
     </dd><dt class="description">
<span 
class="cmbx-10">Shrunken</span> </dt><dd 
class="description">This is the list of work that is losing resources this cycle.
     </dd><dt class="description">
<span 
class="cmbx-10">Stable</span> </dt><dd 
class="description">This is the list of work whose assigned resources do not change this cycle.
                                                                                                
                                                                                                
     </dd><dt class="description">
<span 
class="cmbx-10">Dormant</span> </dt><dd 
class="description">This is the list of work that is unable to receive any resources this cycle.
     </dd><dt class="description">
<span 
class="cmbx-10">Reserved</span> </dt><dd 
class="description">This is the list of reservations.</dd></dl>
<!--l. 654--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33300017.2.9"></a><span 
class="cmbx-10">The Orchestrator Structure</span></span>
This is a list containing up to four lines per scheduled work.
<!--l. 657--><p class="noindent" >The specific resources shown here are formatted thus:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-181">
&#x00A0;&#x00A0;&#x00A0;&#x00A0;hostname.RM&#x00A0;share&#x00A0;id^Initialization&#x00A0;time</div>
<!--l. 660--><p class="nopar" > The <span 
class="cmti-10">hostname </span>is the name of the host where the resource is assigned. The <span 
class="cmti-10">RM Share </span>is the unique (to RM only) id of the
share assigned to this resource. The <span 
class="cmti-10">Initialization time </span>is the amount of time spent by the process residing within this
resource in its initialization phase.
<!--l. 665--><p class="noindent" >The lines are:
     <dl class="enumerate-enumitem"><dt class="enumerate-enumitem">
  1. </dt><dd 
class="enumerate-enumitem">The type of work and it&#8217;s DUCC ID, for example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-182">
     &#x00A0;Reservation&#x00A0;7438</div>
     <!--l. 670--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  2. </dt><dd 
class="enumerate-enumitem">The complete set of all resources currently assigned to the work, for example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-183">
     Existing[1]:&#x00A0;bluej537-7-73.1^0</div>
     <!--l. 674--><p class="nopar" > The resources here include all resources the RM tracks as being owned by the job, including older resources, newly
     assigned resources, and resources scheduled for eviction. The specific resources which are being added or removed are
     shown in the next lines.
     </dd><dt class="enumerate-enumitem">
  3. </dt><dd 
class="enumerate-enumitem">The complete set of resources the RM has scheduled for eviction, but which are not yet confirmed freed. For example,
     we see 7 resources which have been evicted:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-184">
     &#x00A0;Removals[7]:&#x00A0;bluej290-11.465^19430&#x00A0;bluej290-12.461^11802&#x00A0;bluej290-4.460^12672&#x00A0;\
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bluej290-5.464^23004&#x00A0;&#x00A0;bluej290-2.467^22909&#x00A0;bluej290-7.463^20636&#x00A0;\
     &#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;bluej290-6.466^19931</div>
     <!--l. 685--><p class="nopar" >
     </dd><dt class="enumerate-enumitem">
  4. </dt><dd 
class="enumerate-enumitem">The complete set of resources which are being added to the work in this cycle. For example:
                                                                                                
                                                                                                
     <div class="verbatim" id="verbatim-185">
     &#x00A0;Additions[4]:&#x00A0;bluej291-43.560^0&#x00A0;bluej291-42.543^0&#x00A0;bluej290-23.544^0&#x00A0;bluej291-44.559^0</div>
     <!--l. 692--><p class="nopar" ></dd></dl>
<!--l. 695--><p class="noindent" >In most cases, if resources cannot be awarded, this section also shows the reason string which is published for the benefit of
the web server and the Orchestrator&#8217;s job monitor:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-186">
&#x00A0;Job&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;7487&#x00A0;Waiting&#x00A0;for&#x00A0;defragmentation.
&#x00A0;<br />Existing[0]:
&#x00A0;<br />Additions[0]:
&#x00A0;<br />Removals[0]:</div>
<!--l. 702--><p class="nopar" >
<!--l. 704--><p class="noindent" >In some cases, it is possible that a job will show BOTH Additions and Removals. This usually occurs as a
result of the defragmentation step. The job will have been found in need of new resources during the initial
fair-share computation but later during fragmentation, it is also found to be a &#8220;rich&#8221; job which must donate
resources to under-allocated work. Not all the processes belonging to the &#8220;rich&#8221; job may be appropriate for the
poor job, in which case they will be allowed to expand even as it is donating some to the under-allocated
work.
<!--l. 712--><p class="noindent" >This can also occur if resources were previously preempted, for some reason the preemption is taking a long time. Since then
other resources have become freed and the can now re-expand. It is not possible to reverse a preemption (because the actual
state of the preemption is not knowable) so both expansion and shrinkage can be in progress for the same
job.
<!--l. 718--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">17.3   </span> <a 
 id="x1-33400017.3"></a>Service Manager Log (sm.log)</h3>
<!--l. 720--><p class="noindent" >The service manager log shows the events involved in managing services. These events include
     <ul class="itemize1">
     <li class="itemize">Bootstrap configuration
     </li>
     <li class="itemize">Receipt and anlysis of Orchestrator state
     </li>
     <li class="itemize">CLI requests: register, modify, start, stop, unregister, etc.
     </li>
     <li class="itemize">Dispatching / startup of service instances
     </li>
     <li class="itemize">Progression of Service state
     </li>
     <li class="itemize">Starting and logging of pingers</li></ul>
<!--l. 730--><p class="noindent" >To enable finer-grained messages, edit the file <span 
class="cmsl-10">$</span><span 
class="cmti-10">DUCC</span><span 
class="cmti-10">_HOME/resources/log4j.xml </span>and change the <span 
class="cmti-10">priority </span>value to <span 
class="cmti-10">debug </span>(or
<span 
class="cmti-10">trace</span>) in the stanza similar to that shown here. Within about a minute the logger will pick up the change and increase its log
level.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-187">
&#x00A0;&#x00A0;&#x00A0;&#x003C;category&#x00A0;name="org.apache.uima.ducc.sm"&#x00A0;additivity="true"&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;priority&#x00A0;value="debug"/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x003C;appender-ref&#x00A0;ref="smlog"&#x00A0;/&#x003E;
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x003C;/category&#x003E;</div>
<!--l. 740--><p class="nopar" >
<!--l. 742--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.1   </span> <a 
 id="x1-33500017.3.1"></a>Bootstrap configuration</h4>
<!--l. 744--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33600017.3.1"></a><span 
class="cmbx-10">Initial SM start</span></span>
The first logged line of any RM start will contain the string <span 
class="cmti-10">Starting component: serviceManager</span>:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-188">
SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;boot&#x00A0;&#x00A0;...&#x00A0;Starting&#x00A0;Component:&#x00A0;&#x00A0;serviceManager</div>
<!--l. 748--><p class="nopar" >
<!--l. 750--><p class="noindent" >This is followed by a summary of the environment in which the Service Manager is running, including configuration data,
information about the JRE and about hosting hardware.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-189">
&#x00A0;&#x00A0;Service&#x00A0;Manager&#x00A0;starting:
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC&#x00A0;home&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/home/challngr/ducc_runtime
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;ActiveMQ&#x00A0;URL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;tcp://bluej537:61617?jms.useCompression=true
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JVM&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;Oracle&#x00A0;Corporation&#x00A0;1.7.0_45
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JAVA_HOME&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/users1/challngr/jdk1.7.0_45/jre
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JVM&#x00A0;Path&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;/users/challngr/jdk1.7.0_45/bin/java
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;JMX&#x00A0;URL&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;service:jmx:rmi:///jndi/rmi://bluej537:2102/jmxrmi
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;OS&#x00A0;Architecture&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;amd64
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Crypto&#x00A0;enabled&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;true
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Test&#x00A0;mode&#x00A0;enabled&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;true
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Service&#x00A0;ping&#x00A0;rate&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;15000
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Service&#x00A0;ping&#x00A0;timeout&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;15000
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Service&#x00A0;ping&#x00A0;stability&#x00A0;&#x00A0;:&#x00A0;&#x00A0;10
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Default&#x00A0;ping&#x00A0;class&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;org.apache.uima.ducc.cli.UimaAsPing
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Init&#x00A0;Failure&#x00A0;Max&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;1
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Instance&#x00A0;Failure&#x00A0;Max&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;3
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Instance&#x00A0;Failure&#x00A0;Window&#x00A0;:&#x00A0;&#x00A0;10
&#x00A0;<br />
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DUCC&#x00A0;Version&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;2.0.0-beta
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;SM&#x00A0;Version&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;:&#x00A0;&#x00A0;2.0.0</div>
<!--l. 779--><p class="nopar" >
<!--l. 781--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33700017.3.1"></a><span 
class="cmbx-10">Initialize the service registry</span></span>
Following this is are entries showing the reading and internal initialization of the service registry, for example:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-190">
SM.ServiceHandler&#x00A0;-&#x00A0;411&#x00A0;ServiceStateHandler.registerService&#x00A0;&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;adding&#x00A0;UIMA-AS:FixedSleepAE_1:tcp://bluej537:61617&#x00A0;411</div>
<!--l. 787--><p class="nopar" >
<!--l. 789--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33800017.3.1"></a><span 
class="cmbx-10">Wait for the Resource Manager and Orchestrator to become ready</span></span>
The Service Manager waits until the Resource Manager and Orchestrator are ready. This usually results in lines similar to
the following, which are normal and expected. If these lines continue for more than a few minutes it is possible that some
part of DUCC has not correctly started:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-191">
SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;orchestratorStateArrives&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Orchestrator&#x00A0;JD&#x00A0;node&#x00A0;not&#x00A0;assigned,&#x00A0;ignoring&#x00A0;Orchestrator&#x00A0;state&#x00A0;update.</div>
<!--l. 798--><p class="nopar" >
<!--l. 800--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-33900017.3.1"></a><span 
class="cmbx-10">Begin work</span></span>
When the Service Manager is ready for business, lines similar to the following are emitted on a regular basis:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-192">
INFO&#x00A0;SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;processIncoming&#x00A0;&#x00A0;=====&#x00A0;Orchestrator&#x00A0;State&#x00A0;Arrives&#x00A0;=====</div>
<!--l. 805--><p class="nopar" >
<!--l. 807--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.2   </span> <a 
 id="x1-34000017.3.2"></a>Receipt and analysis of Orchestrator State</h4>
<!--l. 809--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.3   </span> <a 
 id="x1-34100017.3.3"></a>CLI Requests</h4>
<!--l. 811--><p class="noindent" >CLI Requests are all logged at log level INFO. Initial receipt of the command is tagged with the string <span 
class="cmti-10">ServiceManagerComponent</span>
and contains the name of the command issued. Information pertinent to the command issued is logged. For example, this
shows registration of a new service.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-193">
INFO&#x00A0;SM.ServiceManagerComponent&#x00A0;-&#x00A0;428&#x00A0;register&#x00A0;&#x00A0;ServiceRegisterEvent&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[ninstances=2,&#x00A0;autostart=Unset,&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;endpoint=UIMA-AS:FixedSleepAE_5:tcp://bluej537:61617,&#x00A0;user=challngr]</div>
<!--l. 820--><p class="nopar" >
<!--l. 822--><p class="noindent" >Some commands require service ownership or administrative authority. Here we show a service being started, and the
authorization check being made.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-194">
INFO&#x00A0;SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;start&#x00A0;&#x00A0;Starting&#x00A0;service&#x00A0;ServiceStartEvent&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;[friendly=430,&#x00A0;user=challngr,&#x00A0;instances=-1]
&#x00A0;<br />INFO&#x00A0;SM.ServiceHandler&#x00A0;-&#x00A0;430&#x00A0;authorized&#x00A0;&#x00A0;start&#x00A0;request&#x00A0;from&#x00A0;challngr&#x00A0;allowed.</div>
<!--l. 829--><p class="nopar" >
<!--l. 831--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.4   </span> <a 
 id="x1-34200017.3.4"></a>Dispatching / Startup of Service Instances</h4>
<!--l. 832--><p class="noindent" >The full set of startup messages is logged when an instance is dispatched to DUCC to be scheduled and started. These starts
are usually preceeded by a message or two indicating what triggered the start. For instance, this shows service 427 being
started because it was referenced by job 7676:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-195">
INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;reference&#x00A0;&#x00A0;Reference&#x00A0;start&#x00A0;requested&#x00A0;by&#x00A0;&#x00A0;7676
&#x00A0;<br />INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;reference&#x00A0;&#x00A0;&#x00A0;References&#x00A0;job/service&#x00A0;7676&#x00A0;count[1]&#x00A0;implementors&#x00A0;[0]
&#x00A0;<br />INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;reference&#x00A0;&#x00A0;Reference&#x00A0;starting&#x00A0;new&#x00A0;service&#x00A0;instances.</div>
<!--l. 841--><p class="nopar" >
<!--l. 843--><p class="noindent" >This is followed by a line indicating how many instances are to be started:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-196">
INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Starting&#x00A0;instance.&#x00A0;Current&#x00A0;count&#x00A0;0&#x00A0;needed&#x00A0;2</div>
<!--l. 846--><p class="nopar" >
<!--l. 848--><p class="noindent" >Shortly thereafter the <span 
class="cmti-10">stdout </span>messages from the submission to the DUCC Orchestrator are shown. These are tagged with the
keyword <span 
class="cmti-10">ServiceInstance</span>.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-197">
INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;START&#x00A0;INSTANCE
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;050&#x00A0;ducc_ling&#x00A0;Version&#x00A0;1.1.2&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;compiled&#x00A0;Aug&#x00A0;&#x00A0;4&#x00A0;2014&#x00A0;at&#x00A0;06:45:31</div>
<!--l. 854--><p class="nopar" >
<!--l. 856--><p class="noindent" >A few lines later the DUCC-assigned ID of the instance is shown, in this case, ID 7677, for service 427.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-198">
INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Service&#x00A0;instance&#x00A0;7677&#x00A0;submitted
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;N/A&#x00A0;start&#x00A0;&#x00A0;Request&#x00A0;to&#x00A0;start&#x00A0;service&#x00A0;427&#x00A0;accepted&#x00A0;as&#x00A0;service&#x00A0;instance&#x00A0;&#x00A0;7677</div>
<!--l. 861--><p class="nopar" >
<!--l. 863--><p class="noindent" >THe next lines show the environment used for the service submit.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-199">
INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;1104&#x00A0;Running&#x00A0;with&#x00A0;user&#x00A0;and&#x00A0;group:&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;id&#x00A0;2087&#x00A0;gid&#x00A0;2001&#x00A0;eid&#x00A0;2087&#x00A0;egid&#x00A0;2001
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;300&#x00A0;Bypassing&#x00A0;redirect&#x00A0;of&#x00A0;log.
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;4050&#x00A0;Limits:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;CORE&#x00A0;soft[1024]&#x00A0;hard[-1]
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;4050&#x00A0;Limits:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;CPU&#x00A0;soft[-1]&#x00A0;hard[-1]
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;4050&#x00A0;Limits:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;DATA&#x00A0;soft[-1]&#x00A0;hard[-1]
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;...&#x00A0;(more&#x00A0;environment)&#x00A0;...
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Environ[0]&#x00A0;=&#x00A0;DUCC_SERVICE_INSTANCE=0
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Environ[1]&#x00A0;=&#x00A0;JAVA_HOME=/opt/ibm-jdk1.7
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Environ[2]&#x00A0;=&#x00A0;LESSCLOSE=lessclose.sh&#x00A0;%s&#x00A0;%s
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Environ[3]&#x00A0;=&#x00A0;ENV=/etc/bash.bashrc</div>
<!--l. 876--><p class="nopar" >
<!--l. 878--><p class="noindent" >Next the exact command line executed to submit the isntance is shown. If the submission is successful, see <span 
class="cmti-10">START</span>
<span 
class="cmti-10">INSTANCE COMPLETE</span>. The exact progression of the scheduling and deployment of an instance is not shown in this log. If
it is desired to observe that, look in the RM log, searching on the service instance id. In the examples shown here, that id is
7677.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-200">
INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;1000&#x00A0;Command&#x00A0;to&#x00A0;exec:&#x00A0;/opt/ibm-jdk1.7/bin/java
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arg[1]:&#x00A0;-cp
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;&#x003C;INHIBITED&#x00A0;CP&#x003E;
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;&#x003C;INHIBITED&#x00A0;CP&#x003E;
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arg[4]:&#x00A0;--specification
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arg[5]:&#x00A0;/home/challngr/ducc_runtime/state/services/427.svc
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arg[6]:&#x00A0;--service_id
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;arg[7]:&#x00A0;427
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;1001&#x00A0;Command&#x00A0;launching...
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;Start&#x00A0;stdout:&#x00A0;Service&#x00A0;instance&#x00A0;7677&#x00A0;submitted
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;N/A&#x00A0;start&#x00A0;&#x00A0;Request&#x00A0;to&#x00A0;start&#x00A0;service&#x00A0;427&#x00A0;accepted&#x00A0;as&#x00A0;service&#x00A0;instance&#x00A0;&#x00A0;7677
&#x00A0;<br />INFO&#x00A0;SM.ServiceInstance&#x00A0;-&#x00A0;427&#x00A0;start&#x00A0;&#x00A0;START&#x00A0;INSTANCE&#x00A0;COMPLETE</div>
<!--l. 898--><p class="nopar" >
<!--l. 900--><p class="noindent" >The state progression of the service as it starts is then available, as described in the next section.
<!--l. 903--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.5   </span> <a 
 id="x1-34300017.3.5"></a>Progression of Service State</h4>
<!--l. 905--><p class="noindent" >The state of each service as it starts and stops is tracked at log level INFO. To find the state progression for any particular
service search on <span 
class="cmti-10">service-id setState </span>where service-id is the ID of the service.
<!--l. 908--><p class="noindent" >Here we show the progression for service 427 as it is started and progresses to fully functional (there are other lines logged
between these of course). Note that if a service has multiple instances defined, the overall service state is
determined by an aggregate of the states of the individual instances. In these messages, the &#8220;Inst&#8221; field of
each message shows DUCC ID of the most recently updated service instance that triggered the overall state
change.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-201">
SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;setState&#x00A0;&#x00A0;State&#x00A0;update&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;from[Stopped]&#x00A0;to[Starting]&#x00A0;via[Starting]&#x00A0;Inst[7677/Received]
&#x00A0;<br />SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;setState&#x00A0;&#x00A0;State&#x00A0;update&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;from[Starting]&#x00A0;to[Initializing]&#x00A0;via[Initializing]&#x00A0;Inst[7677/Initializing]
&#x00A0;<br />SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;setState&#x00A0;&#x00A0;State&#x00A0;update&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;from[Initializing]&#x00A0;to[Waiting]&#x00A0;via[Waiting]&#x00A0;Inst[7677/Running]
&#x00A0;<br />SM.ServiceSet&#x00A0;-&#x00A0;427&#x00A0;setState&#x00A0;&#x00A0;State&#x00A0;update&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;from[Waiting]&#x00A0;to[Available]&#x00A0;via[Available]&#x00A0;Inst[7677/Running]</div>
<!--l. 923--><p class="nopar" >
<!--l. 925--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.6   </span> <a 
 id="x1-34400017.3.6"></a>Starting and Logging Pingers</h4>
<!--l. 927--><p class="noindent" >When a pinger is started (or restarted) the event is logged and tagged with the string <span 
class="cmti-10">service-id startPingThread</span>.
Following are a few lines stating the name of the pinger and the Java class used to implement the pinger. For
example:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-202">
INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;430&#x00A0;startPingThread&#x00A0;&#x00A0;Starting&#x00A0;service&#x00A0;monitor.
&#x00A0;<br />INFO&#x00A0;SM.PingDriver&#x00A0;-&#x00A0;430&#x00A0;find&#x00A0;RegisteredPinger&#x00A0;&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Loading&#x00A0;site-registered&#x00A0;service&#x00A0;monitor&#x00A0;from&#x00A0;org.apache.uima.ducc.cli.UimaAsPing
&#x00A0;<br />INFO&#x00A0;SM.PingDriver&#x00A0;-&#x00A0;430&#x00A0;&#x003C;ctr&#x003E;&#x00A0;&#x00A0;Using&#x00A0;ping&#x00A0;class&#x00A0;org.apache.uima.ducc.cli.UimaAsPing</div>
<!--l. 937--><p class="nopar" >
<!--l. 939--><p class="noindent" >If the pingers do not declare loggers, their <span 
class="cmti-10">stdout </span>and <span 
class="cmti-10">stderr </span>are captured in the logs, under the tag <span 
class="cmti-10">handleStatistics</span>. As
well, every ping is recorded with its &#8220;info&#8221; string, making it possible to see the exact state of the pinger. For
example:
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-203">
INFO&#x00A0;SM.PingDriver&#x00A0;-&#x00A0;411&#x00A0;handleStatistics&#x00A0;&#x00A0;Ping&#x00A0;ok:&#x00A0;&#x00A0;UIMA-AS:FixedSleepAE_1:tcp://bluej537:61617&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;Alive[true]&#x00A0;Healthy[true]&#x00A0;+&#x00A0;Info:&#x00A0;QDEPTH[0]&#x00A0;AveNQ[0]&#x00A0;Consum[26]&#x00A0;Prod[0]&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;minNQ[0]&#x00A0;maxNQ[0]&#x00A0;expCnt[0]&#x00A0;inFlt[0]&#x00A0;DQ[0]&#x00A0;NQ[0]&#x00A0;NDisp[0]&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;MetaNode[192.168.4.36]&#x00A0;MetaPid[8892:67]</div>
<!--l. 949--><p class="nopar" >
<!--l. 951--><p class="noindent" >Pingers always return state to the Service Manager and some of that state affects the SM&#8217;s operation; in particular, pingers
can start and stop specific service instances or change the autostart setting for a service. They also must return success and
failure status to the SM. The ping state is logged under the tag <span 
class="cmti-10">service-id signalRebalance </span>as seen below. If
<span 
class="cmti-10">Additions: </span>or <span 
class="cmti-10">Deletions: </span>is non-zero, you can expect to see SM automatically start or stop specific instances for the
service.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-204">
INFO&#x00A0;SM.ServiceSet&#x00A0;-&#x00A0;430&#x00A0;signalRebalance&#x00A0;&#x00A0;PING:&#x00A0;Additions:&#x00A0;0&#x00A0;deletions:&#x00A0;0&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;excessive&#x00A0;failures:&#x00A0;false&#x00A0;implementors&#x00A0;1&#x00A0;references&#x00A0;0</div>
<!--l. 962--><p class="nopar" >
<!--l. 964--><p class="noindent" >
<h4 class="subsectionHead"><span class="titlemark">17.3.7   </span> <a 
 id="x1-34500017.3.7"></a>Publishing State</h4>
<!--l. 965--><p class="noindent" >By default the SM log does not include the state as published to the Orchestrator because it can be voluminous and cause
the logs to become cluttered and to wrap too fast. It may be necessary to increas the log level to DEBUG as described at the
start of this section.
<!--l. 970--><p class="noindent" >The published state will be emitted with lines similar to the following. Most entries will show &#8220;Available&#8221;, which means
either they do not depend on the Service Manager, or the service they depend on is in state Available. If there is some
exceptional condition pertaining to a job, that is shown. In the sample below, Job 251214 is waiting for a specific service
whose state itself is &#8220;waiting&#8221;.
                                                                                                
                                                                                                
<div class="verbatim" id="verbatim-205">
INFO&#x00A0;SM.ServiceHandler&#x00A0;-&#x00A0;251261&#x00A0;handleModifiedobs&#x00A0;&#x00A0;No&#x00A0;service&#x00A0;dependencies,&#x00A0;no&#x00A0;updates&#x00A0;made.
&#x00A0;<br />INFO&#x00A0;SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;publish&#x00A0;&#x00A0;Publishing&#x00A0;State,&#x00A0;active&#x00A0;job&#x00A0;count&#x00A0;=&#x00A0;102
&#x00A0;<br />INFO&#x00A0;SM.ServiceManagerComponent&#x00A0;-&#x00A0;N/A&#x00A0;publish&#x00A0;&#x00A0;Service&#x00A0;Map
&#x00A0;<br />Job&#x00A0;251159&#x00A0;Service&#x00A0;state&#x00A0;Available
&#x00A0;<br />Job&#x00A0;251263&#x00A0;Service&#x00A0;state&#x00A0;Available
&#x00A0;<br />Job&#x00A0;251192&#x00A0;Service&#x00A0;state&#x00A0;Available
&#x00A0;<br />Job&#x00A0;251214&#x00A0;Service&#x00A0;state&#x00A0;Waiting&#x00A0;\
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;[UIMA-AS:fastqa-Dedicated-Staging-2015-08_cache:tcp://broker42:62616&#x00A0;:&#x00A0;waiting]</div>
<!--l. 986--><p class="nopar" >
<!--l. 989--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">17.4   </span> <a 
 id="x1-34600017.4"></a> (Orchestrator Log or.log)</h3>
<!--l. 990--><p class="noindent" >To be filled in.
<!--l. 992--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">17.5   </span> <a 
 id="x1-34700017.5"></a>Process Manager Log (pm.log)</h3>
<!--l. 993--><p class="noindent" >To be filled in.
<!--l. 995--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">17.6   </span> <a 
 id="x1-34800017.6"></a>Agent log Log (hostname.agent.log)</h3>
<!--l. 996--><p class="noindent" >To be filled in.
 
</body></html> 

                                                                                                


